<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Reconnoiter</title><link rel="stylesheet" type="text/css" href="docbook.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"/></head><body><div class="book" id="idm62801073216"><div class="titlepage"><div><div><h1 class="title">Reconnoiter</h1></div><div><h2 class="subtitle">Large-scale Monitoring and Trend Analysis System</h2></div><div><div class="author"><h3 class="author">
      <span class="orgname">Circonus, Inc.</span>
    </h3></div></div><div><p class="copyright">Copyright © 2014 Circonus, Inc.</p></div><div><p class="pubdate">2014-05-28, Document revision 12421</p></div></div><hr/></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="preface"><a href="#introduction">Introduction</a></span></li><li><span class="part"><a href="#idm62801062272">I. Architecture</a></span><ul><li><span class="chapter"><a href="#arch.overview">1. Reconnoiter Architecture Overview</a></span></li><li><span class="chapter"><a href="#arch.noitd">2. noitd</a></span><ul><li><span class="section"><a href="#arch.noitd.design">noitd Design</a></span></li></ul></li><li><span class="chapter"><a href="#arch.stratcond">3. stratcond</a></span><ul><li><span class="section"><a href="#arch.stratcond.design">stratcond Design</a></span></li></ul></li></ul></li><li><span class="part"><a href="#configuration">II. Configuration</a></span><ul><li><span class="chapter"><a href="#config.generic">4. General config structures</a></span><ul><li><span class="section"><a href="#config.generic.implicitinheritance">Implicit Inheritance</a></span></li><li><span class="section"><a href="#config.generic.explicitinheritance">Explicit Inheritance</a></span></li><li><span class="section"><a href="#config.generic.section.eventer">The &lt;eventer&gt; section</a></span></li><li><span class="section"><a href="#config.generic.section.logs">The &lt;logs&gt; section</a></span><ul><li><span class="section"><a href="#config.generic.section.logs.special">Special log names</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config.noitd">5. noitd configuration</a></span><ul><li><span class="section"><a href="#config.noitd.section.logs.special">Special log names</a></span></li><li><span class="section"><a href="#config.noitd.section.checks.special">Configuring checks via configuration</a></span></li><li><span class="section"><a href="#config.noitd.section.filtersets.special">Configuring filtersets via configuration</a></span></li></ul></li><li><span class="chapter"><a href="#config.noitd.modules">6. noitd modules</a></span><ul><li><span class="section"><a href="#idm62801499808">check_test</a></span><ul><li><span class="section"><a href="#idm62801788096">Examples</a></span></li><li><span class="section"><a href="#idm62802681168">REST Endpoint</a></span></li></ul></li><li><span class="section"><a href="#idm62800901824">collectd</a></span><ul><li><span class="section"><a href="#idm62800896096">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800881328">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800862944">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800858496">custom_config</a></span><ul><li><span class="section"><a href="#idm62800853472">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800850352">dns</a></span><ul><li><span class="section"><a href="#idm62800843120">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800834336">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800771264">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800766160">external</a></span><ul><li><span class="section"><a href="#idm62800760448">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800732080">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800700832">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800697680">ganglia</a></span><ul><li><span class="section"><a href="#idm62800692560">Module Configuration</a></span></li></ul></li><li><span class="section"><a href="#idm62800664288">httptrap</a></span><ul><li><span class="section"><a href="#idm62800659104">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800650224">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800626880">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800622736">ip_acl</a></span><ul><li><span class="section"><a href="#idm62800617408">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800614128">lua</a></span><ul><li><span class="section"><a href="#idm62800608912">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800600208">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800597504">mysql</a></span><ul><li><span class="section"><a href="#idm62800592256">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800579104">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800575824">cloudwatch</a></span><ul><li><span class="section"><a href="#idm62800571120">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800570864">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800506752">dhcp</a></span><ul><li><span class="section"><a href="#idm62800501696">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800470320">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800467392">haproxy</a></span><ul><li><span class="section"><a href="#idm62800462016">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800420416">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800417392">http</a></span><ul><li><span class="section"><a href="#idm62800412176">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800411376">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800277392">imap</a></span><ul><li><span class="section"><a href="#idm62800272192">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800271936">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800192688">jezebel</a></span><ul><li><span class="section"><a href="#idm62800185504">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800178416">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800171664">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800168608">keynote</a></span><ul><li><span class="section"><a href="#idm62800162784">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800124704">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800121648">keynote_pulse</a></span><ul><li><span class="section"><a href="#idm62800116384">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800090016">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800086896">memcached</a></span><ul><li><span class="section"><a href="#idm62800081632">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800072864">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800086512">monit</a></span><ul><li><span class="section"><a href="#idm62800064544">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866846944">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866843376">munin</a></span><ul><li><span class="section"><a href="#idm62866837920">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866823184">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866820160">nginx</a></span><ul><li><span class="section"><a href="#idm62866814960">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866784112">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866780960">nrpe</a></span><ul><li><span class="section"><a href="#idm62866775840">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866749424">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866746512">ntp</a></span><ul><li><span class="section"><a href="#idm62866741296">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866724608">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866746128">pop3</a></span><ul><li><span class="section"><a href="#idm62866716736">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866716480">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866657424">redis</a></span><ul><li><span class="section"><a href="#idm62866652368">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866621152">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866618352">elasticsearch</a></span><ul><li><span class="section"><a href="#idm62866613040">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866596608">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866593792">resmon</a></span><ul><li><span class="section"><a href="#idm62866586640">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866560320">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866557344">smtp</a></span><ul><li><span class="section"><a href="#idm62866551968">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800069584">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800004256">tcp</a></span><ul><li><span class="section"><a href="#idm62799999008">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799998752">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799933440">varnish</a></span><ul><li><span class="section"><a href="#idm62799928224">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799919456">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799916528">ping_icmp</a></span><ul><li><span class="section"><a href="#idm62799911216">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799887248">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799884480">postgres</a></span><ul><li><span class="section"><a href="#idm62799879168">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799866208">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799862928">selfcheck</a></span><ul><li><span class="section"><a href="#idm62799857696">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799848960">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799862544">snmp</a></span><ul><li><span class="section"><a href="#idm62799840992">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799797344">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799793376">snmptrap</a></span><ul><li><span class="section"><a href="#idm62799787056">Module Configuration</a></span></li><li><span class="section"><a href="#idm62799757888">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799751120">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799747968">ssh2</a></span><ul><li><span class="section"><a href="#idm62799742816">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799742560">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799670896">statsd</a></span><ul><li><span class="section"><a href="#idm62799665600">Module Configuration</a></span></li><li><span class="section"><a href="#idm62799643392">Examples</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config.stratcond">7. stratcond</a></span><ul><li><span class="section"><a href="#config.stratcond.implicitinheritance">Implicit Inheritance</a></span></li><li><span class="section"><a href="#config.stratcond.explicitinheritance">Explicit Inheritance</a></span></li><li><span class="section"><a href="#config.stracond.section.eventer">The &lt;eventer&gt; section</a></span></li><li><span class="section"><a href="#config.stratcond.section.logs">The &lt;logs&gt; section</a></span><ul><li><span class="section"><a href="#config.stratcond.section.logs.special">Special log names</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config.stratcond.modules">8. stratcond modules</a></span><ul><li><span class="section"><a href="#idm62801196784">fq_driver</a></span><ul><li><span class="section"><a href="#idm62799563504">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799560448">rabbitmq_driver</a></span><ul><li><span class="section"><a href="#idm62799555024">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799551968">stomp_driver</a></span><ul><li><span class="section"><a href="#idm62799546688">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799543392">postgres_ingestor</a></span><ul><li><span class="section"><a href="#idm62799538128">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799535632">handoff_ingestor</a></span><ul><li><span class="section"><a href="#idm62799529392">Examples</a></span></li></ul></li></ul></li></ul></li><li><span class="part"><a href="#operation">III. Operation</a></span><ul><li><span class="chapter"><a href="#operation.noitd">9. Operating the noitd daemon</a></span><ul><li><span class="section"><a href="#noitd.interactive.console">Interactive Console Command Line Operation</a></span><ul><li><span class="section"><a href="#idm62799519328">General Operational Principles</a></span></li><li><span class="section"><a href="#idm62799517024">Accessing the Interactive Console</a></span></li><li><span class="section"><a href="#idm62799514256">Basic Command List</a></span></li><li><span class="section"><a href="#idm62799481408">Showing System Information</a></span></li><li><span class="section"><a href="#idm62799461920">Configuring the System</a></span></li></ul></li><li><span class="section"><a href="#noitd.wire.protocol"><span class="command"><strong>noitd/stratcond</strong></span> Wire Protocol</a></span><ul><li><span class="section"><a href="#operation.wire.rest">REST operation over HTTP</a></span></li></ul></li></ul></li></ul></li><li><span class="part"><a href="#idm62799376480">IV. Development</a></span><ul><li><span class="chapter"><a href="#dev.reconnoiter">10. Developer's Guide</a></span><ul><li><span class="section"><a href="#dev.reconnoiter.internal">Internal APIs</a></span></li><li><span class="section"><a href="#idm62799374016">Hooks</a></span><ul><li><span class="section"><a href="#idm62799373232">Abitrary Hooks</a></span></li><li><span class="section"><a href="#idm62799356816">Check Hooks</a></span></li></ul></li><li><span class="section"><a href="#idm62799349648">Developing modules in C</a></span><ul><li><span class="section"><a href="#idm62799344864">Starting your project</a></span></li></ul></li><li><span class="section"><a href="#idm62799336928">Developing modules in lua</a></span><ul><li><span class="section"><a href="#idm62799266672">Installing lua modules</a></span></li><li><span class="section"><a href="#idm62799258656">Basic lua checks</a></span></li><li><span class="section"><a href="#idm62799251680">Reconnoiter-specific lua</a></span></li></ul></li><li><span class="section"><a href="#idm62799148368">Developing modules in Java</a></span></li></ul></li></ul></li><li><span class="part"><a href="#reference">V. Reference</a></span><ul><li><span class="reference"><a href="#exe">I. Reconnoiter Command Line Reference</a></span><ul><li><span class="refentrytitle"><a href="#executable.noitd">noitd</a></span><span class="refpurpose"> — Reconnoiter scout daemon</span></li><li><span class="refentrytitle"><a href="#executable.stratcond">stratcond</a></span><span class="refpurpose"> — Reconnoiter data collector/aggregator.</span></li></ul></li></ul></li><li><span class="index"><a href="#the.index">Index</a></span></li></ul></div><div class="list-of-figures"><div class="toc-title">List of Figures</div><ul><li>1.1. <a href="#over_arch_fig">Some image properties</a></li></ul></div><div class="list-of-examples"><div class="toc-title">List of Examples</div><ul><li>4.1. <a href="#idm62801022656">Basic configuration struture</a></li><li>4.2. <a href="#idm62801019152">Simple implicit inheritance configuration example</a></li><li>4.3. <a href="#idm62801002512">Simple explicity inheritance configuration example</a></li><li>4.4. <a href="#idm62800970880">Sample configuration for the log section</a></li><li>5.1. <a href="#idm62800966304">Basic noitd configuration struture</a></li><li>5.2. <a href="#idm62800948336">Sample configuration for the log section</a></li><li>5.3. <a href="#idm62800927680">Sample noitd check configuration.</a></li><li>5.4. <a href="#idm62800916048">Sample noitd 'default' filterset configuration.</a></li><li>5.5. <a href="#idm62800914608">Sample noitd dynamic filterset configuration.</a></li><li>6.1. <a href="#idm62801994976">Loading the check_test module.</a></li><li>6.2. <a href="#idm62800903536">REST /checks/test XML input.</a></li><li>6.3. <a href="#idm62800862304">Simple encrypted passive checking.</a></li><li>6.4. <a href="#idm62800852832">Loading the custom_config module.</a></li><li>6.5. <a href="#idm62800770624">Establishing PTR records for hosts.</a></li><li>6.6. <a href="#idm62800768240">Checking labs.omniti.com.</a></li><li>6.7. <a href="#idm62800700192">Checking a service via the /path/to/check_foo command.</a></li><li>6.8. <a href="#idm62800626240">Posting a string and a number.</a></li><li>6.9. <a href="#idm62800616768">Loading the ip_acl module.</a></li><li>6.10. <a href="#idm62800599472">Loading the lua loader.</a></li><li>6.11. <a href="#idm62800578464">Tracking MySQL database sizes.</a></li><li>6.12. <a href="#idm62800509456">Checking Cloudwatch data</a></li><li>6.13. <a href="#idm62800469680">Checking DHCP connection.</a></li><li>6.14. <a href="#idm62800419776">Monitor two haproxy instances</a></li><li>6.15. <a href="#idm62800279888">Checking an HTTP and HTTPS URL.</a></li><li>6.16. <a href="#idm62800194352">Checking IMAP connection.</a></li><li>6.17. <a href="#idm62800171024">Checking resmon services on OmniTI Labs.</a></li><li>6.18. <a href="#idm62800124064">Checking Keynote services.</a></li><li>6.19. <a href="#idm62800089376">Checking Keynote services.</a></li><li>6.20. <a href="#idm62800072224">Monitor two memcache instances with management on port 11211</a></li><li>6.21. <a href="#idm62866846176">Checking Monit services on localhost</a></li><li>6.22. <a href="#idm62866822544">Monitor a node running munun-node</a></li><li>6.23. <a href="#idm62866783472">Monitor an nginx server with a status page available at http://10.1.2.3/nginx_status</a></li><li>6.24. <a href="#idm62866748784">Checking load via NRPE.</a></li><li>6.25. <a href="#idm62866723968">Monitor an NTP service</a></li><li>6.26. <a href="#idm62866659872">Checking POP3 connection.</a></li><li>6.27. <a href="#idm62866620512">Checking Redis</a></li><li>6.28. <a href="#idm62866595968">Checking elasticsearch services on a node es1.int.foo_</a></li><li>6.29. <a href="#idm62866559680">Checking resmon services on OmniTI Labs.</a></li><li>6.30. <a href="#idm62800006672">Send an email to test SMTP service.</a></li><li>6.31. <a href="#idm62799936112">Checking TCP connection.</a></li><li>6.32. <a href="#idm62799918816">Monitor two varnish instances with management on port 8081</a></li><li>6.33. <a href="#idm62799886608">Ping checks against a host</a></li><li>6.34. <a href="#idm62799865568">Tracking PostgreSQL database sizes.</a></li><li>6.35. <a href="#idm62799848320">Testing the local noitd instance.</a></li><li>6.36. <a href="#idm62799796704">Simple snmp polling of two switchports</a></li><li>6.37. <a href="#idm62799795040">Example using config inheritance to show reuse</a></li><li>6.38. <a href="#idm62799750480">Simple passive checking.</a></li><li>6.39. <a href="#idm62799673168">Simple ssh polling of 4 machines</a></li><li>6.40. <a href="#idm62799642752">A sample statsd configuration.</a></li><li>7.1. <a href="#idm62799640112">Basic noitd configuration struture</a></li><li>7.2. <a href="#idm62799636432">Simple implicit inheritance configuration example</a></li><li>7.3. <a href="#idm62799619504">Simple explicity inheritance configuration example</a></li><li>7.4. <a href="#idm62799573536">Sample configuration for the log section</a></li><li>8.1. <a href="#idm62799562864">Loading the fq_driver.</a></li><li>8.2. <a href="#idm62799554384">Loading the rabbitmq_driver.</a></li><li>8.3. <a href="#idm62799546048">Loading the stomp_driver.</a></li><li>8.4. <a href="#idm62799537488">Using the postgres_ingestor.</a></li><li>8.5. <a href="#idm62799528752">Loading the handoff_ingestor.</a></li><li>9.1. <a href="#idm62799412672">REST /checks/set XML input.</a></li><li>9.2. <a href="#idm62799404368">REST /checks/show XML output.</a></li><li>9.3. <a href="#idm62799387616">REST /filtert/set XML input.</a></li><li>9.4. <a href="#idm62799379616">REST /filters/show XML output.</a></li><li>10.1. <a href="#idm62799367952">Declaring a foobarquux hook in a header.</a></li><li>10.2. <a href="#idm62799365984">Implementing a foobarquux hook in source.</a></li><li>10.3. <a href="#idm62799362608">Instrumenting a function conditionally.</a></li><li>10.4. <a href="#idm62799358736">A sample instrumentation of foobarquux</a></li></ul></div>
  

  <section class="preface" id="introduction"><div class="titlepage"><div><div><h1 class="title">Introduction</h1></div></div></div>
  
  <p>
    Reconnoiter is a monitoring and trend analysis system designed to cope
    with large architectures (thousands of machines and hundreds of thousands
    of metrics).
  </p>
  <p>
    Heavy focus is placed on decoupling the various components of the system
    to allow for disjoint evolution of each component as issues arise or new
    requirements are identified.  Resource monitoring, metric aggregation,
    metric analysis and visualization are all cleanly separated.
  </p>
  <p>
    The monitor, <span class="command"><strong>noitd</strong></span>, is written in C and designed to 
    support highly concurrent and rapid checks with an expected capability 
    of monitoring 100,000 services per minute (6 million checks per hour.)  
    While it is hard to make writing checks "easy" in this high-performance
    environment, efforts have been made to ensure that custom check scripting
    does not require the expertise of writing highly-concurrent, event-driven
    C code.  Instead, glue is provided via scripting languages such as Lua
    that attempt to handle aspects of this high-concurrency environment
    transparently.  As with any high-performance system, you can easily
    introduce non-performant code and jeopardize performance system-wide.
  </p>
  <p>
    The aggregator, <span class="command"><strong>stratcond</strong></span>, is also written in C and 
    responsible for the simple task of securely gathering data from all of the 
    distributed <span class="command"><strong>noitd</strong></span> instances and transforming them into 
    the data storage facility (currently PostgreSQL).
  </p>
  <p>
    The data storage facility (PostgreSQL) holds all information about
    individual checks, their statuses and the individual metrics associated
    with them.  Automatic processes are in place that summarize the
    numeric metrics into windowed averages for expedient graphing at
    a variety of time window resolutions (hour, day, month, year, etc.).
  </p>
  <p>
    The visualization interface (reconnoiter) draws from the data store
    to visualize collected metrics and assist with monitoring, trending and
    other visual analyses.  The visualization system is written in PHP.
  </p>
</section>
  <div class="part" id="idm62801062272"><div class="titlepage"><div><div><h1 class="title">Part I. Architecture</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="chapter"><a href="#arch.overview">1. Reconnoiter Architecture Overview</a></span></li><li><span class="chapter"><a href="#arch.noitd">2. noitd</a></span><ul><li><span class="section"><a href="#arch.noitd.design">noitd Design</a></span></li></ul></li><li><span class="chapter"><a href="#arch.stratcond">3. stratcond</a></span><ul><li><span class="section"><a href="#arch.stratcond.design">stratcond Design</a></span></li></ul></li></ul></div>
    
    <section class="chapter" id="arch.overview"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Reconnoiter Architecture Overview</h2></div></div></div>
  
    <p>
      </p><div class="figure" id="over_arch_fig"><div class="figure-title">Figure 1.1. Some image properties</div><div class="figure-contents">
        
        <div class="mediaobject"><table style="border: 0; width: 50%; cellpadding: 0; cellspacing: 0;"><tr><td><img src="assets/noit-network-arch.png" width="100%" alt="A graphic illustrating the the various components of Reconnoiter and how they inter-operate."/></td></tr></table></div>
        <div class="caption"><p>The various interactions between Reconnoiter components.</p></div>
      </div></div><p><br class="figure-break"/>
    </p>
    <p>
      Both <span class="command"><strong>noitd</strong></span> and <span class="command"><strong>stratcond</strong></span> make heavy
      use of SSL certificates. The SSL certificates are used for security 
      purposes, and are required for correct operation. The common names of the
      certs identify different system components to each other and must match 
      or the components will fail to communicate.
    </p>
    <p>
      It is strongly recommended that you use a certificate authority to manage
      the certificates issued to each <span class="command"><strong>noitd</strong></span> and 
      <span class="command"><strong>stratcond</strong></span> daemon.
    </p>
</section>
    <section class="chapter" id="arch.noitd"><div class="titlepage"><div><div><h2 class="title">Chapter 2. noitd</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#arch.noitd.design">noitd Design</a></span></li></ul></div>
  
  <p>
    <span class="command"><strong>noitd</strong></span> is the "scout in the field."  It is responsible 
    for performing service checks and obtaining metric information from services
    on remote machines.  Typically, one <span class="command"><strong>noitd</strong></span> daemon is 
    deployed in each datacenter and is responsible for talking to each machine 
    and collecting service information.
  </p>
  <p>
    The <span class="command"><strong>noitd</strong></span> daemon should be positioned in the network 
    topology such that it has direct access to each machine it monitors (same 
    layer 2 segment).  This is a SHOULD, not a MUST.  <span class="command"><strong>noitd</strong></span> 
    can be used to monitor remote services as well (such as checking HTTP page 
    load times from one monitoring location to services running in another 
    datacenter).  The direct access is suggested for sensitive services that 
    should not be accessible from outside the network.
  </p>
  <p>
    The <span class="command"><strong>noitd</strong></span> daemon provides datafeed services to a 
    <span class="command"><strong>stratcond</strong></span> daemon over port 34332 (or another port of 
    your choosing) via an SSL-protected TCP transport.
  </p>
  <section class="section" id="arch.noitd.design"><div class="titlepage"><div><div><h2 class="title" style="clear: both">noitd Design</h2></div></div></div>
    
    <p>
      <span class="command"><strong>noitd</strong></span> is designed to be high-performance as well as
      easy to administer.  Clearly, ease of administration is a subjective
      assessment.  The goal in administration was to make the
      <span class="command"><strong>noitd</strong></span> system as much like a network device as
      possible.  The methodology and approach to use is very similar to other
      network devices such as switches and routers.  Telnet access (available
      over both SSL and non-SSL) provides access to a CLI that allows
      assessment of operation as well as reconfiguration.  It is designed to
      make network administrators feel "at home."
    </p>
    <p>
      The performance of <span class="command"><strong>noitd</strong></span> is grounded in its use of a
      hybrid event/thread and careful coding practices to ensure that blocking
      operations and computationally intensive operations are handled 
      asynchronously to non-blocking operations.
    </p>
    <p>
      The configuration system is entirely XML-based, providing two inheritance
      paradigms.  The first is provided by simple XML parent-child relationships
      such that required attributes that are unspecified in leaf nodes are
      resolved by walking up the element's ancestral stack.  The second model
      uses an explicit "inherit" attribute that allows for complicated 
      configuration information to be stored elsewhere in the XML tree for 
      readability and maintainability.  All configuration can be performed by 
      the CLI with a router-like syntax, so those uncomfortable with XML can 
      configure the system with equal ability.
    </p>
    <p>
      Checks are loaded into the system dynamically (through shared object 
      loading.) New checks can be authored and added to the system without 
      recompiling the host <span class="command"><strong>noitd</strong></span> daemon.  Some modules can 
      be loaded during runtime, but due to security concerns, super-user 
      privileges are dropped after module initialization.  This security 
      feature prevents the correct operation of any module requiring extended 
      privileges for initialization.  Adding such a module to the configuration 
      will require a restart of the <span class="command"><strong>noitd</strong></span> process.  The 
      ping_icmp module is an example of a module requiring extended privileges 
      for initialization (the opening of RAW network sockets.)
    </p>
    <p>
      In addition to checks implemented as dynamic objects (ELF or Mach) that
      are loaded into the system with dlopen() or similar such mechanisms,
      <span class="command"><strong>noitd</strong></span> allows for alternate "loader" implementations.  
      <span class="command"><strong>noitd</strong></span> has a "lua" loader that allows checks to be 
      scripts in the Lua programming language.
    </p>
  </section>
</section>
    <section class="chapter" id="arch.stratcond"><div class="titlepage"><div><div><h2 class="title">Chapter 3. stratcond</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#arch.stratcond.design">stratcond Design</a></span></li></ul></div>
  
  <p>
    <span class="command"><strong>stratcond</strong></span> is responsible for pulling collected metrics 
    from <span class="command"><strong>noitd</strong></span> processes running in the field.  It will 
    connect to <span class="command"><strong>noitd</strong></span> over an SSL-protected TCP transport on 
    port 34332 (or another port of your choosing), then 
    <span class="command"><strong>noitd</strong></span> will push a dataset to 
    <span class="command"><strong>stratcond</strong></span>.  <span class="command"><strong>stratcond</strong></span> will transform 
    this dataset and insert it into the PostgreSQL datastore.
  </p>
  <p>
    Data collected by <span class="command"><strong>noitd</strong></span> is stored in a jlog journal 
    which is a segment-based, publish-subscribe journal.  Adhering to the 
    publish-subscribe model, <span class="command"><strong>stratcond</strong></span> must be a subscriber 
    to this log and the common name (CN) in the client-side SSL certificate 
    that <span class="command"><strong>stratcond</strong></span> presents to <span class="command"><strong>noitd</strong></span> upon 
    connecting is used as the jlog subscriber name.
  </p>
  <p> See the <a class="ulink" href="https://github.com/omniti-labs/jlog/" target="_top"><em class="citetitle">JLog</em></a> project
    page for more information about JLog. </p>
  <section class="section" id="arch.stratcond.design"><div class="titlepage"><div><div><h2 class="title" style="clear: both">stratcond Design</h2></div></div></div>
    
    <p>
      <span class="command"><strong>stratcond</strong></span> is simple in both purpose and design.  All 
      connections to remote <span class="command"><strong>noitd</strong></span> deamons are managed in a 
      single thread in the event system.  As data is received from each 
      <span class="command"><strong>noitd</strong></span> daemon, it is pushed onto a datastore queue for 
      that daemon.  A database connection is established for each 
      <span class="command"><strong>noitd</strong></span> daemon (each in its own thread) and those 
      threads consume the datastore queue, transforming and inserting data into 
      PostgreSQL.
    </p>
    <p>
      Inserts are performed in batches.  At the end of each batch, 
      <span class="command"><strong>stratcond</strong></span> will commit the database transaction and 
      advise the the remote <span class="command"><strong>noitd</strong></span> to checkpoint the 
      subscriber position.  This two-point commit is not XA-safe and there is 
      a possibility that data could be committed to the datastore and the 
      subscriber checkpoint not be updated.  This will result in an attempt to 
      repeat the data insertion, resulting in primary key violations which are 
      ignored.
    </p>
    <p>
      <span class="command"><strong>stratcond</strong></span> uses the same configuration processing 
      system as <span class="command"><strong>noitd</strong></span>.  It is XML-based and provides 
      facilities for defining the SQL statements executed against PostgreSQL, 
      the connection parameters, and the various remote 
      <span class="command"><strong>noitd</strong></span> instances to which it should connect.
    </p>
  </section>
</section>
</div>
  <div class="part" id="configuration"><div class="titlepage"><div><div><h1 class="title">Part II. Configuration</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="chapter"><a href="#config.generic">4. General config structures</a></span><ul><li><span class="section"><a href="#config.generic.implicitinheritance">Implicit Inheritance</a></span></li><li><span class="section"><a href="#config.generic.explicitinheritance">Explicit Inheritance</a></span></li><li><span class="section"><a href="#config.generic.section.eventer">The &lt;eventer&gt; section</a></span></li><li><span class="section"><a href="#config.generic.section.logs">The &lt;logs&gt; section</a></span><ul><li><span class="section"><a href="#config.generic.section.logs.special">Special log names</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config.noitd">5. noitd configuration</a></span><ul><li><span class="section"><a href="#config.noitd.section.logs.special">Special log names</a></span></li><li><span class="section"><a href="#config.noitd.section.checks.special">Configuring checks via configuration</a></span></li><li><span class="section"><a href="#config.noitd.section.filtersets.special">Configuring filtersets via configuration</a></span></li></ul></li><li><span class="chapter"><a href="#config.noitd.modules">6. noitd modules</a></span><ul><li><span class="section"><a href="#idm62801499808">check_test</a></span><ul><li><span class="section"><a href="#idm62801788096">Examples</a></span></li><li><span class="section"><a href="#idm62802681168">REST Endpoint</a></span></li></ul></li><li><span class="section"><a href="#idm62800901824">collectd</a></span><ul><li><span class="section"><a href="#idm62800896096">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800881328">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800862944">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800858496">custom_config</a></span><ul><li><span class="section"><a href="#idm62800853472">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800850352">dns</a></span><ul><li><span class="section"><a href="#idm62800843120">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800834336">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800771264">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800766160">external</a></span><ul><li><span class="section"><a href="#idm62800760448">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800732080">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800700832">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800697680">ganglia</a></span><ul><li><span class="section"><a href="#idm62800692560">Module Configuration</a></span></li></ul></li><li><span class="section"><a href="#idm62800664288">httptrap</a></span><ul><li><span class="section"><a href="#idm62800659104">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800650224">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800626880">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800622736">ip_acl</a></span><ul><li><span class="section"><a href="#idm62800617408">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800614128">lua</a></span><ul><li><span class="section"><a href="#idm62800608912">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800600208">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800597504">mysql</a></span><ul><li><span class="section"><a href="#idm62800592256">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800579104">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800575824">cloudwatch</a></span><ul><li><span class="section"><a href="#idm62800571120">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800570864">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800506752">dhcp</a></span><ul><li><span class="section"><a href="#idm62800501696">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800470320">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800467392">haproxy</a></span><ul><li><span class="section"><a href="#idm62800462016">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800420416">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800417392">http</a></span><ul><li><span class="section"><a href="#idm62800412176">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800411376">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800277392">imap</a></span><ul><li><span class="section"><a href="#idm62800272192">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800271936">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800192688">jezebel</a></span><ul><li><span class="section"><a href="#idm62800185504">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800178416">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800171664">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800168608">keynote</a></span><ul><li><span class="section"><a href="#idm62800162784">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800124704">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800121648">keynote_pulse</a></span><ul><li><span class="section"><a href="#idm62800116384">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800090016">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800086896">memcached</a></span><ul><li><span class="section"><a href="#idm62800081632">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800072864">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800086512">monit</a></span><ul><li><span class="section"><a href="#idm62800064544">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866846944">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866843376">munin</a></span><ul><li><span class="section"><a href="#idm62866837920">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866823184">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866820160">nginx</a></span><ul><li><span class="section"><a href="#idm62866814960">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866784112">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866780960">nrpe</a></span><ul><li><span class="section"><a href="#idm62866775840">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866749424">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866746512">ntp</a></span><ul><li><span class="section"><a href="#idm62866741296">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866724608">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866746128">pop3</a></span><ul><li><span class="section"><a href="#idm62866716736">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866716480">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866657424">redis</a></span><ul><li><span class="section"><a href="#idm62866652368">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866621152">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866618352">elasticsearch</a></span><ul><li><span class="section"><a href="#idm62866613040">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866596608">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866593792">resmon</a></span><ul><li><span class="section"><a href="#idm62866586640">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866560320">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866557344">smtp</a></span><ul><li><span class="section"><a href="#idm62866551968">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800069584">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800004256">tcp</a></span><ul><li><span class="section"><a href="#idm62799999008">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799998752">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799933440">varnish</a></span><ul><li><span class="section"><a href="#idm62799928224">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799919456">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799916528">ping_icmp</a></span><ul><li><span class="section"><a href="#idm62799911216">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799887248">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799884480">postgres</a></span><ul><li><span class="section"><a href="#idm62799879168">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799866208">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799862928">selfcheck</a></span><ul><li><span class="section"><a href="#idm62799857696">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799848960">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799862544">snmp</a></span><ul><li><span class="section"><a href="#idm62799840992">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799797344">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799793376">snmptrap</a></span><ul><li><span class="section"><a href="#idm62799787056">Module Configuration</a></span></li><li><span class="section"><a href="#idm62799757888">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799751120">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799747968">ssh2</a></span><ul><li><span class="section"><a href="#idm62799742816">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799742560">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799670896">statsd</a></span><ul><li><span class="section"><a href="#idm62799665600">Module Configuration</a></span></li><li><span class="section"><a href="#idm62799643392">Examples</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config.stratcond">7. stratcond</a></span><ul><li><span class="section"><a href="#config.stratcond.implicitinheritance">Implicit Inheritance</a></span></li><li><span class="section"><a href="#config.stratcond.explicitinheritance">Explicit Inheritance</a></span></li><li><span class="section"><a href="#config.stracond.section.eventer">The &lt;eventer&gt; section</a></span></li><li><span class="section"><a href="#config.stratcond.section.logs">The &lt;logs&gt; section</a></span><ul><li><span class="section"><a href="#config.stratcond.section.logs.special">Special log names</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config.stratcond.modules">8. stratcond modules</a></span><ul><li><span class="section"><a href="#idm62801196784">fq_driver</a></span><ul><li><span class="section"><a href="#idm62799563504">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799560448">rabbitmq_driver</a></span><ul><li><span class="section"><a href="#idm62799555024">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799551968">stomp_driver</a></span><ul><li><span class="section"><a href="#idm62799546688">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799543392">postgres_ingestor</a></span><ul><li><span class="section"><a href="#idm62799538128">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799535632">handoff_ingestor</a></span><ul><li><span class="section"><a href="#idm62799529392">Examples</a></span></li></ul></li></ul></li></ul></div>
    
    <section class="chapter" id="config.generic"><div class="titlepage"><div><div><h2 class="title">Chapter 4. General config structures</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#config.generic.implicitinheritance">Implicit Inheritance</a></span></li><li><span class="section"><a href="#config.generic.explicitinheritance">Explicit Inheritance</a></span></li><li><span class="section"><a href="#config.generic.section.eventer">The &lt;eventer&gt; section</a></span></li><li><span class="section"><a href="#config.generic.section.logs">The &lt;logs&gt; section</a></span><ul><li><span class="section"><a href="#config.generic.section.logs.special">Special log names</a></span></li></ul></li></ul></div>
  
  <div class="example" id="idm62801022656"><div class="example-title">Example 4.1. Basic configuration struture</div><div class="example-contents">
  
  <pre class="programlisting">
  &lt;noit&gt;
    &lt;eventer/&gt;
    &lt;modules&gt;
      &lt;...&gt;
        &lt;module /&gt;
      &lt;/...&gt;
    &lt;/modules&gt;
    &lt;logs&gt;
      &lt;...&gt;
        &lt;log&gt;
          &lt;outlet /&gt;
          &lt;outlet /&gt;
        &lt;/log&gt;
      &lt;/...&gt;
    &lt;/logs&gt;
    &lt;listeners&gt;
      &lt;...&gt;
        &lt;listener/&gt;
        &lt;listener&gt;
          &lt;config /&gt;
          &lt;sslconfig /&gt;
        &lt;listener&gt;
      &lt;/...&gt;
    &lt;/listeners&gt;
  &lt;/noit&gt;
</pre>
</div></div><br class="example-break"/>

<section class="section" id="config.generic.implicitinheritance"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Implicit Inheritance</h2></div></div></div>

<p>
Unless otherwise specified, elements and attributes are inherited from
all ancestors.  As is typical with inheritance, the youngest/deepest
value overrides values of ancestors.  If the value requested is a set
of key/value pairs, the top-most ancestor is queried, then its
child is queried, merging values, replacing conflicts and so on until
the youngest/deepest node is reached.
</p>

<div class="example" id="idm62801019152"><div class="example-title">Example 4.2. Simple implicit inheritance configuration example</div><div class="example-contents">

<pre class="programlisting">
      &lt;a foo="bar"&gt;
        &lt;config&gt;
          &lt;key1&gt;val a 1&lt;/key1&gt;
          &lt;key2&gt;val a 2&lt;/key2&gt;
        &lt;/config&gt;
        &lt;b quux="baz"&gt;
          &lt;config&gt;
            &lt;key1&gt;val b 1&lt;/key1&gt;
            &lt;key3&gt;val b 3&lt;/key3&gt;
          &lt;/config&gt;
          &lt;c foo="meme" /&gt;
        &lt;/b&gt;
      &lt;/a&gt;
</pre>
</div></div><br class="example-break"/>

<p>
When looking at the "foo" attribute we see the following values at nodes:
</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">a</span></dt><dd><p>bar</p></dd><dt><span class="term">b</span></dt><dd><p>bar</p></dd><dt><span class="term">c</span></dt><dd><p>meme</p></dd></dl></div>

<p>
When looking at the "quux" attribute we see the following values at nodes:
</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">a</span></dt><dd><p>(none)</p></dd><dt><span class="term">b</span></dt><dd><p>baz</p></dd><dt><span class="term">c</span></dt><dd><p>baz</p></dd></dl></div>

<p>
When looking at the key/value set "config" we see the following values at nodes:
</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">a</span></dt><dd><p>{ key1: "val a 1", key2: "val a 2" }</p></dd><dt><span class="term">b</span></dt><dd><p>{ key1: "val b 1", key2: "val a 2", key3: "val b 3" }</p></dd><dt><span class="term">c</span></dt><dd><p>{ key1: "val b 1", key2: "val a 2", key3: "val b 3" } (same as b)</p></dd></dl></div>

<p>
This inheritance model allows for "non-repetitive" configuration
approaches: "express yourself once and reuse."
</p>
</section>

<section class="section" id="config.generic.explicitinheritance"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Explicit Inheritance</h2></div></div></div>


<p>
Sometimes it is useful to define a configuration key/value set
for reuse, but the strict parent-child inheritance model is awkward.
Under these circumstances, the explicit inheritance often solves the
issue at hand.  With explicit inheritance, a configuration can inherit
from another named node elsewhere in the configuration.
</p>
<p>
The &lt;config /&gt; stanzas can be identified, as is typical in XML, with
the "id" attribute: &lt;config id="sample" /&gt;.  Additionally, any config
may explicitly specify that it inherits from a named config by
specifying the "inherit" attribute.
</p>
<p>
Any &lt;config /&gt;, A, which has the "inherit" attribute will first
inherit from its most direct parent, then supplement/replace those
key/values with the configuration whose "id" attribute matches the
"inherit" attribute of A, and finally supplement/replace those
key/values with key/values directly beneath A.  The entire tree is
searched for a node whose "id" matches A's "inherit" attribute.
</p>

<div class="example" id="idm62801002512"><div class="example-title">Example 4.3. Simple explicity inheritance configuration example</div><div class="example-contents">

<pre class="programlisting">
  &lt;config name="A"&gt;
    &lt;key1&gt;a&lt;/key1&gt;
    &lt;key2&gt;b&lt;/key2&gt;
    &lt;key3&gt;c&lt;/key3&gt;
    &lt;config name="C" inherit="bob"&gt;
      &lt;key1&gt;AAA&lt;/key1&gt;
      &lt;key4&gt;DDD&lt;/key4&gt;
    &lt;/config&gt;
  &lt;/config&gt;
  &lt;x&gt;
    &lt;y&gt;
      &lt;z&gt;
        &lt;config name="B" id="bob"&gt;
          &lt;key2&gt;bobB&lt;/key2&gt;
          &lt;key5&gt;bobE&lt;/key5&gt;
        &lt;/config&gt;
      &lt;/z&gt;
    &lt;/y&gt;
  &lt;/x&gt;
</pre>
</div></div><br class="example-break"/>

<p>The config named "A" contains:</p>
<div class="variablelist"><dl class="variablelist compact"><dt><span class="term">key1</span></dt><dd><p>a</p></dd><dt><span class="term">key2</span></dt><dd><p>b</p></dd><dt><span class="term">key3</span></dt><dd><p>c</p></dd></dl></div>

<p>The config named "C" contains:</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">key1</span></dt><dd><p>AAA</p></dd><dt><span class="term">key2</span></dt><dd><p>bobB</p></dd><dt><span class="term">key3</span></dt><dd><p>c</p></dd><dt><span class="term">key4</span></dt><dd><p>DDD</p></dd><dt><span class="term">key5</span></dt><dd><p>bobE</p></dd></dl></div>

<p>
It should be noted hat all config's include the one named "B" above
follows this same inheritance model.
</p>
</section>

<section class="section" id="config.generic.section.eventer"><div class="titlepage"><div><div><h2 class="title" style="clear: both">The &lt;eventer&gt; section</h2></div></div></div>
  

<p>
This section provides configuration directives to the eventing
subsystem.  Think of the eventer as the engine that drives all I/O,
jobs, and timed events.  To choose the eventer, the "implementation"
attribute is used in the eventer node.  For example, to select the
kqueue eventer (for Mac OS X or modern BSDs):
</p>

<pre class="programlisting">
  &lt;eventer implementation="kqueue" /&gt;
</pre>

<p>
The following eventer implementations exist: kqueue (Mac/BSD), epoll (Linux), ports (Solaris 10+).
</p>
</section>

<section class="section" id="config.generic.section.logs"><div class="titlepage"><div><div><h2 class="title" style="clear: both">The &lt;logs&gt; section</h2></div></div></div>
  

<p>
The logs section contains &lt;log&gt; elements at arbitrary depths.  A log
requires several attributes to be useful:
</p>

<div class="variablelist"><dl class="variablelist"><dt><span class="term">name</span></dt><dd><p>
   "name" this must me unique.  Several names have meaning within the
   product.  If you match that name, you control how that information
   is logged.
  </p></dd><dt><span class="term">type</span></dt><dd><p>
   "type" this specified ths underlying log writing implementation.
   Valid options are "file" (the default if unspecified), "jlog" which
   is the a binary 'auto-rotating', consumable, multi-subscriber log
   format.
  </p></dd><dt><span class="term">path</span></dt><dd><p>
   "path" the path to the log (interpreted by the "type"
   implementation).
  </p></dd><dt><span class="term">debug</span></dt><dd><p>
   "debug" (boolean: &lt;true|false&gt;, default false) that dictates
   whether or not the file:line number of the callee will be included
   in the log output.  This only applies loggers that have write
   operations (like files and jlogs).
  </p></dd><dt><span class="term">disabled</span></dt><dd><p>
   "disabled" (boolean: &lt;true|false&gt;, default false) that dictates
   whether the log implmenation will actually write anything.  If set
   to true, the log will be silences and will not propagate input to
   any attached outlets.
  </p></dd><dt><span class="term">timestamps</span></dt><dd><p>
   "debug" (boolean: &lt;true|false&gt;, default false) that dictates
   whether or not a microsecond granular time will be included
   in the log output.  This only applies loggers that have write
   operations (like files and jlogs).
  </p></dd><dt><span class="term">rotate_seconds</span></dt><dd><p>
   "rotate_seconds" (integer: default unset, minimum 600) that specifies
   how many seconds of data the given log file should contain.  Every
   "rotate_seconds" seconds (aligned with UNIX epoch), the log will be
   rotated to a file of the same name with the current UNIX timestamp
   dot-appended.  This can be used in combination with "rotate_bytes"
   for rather interesting results.
  </p></dd><dt><span class="term">rotate_bytes</span></dt><dd><p>
   "rotate_bytes" (integer: default unset, minimum 102400) that specifies
   the maximum number of bytes the file may contain before rotation is
   applied.  This is not enforced after each write, but instead
   the file size is monitored "frequently" and rotation applied.  This
   can mean that the file can grow slightly larger than the specified
   amount.  This can be used in combination with "rotate_seconds" for
   rather interesting results.
  </p></dd></dl></div>
<p>
Within a &lt;log&gt; element, zero, one or many &lt;outlet&gt; elements may be
present.  The outlet element must contain a "name" attribute (this
attribute is not inherited) that matches a *previously* declared &lt;log&gt;
by its "name" attribute.  Foreach &lt;outlet&gt; tag, a sink is created so
that any input sent to the containing &lt;log&gt; will additionally be
propagated to the &lt;outlet&gt;.
</p>
<p>
There is an implicit log named "stderr" that is attached to file
descriptor 2 that has timestamps enabled.
</p>

<section class="section" id="config.generic.section.logs.special"><div class="titlepage"><div><div><h3 class="title">Special log names</h3></div></div></div>
  

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">stderr</span></dt><dd><p>
   opened to file descriptor two during log initialization.
  </p></dd><dt><span class="term">error</span></dt><dd><p>
   destination for error messages.
  </p></dd><dt><span class="term">debug</span></dt><dd><p>
    destination for debugging output.
  </p></dd></dl></div>

<div class="example" id="idm62800970880"><div class="example-title">Example 4.4. Sample configuration for the log section</div><div class="example-contents">

<pre class="programlisting">
  &lt;logs&gt;
    &lt;console&gt;
      &lt;outlet name="stderr" /&gt;
      &lt;log name="error" /&gt;
      &lt;log name="debug" disabled="true" /&gt;
    &lt;/console&gt;
  &lt;/logs&gt;
</pre>
</div></div><br class="example-break"/>

 <p>In the above example:</p>
 <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
   a &lt;console&gt; metagroup is created for the purpose of inheriting the
   "stderr" outlet.  The logs named "error" and "debug" are
   instantiated and inherit the "stderr" outlet.  However, "debug" is
   disabled, so no input to the "debug" log will be written anywhere.
   </p></li></ul></div>
</section>
</section>
</section>
    <section class="chapter" id="config.noitd"><div class="titlepage"><div><div><h2 class="title">Chapter 5. noitd configuration</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#config.noitd.section.logs.special">Special log names</a></span></li><li><span class="section"><a href="#config.noitd.section.checks.special">Configuring checks via configuration</a></span></li><li><span class="section"><a href="#config.noitd.section.filtersets.special">Configuring filtersets via configuration</a></span></li></ul></div>
  
  <div class="example" id="idm62800966304"><div class="example-title">Example 5.1. Basic noitd configuration struture</div><div class="example-contents">
  
  <pre class="programlisting">
  &lt;noit&gt;
    &lt;eventer/&gt;
    &lt;modules&gt;
      &lt;...&gt;
        &lt;module /&gt;
      &lt;/...&gt;
    &lt;/modules&gt;
    &lt;logs&gt;
      &lt;...&gt;
        &lt;log&gt;
          &lt;outlet /&gt;
          &lt;outlet /&gt;
        &lt;/log&gt;
      &lt;/...&gt;
    &lt;/logs&gt;
    &lt;listeners&gt;
      &lt;...&gt;
        &lt;listener/&gt;
        &lt;listener&gt;
          &lt;config /&gt;
          &lt;sslconfig /&gt;
        &lt;listener&gt;
      &lt;/...&gt;
    &lt;/listeners&gt;
    &lt;checks&gt;
      &lt;...&gt;
        &lt;check uuid="xxx" /&gt;
      &lt;/...&gt;
    &lt;/checks&gt;
    &lt;filtersets&gt;
      &lt;filterset name="yyy"&gt;
        &lt;...&gt;
      &lt;/filterset&gt;
    &lt;/filtersets&gt;
  &lt;/noit&gt;
</pre>
</div></div><br class="example-break"/>

<section class="section" id="config.noitd.section.logs.special"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Special log names</h2></div></div></div>
  

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">check</span></dt><dd><p>
   When a check is altered in any way (including creation),
   the identifying attributes, including the uuid, are logged to this
   facility.

   </p><pre class="programlisting">
   'C' TIMESTAMP UUID TARGET MODULE NAME
   </pre><p>
  </p></dd><dt><span class="term">status</span></dt><dd><p>
   When a check status changes (either availability or
   state) and neither the new state nor the old state are "unknown", it
   is considered a state change for the check.  The new availability
   and new state are logged to this facility.

   </p><pre class="programlisting">
   'S' TIMESTAMP UUID STATE AVAILABILITY DURATION STATUS_MESSAGE
   </pre><p>
  </p></dd><dt><span class="term">metrics</span></dt><dd><p>
   Each time a check is completed, the various metrics
   that were observed by the check are logged to this facility.  The
   VALUE is always a string or [[null]] (never binary encoded/packed).
   The TYPE indicates the datatype the check intended when it was
   observed.

   </p><pre class="programlisting">
   'M' TIMESTAMP UUID NAME TYPE VALUE
   </pre><p>

   </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">NAME</span></dt><dd><p>is the name of the metric
      and the encouraged format for this is "name`subname`subsubname`etc"</p></dd><dt><span class="term">TYPE</span></dt><dd>
       <div class="variablelist"><dl class="variablelist"><dt><span class="term">i</span></dt><dd><p>INT32</p></dd><dt><span class="term">I</span></dt><dd><p>UINT32</p></dd><dt><span class="term">l</span></dt><dd><p>INT64</p></dd><dt><span class="term">L</span></dt><dd><p>UINT64</p></dd><dt><span class="term">n</span></dt><dd><p>DOUBLE</p></dd><dt><span class="term">s</span></dt><dd><p>STRING</p></dd></dl></div>
       </dd></dl></div><p>
  </p>
  </dd></dl></div>

<div class="example" id="idm62800948336"><div class="example-title">Example 5.2. Sample configuration for the log section</div><div class="example-contents">

<pre class="programlisting">
  &lt;logs&gt;
    &lt;console&gt;
      &lt;outlet name="stderr" /&gt;
      &lt;log name="error" /&gt;
      &lt;log name="debug" disabled="true" /&gt;
    &lt;/console&gt;
    &lt;log name="feed" type="jlog" path="/var/log/noitd.feed" /&gt;
    &lt;feeds&gt;
      &lt;outlet name="feed" /&gt;
      &lt;log name="check" /&gt;
      &lt;log name="metrics" /&gt;
      &lt;log name="status"&gt;
        &lt;outlet name="error" /&gt;
      &lt;/log&gt;
    &lt;/feeds&gt;
  &lt;/logs&gt;
</pre>
</div></div><br class="example-break"/>

 <p>In the above example:</p>
 <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
   a &lt;console&gt; metagroup is created for the purpose of inheriting the
   "stderr" outlet.  The logs named "error" and "debug" are
   instantiated and inherit the "stderr" outlet.  However, "debug" is
   disabled, so no input to the "debug" log will be written anywhere.
   </p></li><li class="listitem"><p>
   a log named "feed" is created of type "jlog" writing to the
   "/var/log/noitd.feed" directory (jlogs paths are directories, whereas 
   "file" paths are filenames).
   </p></li><li class="listitem"><p>
   a &lt;feeds&gt; metagroup is created for the purpose of inheriting the
   "feed" outlet.  The logs "check," "metrics," and "status" are
   instantiated and will log via the "feed" outlet (all writing to the
   same jlog).  Additionally, the "status" feed is given an additional
   outlet named "error" so we will see inputs to status in both the
   "feed" jlog and on the console ("stderr").
   </p></li></ul></div>
</section>

<section class="section" id="config.noitd.section.checks.special"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Configuring checks via configuration</h2></div></div></div>
  
  <p>Each check in Reconnoiter must live underneath the <code class="code">&lt;checks&gt;</code>
  XML node located immediately beneath the root of the tree.  The XML format of the
  configuration file is quite loose alloing arbitrary nodes with arbitrary names to be
  added to the tree with a few reserved-word exceptions.  One reserved-word exception
  is the <code class="code">&lt;check&gt;</code> node name.  Each check node expresses a check to
  be performed by <span class="command"><strong>noitd</strong></span>.</p>

  <p>Each check node requires a set of attributes that inform its behavior.  These
  attributed are inheritted from parent nodes in a "leaf wins" manner. The following
  attributes are available:</p>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">uuid</span></dt><dd><p>
  a well-formed UUID that uniquely identifies this check in the universe.
  </p></dd><dt><span class="term">name</span></dt><dd><p>
  a convenience name (defaultint to the <code class="code">module</code>. The combination of check
  <code class="code">target</code> and check <code class="code">name</code> must be unique in the running instance.
  </p></dd><dt><span class="term">module</span></dt><dd><p>
  a module that defines what code will run the check.  Modules can be configured to load
  at boot time.  If a module is specified here that is not avaiable in the instance,
  an error will be logged.
  </p></dd><dt><span class="term">target</span></dt><dd><p>
  specified the target "host" against which the check will be performed.  If this is not
  a valid IPv4 or IPv6 address and the domain suffix (the part trailing the last period)
  is not on the suppression list, the target will be resolved using DNS.  Note that checks
  can and will run with target that fails to resolve and this can be desired with a check
  might not need an actual Internet host as a target.
  </p></dd><dt><span class="term">period</span></dt><dd><p>
  the number of milliseconds between invocations of the check.
  </p></dd><dt><span class="term">timeout</span></dt><dd><p>
  the number of milliseconds allowed for the check to complete before it is aborted.
  </p></dd><dt><span class="term">filterset</span></dt><dd><p>
  the name of a filterset (specified in the filtersets section) that will potentially
  limit the submission of gathered metrics upstream to <code class="code">stratcond</code>.
  </p></dd><dt><span class="term">resolve_rtype</span></dt><dd><p>
  define the nature of DNS resolution: <code class="code">prefer-ipv4</code> (default) indicates
  that IPv6 resolution should be used only if IPv4 resolution fails, <code class="code">prefer-ipv6</code>
  indicates that IPv4 resoulution should be used only if IPv6 resolution fails,
  <code class="code">force-ipv4</code> indicates that only IPv4 resolution should be used, and
  <code class="code">force-ipv6</code> indicates that only IPv6 resolution should be used.
  </p></dd></dl></div>
  <div class="example" id="idm62800927680"><div class="example-title">Example 5.3. Sample noitd check configuration.</div><div class="example-contents">
  
  <p>An example with http and ping_icmp check using inheritance.</p>
  <pre class="programlisting">
    &lt;noit&gt;
      &lt;checks resolve_rtype="prefer-ipv4" filterset="default" period="60000" timeout="55000"&gt;
        &lt;dc1&gt;
          &lt;labs target="labs.omniti.com"&gt;
            &lt;check uuid="b33451e0-2deb-11e4-b187-7cd1c3dcddf7" module="http" name="mainsite"/&gt;
              &lt;config&gt;&lt;url&gt;http://labs.omniti.com/&lt;/url&gt;&lt;/config&gt;
            &lt;/check&gt;
            &lt;check&gt; uuid="e5721962-2deb-11e4-a2b4-7cd1c3dcddf7" module="ping_icmp" name="netup"/&gt;
          &lt;/labs&gt;
        &lt;/dc1&gt;
        &lt;dc2 resolve_rtype="prefer-ipv6" period="30000" timeout="29000"&gt;
          &lt;check uuid="3b26427a-2dec-11e4-8288-7cd1c3dcddf7" module="http" name="vcs" target="github.com"/&gt;
            &lt;config&gt;&lt;url&gt;https://github.com/&lt;/url&gt;&lt;/config&gt;
          &lt;/check&gt;
        &lt;/dc2&gt;
      &lt;/checks&gt;
    &lt;/noit&gt;
  </pre>
  </div></div><br class="example-break"/>
</section>

<section class="section" id="config.noitd.section.filtersets.special"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Configuring filtersets via configuration</h2></div></div></div>
  
  <p>Filtersets control which metrics are passed upstream. By default, if no filterset
  is specified, all metrics collected are passed upstream. This can be a recipe for
  disaster requiring significant cleanup if a mistake is made and millions of unique
  metric names are pushed into a check. (e.g. someone encodes userid into a metric name).
  </p>

  <p>Filtersets consist of rules each of which is processed in order.  The first rule
  that matches a given metric terminates the matching algorithm with a result of the type
  of that matching rule.  If no rules match, the metric does not match and it is considered
  a <code class="code">deny</code>.</p>

  <p>Filterset rules support both regular expression (PCRE) matching and direct O(1) hash table
  lookups on each of <code class="code">target</code>, <code class="code">module</code>, <code class="code">name</code>, and
  <code class="code">metric</code>.  If a hash table of matches is provided, the regular expression (if any)
  for that field is not processed at all as if it were never specified (i.e. a hash table's
  existence circumvents regular expression matching.</p>

  <p>Hash table rules can be dynamically constructed via an <code class="code">auto_add</code> attribute
  for each field: <code class="code">target_auto_add</code>, <code class="code">module_auto_add</code>, <code class="code">name_auto_add</code>,
  and <code class="code">metric_auto_add</code>. This field is an integer and new elements will be added to
  the appropriate hash table if the rule fails to match and the size of the hash table does not
  exceed the value specified in this attribute.  This can be used to automatically collect up to
  some constrained number of metrics on a given check without knowing a priori what those metric names
  are. This is a useful technique for preventing a aforementioned disaster condition with
  checks that can produce arbitrary metric names. As hash tables are automatically modified due to rule
  misses, the configuration is automatically updated and written to disk. Note: this behaviour can be confusing
  to an operator if they are making incremental configuration changes via the console and believe they
  are the only one capable of writing the altered configuration.</p>

  <div class="example" id="idm62800916048"><div class="example-title">Example 5.4. Sample noitd 'default' filterset configuration.</div><div class="example-contents">
  
  <p>A default filter that avoids metrics called "minimum", "maximum" and "count" on any ping_icmp check
  and metrics called "cert_start" and "cert_end" on any http check. A filter called "score" that requires
  metrics to contain an underscore and not being with a number.</p>
  <pre class="programlisting">
    &lt;noit&gt;
      &lt;filtersets&gt;
        &lt;filterset name="default"&gt;
          &lt;rule type="deny" module="^ping_icmp$" metric="^(?:minimum|maximum|count)$" /&gt;
          &lt;rule type="deny" module="^http$" metric="^cert_(?:start|end)$" /&gt;
          &lt;rule type="allow"/&gt; &lt;!-- matches anything --&gt;
        &lt;/filterset&gt;
        &lt;filterset name="default"&gt;
          &lt;rule type="deny" metric="^\d"/&gt;
          &lt;rule type="allow" metric="_"/&gt;
          &lt;!-- if we fall off the end here, we have a default deny rule --&gt;
        &lt;/filterset&gt;
      &lt;/filtersets&gt;
    &lt;/noit&gt;
  </pre>
  </div></div><br class="example-break"/>

  <div class="example" id="idm62800914608"><div class="example-title">Example 5.5. Sample noitd dynamic filterset configuration.</div><div class="example-contents">
  
  <p>A filterset called "mystatsd" that will collect up 1000 unique metrics, excluding metrics that
  being with anything but a alpha character or are called "badmetric1" or "badmetric2"</p>
  <pre class="programlisting">
    &lt;noit&gt;
      &lt;filtersets&gt;
        &lt;filterset name="mystatsd"&gt;
          &lt;rule type="deny" metric="^[^a-zA-Z]" /&gt;
          &lt;rule type="deny"&gt;
            &lt;metric&gt;badmetric1&lt;/metric&gt;
            &lt;metric&gt;badmetric2&lt;/metric&gt;
          &lt;/rule&gt;
          &lt;rule type="allow" metric_auto_add="1000"/&gt;
        &lt;/filterset&gt;
      &lt;/filtersets&gt;
    &lt;/noit&gt;
  </pre>
  </div></div><br class="example-break"/>
</section>
</section>
    <section class="chapter" id="config.noitd.modules"><div class="titlepage"><div><div><h2 class="title">Chapter 6. noitd modules</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#idm62801499808">check_test</a></span><ul><li><span class="section"><a href="#idm62801788096">Examples</a></span></li><li><span class="section"><a href="#idm62802681168">REST Endpoint</a></span></li></ul></li><li><span class="section"><a href="#idm62800901824">collectd</a></span><ul><li><span class="section"><a href="#idm62800896096">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800881328">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800862944">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800858496">custom_config</a></span><ul><li><span class="section"><a href="#idm62800853472">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800850352">dns</a></span><ul><li><span class="section"><a href="#idm62800843120">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800834336">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800771264">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800766160">external</a></span><ul><li><span class="section"><a href="#idm62800760448">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800732080">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800700832">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800697680">ganglia</a></span><ul><li><span class="section"><a href="#idm62800692560">Module Configuration</a></span></li></ul></li><li><span class="section"><a href="#idm62800664288">httptrap</a></span><ul><li><span class="section"><a href="#idm62800659104">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800650224">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800626880">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800622736">ip_acl</a></span><ul><li><span class="section"><a href="#idm62800617408">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800614128">lua</a></span><ul><li><span class="section"><a href="#idm62800608912">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800600208">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800597504">mysql</a></span><ul><li><span class="section"><a href="#idm62800592256">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800579104">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800575824">cloudwatch</a></span><ul><li><span class="section"><a href="#idm62800571120">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800570864">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800506752">dhcp</a></span><ul><li><span class="section"><a href="#idm62800501696">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800470320">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800467392">haproxy</a></span><ul><li><span class="section"><a href="#idm62800462016">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800420416">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800417392">http</a></span><ul><li><span class="section"><a href="#idm62800412176">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800411376">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800277392">imap</a></span><ul><li><span class="section"><a href="#idm62800272192">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800271936">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800192688">jezebel</a></span><ul><li><span class="section"><a href="#idm62800185504">Module Configuration</a></span></li><li><span class="section"><a href="#idm62800178416">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800171664">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800168608">keynote</a></span><ul><li><span class="section"><a href="#idm62800162784">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800124704">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800121648">keynote_pulse</a></span><ul><li><span class="section"><a href="#idm62800116384">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800090016">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800086896">memcached</a></span><ul><li><span class="section"><a href="#idm62800081632">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800072864">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800086512">monit</a></span><ul><li><span class="section"><a href="#idm62800064544">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866846944">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866843376">munin</a></span><ul><li><span class="section"><a href="#idm62866837920">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866823184">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866820160">nginx</a></span><ul><li><span class="section"><a href="#idm62866814960">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866784112">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866780960">nrpe</a></span><ul><li><span class="section"><a href="#idm62866775840">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866749424">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866746512">ntp</a></span><ul><li><span class="section"><a href="#idm62866741296">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866724608">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866746128">pop3</a></span><ul><li><span class="section"><a href="#idm62866716736">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866716480">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866657424">redis</a></span><ul><li><span class="section"><a href="#idm62866652368">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866621152">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866618352">elasticsearch</a></span><ul><li><span class="section"><a href="#idm62866613040">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866596608">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866593792">resmon</a></span><ul><li><span class="section"><a href="#idm62866586640">Check Configuration</a></span></li><li><span class="section"><a href="#idm62866560320">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62866557344">smtp</a></span><ul><li><span class="section"><a href="#idm62866551968">Check Configuration</a></span></li><li><span class="section"><a href="#idm62800069584">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62800004256">tcp</a></span><ul><li><span class="section"><a href="#idm62799999008">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799998752">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799933440">varnish</a></span><ul><li><span class="section"><a href="#idm62799928224">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799919456">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799916528">ping_icmp</a></span><ul><li><span class="section"><a href="#idm62799911216">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799887248">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799884480">postgres</a></span><ul><li><span class="section"><a href="#idm62799879168">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799866208">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799862928">selfcheck</a></span><ul><li><span class="section"><a href="#idm62799857696">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799848960">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799862544">snmp</a></span><ul><li><span class="section"><a href="#idm62799840992">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799797344">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799793376">snmptrap</a></span><ul><li><span class="section"><a href="#idm62799787056">Module Configuration</a></span></li><li><span class="section"><a href="#idm62799757888">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799751120">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799747968">ssh2</a></span><ul><li><span class="section"><a href="#idm62799742816">Check Configuration</a></span></li><li><span class="section"><a href="#idm62799742560">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799670896">statsd</a></span><ul><li><span class="section"><a href="#idm62799665600">Module Configuration</a></span></li><li><span class="section"><a href="#idm62799643392">Examples</a></span></li></ul></li></ul></div>
  
  <section class="section" id="idm62801499808"><div class="titlepage"><div><div><h2 class="title" style="clear: both">check_test</h2></div></div></div>
  
  <p>
            This module exposes an API endpoint to 
            allow users to run a check once in transient mode to 
            return the results inline back to the client.
        </p>
  <p>
            The check runs once however it behaves almost exactly like a /check/set</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>check_test.so</p>
      </dd></dl></div>
  <section class="section" id="idm62801788096"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62801994976"><div class="example-title">Example 6.1. Loading the check_test module.</div><div class="example-contents">
      
      <p>This example loads the check_test module.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;generic image="check_test" name="check_test" /&gt;
        &lt;/modules&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
  <section class="section" id="idm62802681168"><div class="titlepage"><div><div><h3 class="title">REST Endpoint</h3></div></div></div>
    
    
    <section class="section" id="idm62805836176"><div class="titlepage"><div><div><h4 class="title">/checks/test</h4></div></div></div>
      
      <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd>
            <p>
              <code class="code">POST</code>
            </p>
          </dd><dt><span class="term">uri</span></dt><dd>
            <p>
              <code class="code">/checks/test</code>
            </p>
          </dd></dl></div>
      <p>
                This call accepts a document describing a check.  In the same request, the check will  
                execute and return the results back to the user.  The check passes through the same validation
                as the /check/set PUT REST call.  The check is marked as transient and won't appear 
                in any persistent log streams.
            </p>
      <p>
                On success, a HTTP 200 is returned and an XML documented that matches the
                format of the <code class="code">/check/show</code> REST command. It is a simpler set of
                output as some of the results wouldn't make sense in this context.
            </p>
      <div class="example" id="idm62800903536"><div class="example-title">Example 6.2. REST /checks/test XML input.</div><div class="example-contents">
        
        <pre class="programlisting">
&lt;?xml version="1.0" encoding="utf8"?&gt;
&lt;check&gt;
  &lt;attributes&gt;
    &lt;name&gt;http&lt;/name&gt;
    &lt;module&gt;http&lt;/module&gt;
    &lt;target&gt;8.8.38.5&lt;/target&gt;
    &lt;period&gt;60000&lt;/period&gt;
    &lt;timeout&gt;5000&lt;/timeout&gt;
    &lt;filterset&gt;default&lt;/filterset&gt;
  &lt;/attributes&gt;
  &lt;config&gt;
    &lt;code&gt;200&lt;/code&gt;
    &lt;url&gt;https://labs.omniti.com/&lt;/url&gt;
  &lt;/config&gt;
&lt;/check&gt;
    </pre>
      </div></div><br class="example-break"/>
    </section>
  </section>
</section>
<section class="section" id="idm62800901824"><div class="titlepage"><div><div><h2 class="title" style="clear: both">collectd</h2></div></div></div>
  
  <p>The collectd module provides collectd support for Reconnoiter.  The collectd modules listens on a UDP port and waits for metrics to come from a collectd agent. It also provides support for signing and encrypting metrics from the collectd agent, which is supported in version 4.7.0 and above.  Only one is supported per target.</p>
  <p>Additionally, this module registers a REST handler to support collectd's write_http output plugin.  This exposes a REST endpoint at /module/collectd.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>collectd.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800896096"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">collectd_port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>25826</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port which collectd packets are received</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">notifications</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>options</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>true</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:true|on|false|off)</p>
              </dd></dl></div>
          <p>Specify whether collectd notifications are acted upon.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800881328"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">security_level</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>An integer detailing the security level which to allow.  0 for all packets allowed, 1 for signed and encrypted packets allowed, 2 for only encrypted packets allowed.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">username</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The collectd username for authenticating signed and encrypted packets. Also the username used for HTTP authentication when using the write_http ingestion method.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">secret</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The collectd password for authenticating signed and encrypted packets. Also the password used for HTTP authentication when using the write_http ingestion method.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800862944"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800862304"><div class="example-title">Example 6.3. Simple encrypted passive checking.</div><div class="example-contents">
      
      <p>The following example allows a collectd agent to send any metric to the noit
      system.  In this example the collectd agent must be version 4.7.0 to support encryption 
      and must be configured with parameters similar to the ones below.  Like the snmptrap 
      module the collectd disregards the timeout value completely, but uses the period to
      batch all the checks in one commit.  If there are &gt;1 metrics within the period the
      check is marked as G and A for state and availability respectively.  The first program
      listing shows a collectd configuration and the second listing shows the corresponding
      check configuration in reconnoiter.</p>
      <pre class="programlisting">
      &lt;Plugin network&gt;
        &lt;Server "127.0.0.1" "25826"&gt;
          SecurityLevel "encrypt"
          Username "us3rname"
          Password "s3cr3t"
        &lt;/Server&gt;
      &lt;/Plugin&gt;

      &lt;Plugin write_http&gt;
        &lt;URL "https://127.0.0.1:43191/module/collectd/"&gt;
          User "us3rname"
          Password "s3cr3t"
          VerifyPeer false
          VerifyHost false
          CACert "/etc/ssl/ca.crt"
          Format "JSON"
          StoreRates false
        &lt;/URL&gt;
      &lt;/Plugin&gt;
      </pre>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="collectd" name="collectd"&gt;
            &lt;config&gt;
              &lt;username&gt;us3rname&lt;/username&gt;
              &lt;secret&gt;s3cr3t&lt;/secret&gt;
              &lt;security_level&gt;2&lt;/security_level&gt;
            &lt;/config&gt;
          &lt;/module&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="1b4e28ba-2fa1-11d2-883f-e9b761bde3fb" module="collectd"
                 target="127.0.0.1" period="60000" timeout="30000"/&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800858496"><div class="titlepage"><div><div><h2 class="title" style="clear: both">custom_config</h2></div></div></div>
  
  <p>
          Allows config options to be namespaced into "custom"
        </p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>custom_config.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800853472"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800852832"><div class="example-title">Example 6.4. Loading the custom_config module.</div><div class="example-contents">
      
      <p>This example loads the custom_config module and creates a
             keyname=valuename config setting.
             </p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;generic image="custom_config" name="custom_config" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;config xmlns:custom="noit://module/custom"&gt;
            &lt;custom:keyname&gt;valuename&lt;/custom:keyname&gt;
          &lt;/config&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800850352"><div class="titlepage"><div><div><h2 class="title" style="clear: both">dns</h2></div></div></div>
  
  <p>The dns module leverages libudns to allow highly concurrent DNS lookups of a variety of DNS RR types.  In the event that you name a dns check <em class="parameter"><code>in-addr.arpa</code></em> with an rtype of <em class="parameter"><code>PTR</code></em>, the result of the query may be used throughout reconnoiter as the identifying hostname of that target.</p>
  <p>This module provides the <code class="function">inaddrarpa</code> interpolation method which will reverse a dot-delimited IP address.  This is particularly useful for constructing in-addr.arpa queries, but also used for checking blacklists, whitelists and other IP-based DNS databases.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>dns.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800843120"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">contexts</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>1024</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The maximum number of contexts to spawn per nameserver.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800834336"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">nameserver</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>%[target_ip] or determined from underlying system</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The domain name server to query. If the name of the check is in-addr.arpa, the system default nameserver is used.  Otherwise, the nameserver is the %[target_ip] of the the check.  If set to the string "default" the underlying system default nameserver is used.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>53</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port on which the remote server's DNS service is running.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ctype</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>IN</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(IN|CH|HS)</p>
              </dd></dl></div>
          <p>The DNS class of the query. IN: Internet, CH: Chaos, HS: Hesoid.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">rtype</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>A|PTR</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(A|AAAA|TXT|MX|SOA|CNAME|PTR|NS|MB|MD|MF|MG|MR)</p>
              </dd></dl></div>
          <p>The DNS resource record type of the query.  If the name of the check is in-addr.arpa, the default is PTR, otherwise it is A.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">query</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>%[name]|%[:inaddrarpa:target_ip]</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The query to send.  If the name of the check is in-addr.arpa, the reverse IP octet notation of in-addr.arpa syntax is synthesized by default.  Otherwise the default query is the name of the check itself.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">want_sort</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>true</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(true|false|on|off)</p>
              </dd></dl></div>
          <p>Sorts (strcmp) the answers if multiple RRs are returned in the result set.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800771264"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800770624"><div class="example-title">Example 6.5. Establishing PTR records for hosts.</div><div class="example-contents">
      
      <p>The following established names for targets 10.1.2.{3,4,5,6} using the local nameserver (10.1.2.2) that provides service for that network.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="dns" name="dns"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;config&gt;
            &lt;nameserver&gt;10.1.2.2&lt;/nameserver&gt;
          &lt;/config&gt;
          &lt;ptr module="dns" name="in-addr.arpa"&gt;
            &lt;check uuid="2cddb2a8-76ff-11dd-83c8-f75cb8b93bd9" target="10.1.2.3"/&gt;
            &lt;check uuid="2dd79110-76ff-11dd-9b54-739adc274a93" target="10.1.2.4"/&gt;
            &lt;check uuid="5627560a-76ff-11dd-941f-4b75679cb908" target="10.1.2.5"/&gt;
            &lt;check uuid="5fdcb8de-76ff-11dd-ae16-2740afc178ae" target="10.1.2.6"/&gt;
          &lt;/ptr&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
    <div class="example" id="idm62800768240"><div class="example-title">Example 6.6. Checking labs.omniti.com.</div><div class="example-contents">
      
      <p>The following checks the DNS server residing at 66.225.209.4 for the A record of labs.omniti.com.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="dns" name="dns"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;ns1 module="dns" target="66.225.209.4"&gt;
            &lt;check uuid="3cddb2a8-76ff-11dd-83c8-f75cb8b93bd9" name="labs.omniti.com"/&gt;
          &lt;/ns1&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800766160"><div class="titlepage"><div><div><h2 class="title" style="clear: both">external</h2></div></div></div>
  
  <p>The external module performs checks via external processes like more traditional monitoring systems.  While this approach is far less efficient and does not scale well on a single system, it provides easier transition from existing monitoring systems.  Checks should exit normally with an exit status of 0 for success, 1 or 2 for failure and 3 for unknown.  Exiting with a status of 3 is highly discouraged.  The standard output is provided as the status of the check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>external.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800760448"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The user under which the external checks should be executed.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">group</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The group under which the external checks should be executed.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">path</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>/</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The path under which all external commands to be executed will be located. Commands outside of this path will not be executed.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">nagios_regex</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>\'?(?&lt;key&gt;[^'=\s]+)\'?=(?&lt;value&gt;-?[0-9]+(\.[0-9]+)?)(?&lt;uom&gt;[a-zA-Z%]+)?(?=[;,\s])</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The default regular expression with which to parse Nagios data. Named values are "key", "value", and "uom" (unit of measurement)</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800732080"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">command</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The path to the command to be executed.  This is the first argument to the execve system call.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">arg0</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The program name.  If not specified, it is derived from the command argument. Normal interpolation rules apply.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">arg\d+</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The arguments to the program.  The external module will start with arg1 and increment collecting arguments until argN is not found.  Normal interpolation rules apply.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">env_\S+</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>These parameters allow the setting of environment variables for the command execution.  The text following env_ is the key and the parameter value is the value of the environment variable to be set via execve.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">output_extract</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This is a regular expression that is globally applied to the stdout of the command.  Each match is turned into a metric. It is a requirement to used named capturing in the regular expression where "key" is the named match of the metric name and "value" is the named match for the matric value.  A sample for extracting performance data from Nagios commands would be: (?&lt;key&gt;\S+)=(?&lt;value&gt;[^;\s]+)(?=[;\s]). "NAGIOS" may also be specified as a value, which will configure the external check to do Nagios parsing based on the nagios_regex module configuration parameter.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800700832"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800700192"><div class="example-title">Example 6.7. Checking a service via the /path/to/check_foo command.</div><div class="example-contents">
      
      <p>The hypothetical check_foo command takes a target host with the -H parameter, runs a check and returns its health via exit code and stdout. We set the environment variable QUUX to the value BAZ.  The check is against host 10.10.2.2.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="external" name="external"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="1e8edc38-0d88-11de-93ee-af2195eab5d5"
                 module="external" name="foo" target="10.10.2.2"&gt;
            &lt;config&gt;
              &lt;command&gt;/path/to/check_foo&lt;/command&gt;
              &lt;arg1&gt;-H&lt;/arg1&gt;
              &lt;arg2&gt;%[target]&lt;/arg2&gt;
              &lt;env_QUUX&gt;BAZ&lt;/env_QUUX&gt;
            &lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800697680"><div class="titlepage"><div><div><h2 class="title" style="clear: both">ganglia</h2></div></div></div>
  
  <p>The Ganglia module provides Ganglia support for Reconnoiter.  The ganglia modules joins a multicast group and waits for metrics to come from a gmond agent.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>ganglia.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800692560"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">multiaddr</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>239.2.11.71</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The address of the multicast group from which which ganglia packets are received</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>8946</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port of the multicast group from which which ganglia packets are received</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">multiaddr6</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The address of the ipv6 multicast group from which which ganglia packets are received</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port6</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port of the ipv6 multicast group from which which ganglia packets are received</p>
        </dd></dl></div>
  </section>
</section>
<section class="section" id="idm62800664288"><div class="titlepage"><div><div><h2 class="title" style="clear: both">httptrap</h2></div></div></div>
  
  <p>The httptrap module provides a simple way to push data into reconnoiter from other applications.  Simply structure a json document and use the PUT method against reconnoiter's psuedo-webserver on port 43191.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>httptrap.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800659104"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">asynch_metrics</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>true</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:true|on|false|off)</p>
              </dd></dl></div>
          <p>Specify whether httptrap metrics are logged immediately or help until the status message is to be emitted.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800650224"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">asynch_metrics</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>true</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:true|on|false|off)</p>
              </dd></dl></div>
          <p>Specify whether httptrap metrics are logged immediately or help until the status message is to be emitted.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">secret</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Specify the secret with which metrics may be submitted.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">delimiter</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>`</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^.$</p>
              </dd></dl></div>
          <p>Specify the delimiter used when flattening metric nmes from the JSON hierarchy.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800626880"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800626240"><div class="example-title">Example 6.8. Posting a string and a number.</div><div class="example-contents">
      
      <p>
        <code class="code">curl -X PUT https://noit:43191/module/httptrap/1b4e28ba-2fa1-11d2-893f-e9b761bde3fb/s3cr3tk3y</code>
      </p>
      <p>PUT payload:</p>
      <pre class="programlisting">
      { "version": "1.alpha",
        "requests": 123853,
        "bignumber": { "_type": "L", "_value": "18426744073707551616" }
      }
      </pre>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="httptrap" name="httptrap"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="1b4e28ba-2fa1-11d2-893f-e9b761bde3fb" module="httptrap"
            target="127.0.0.1" period="60000" timeout="30000"&gt;
            &lt;config&gt;&lt;secret&gt;s3cr3tk3y&lt;/secret&gt;&lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800622736"><div class="titlepage"><div><div><h2 class="title" style="clear: both">ip_acl</h2></div></div></div>
  
  <p>
          This module exposes hooks the pre-flight execution of
          checks and applies user-specified ACLs to possible
          prevent the execution of the check.
        </p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>ip_acl.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800617408"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800616768"><div class="example-title">Example 6.9. Loading the ip_acl module.</div><div class="example-contents">
      
      <p>This example loads the ip_acl module and creates a "global" ACL that denies
             any check running against the host 4.2.2.1 and the entier 10.0.0.0 RFC1819 space.
             </p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;generic image="ip_acl" name="ip_acl" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;config xmlns:ip_acl="noit://module/ip_acl"&gt;
            &lt;ip_acl:global/&gt;
          &lt;/config&gt;
        &lt;/checks&gt;
        &lt;acls&gt;
          &lt;acl name="global"&gt;
            &lt;rule type="deny"&gt;4.2.2.1/32&lt;/rule&gt;
            &lt;rule type="deny"&gt;10.0.0.0/8&lt;/rule&gt;
          &lt;/acl&gt;
        &lt;/acls&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800614128"><div class="titlepage"><div><div><h2 class="title" style="clear: both">lua</h2></div></div></div>
  
  <p>The lua module is a loader that allows the authoring of checks in Lua.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>lua.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800608912"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">directory</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>/install/prefix/modules-lua/?.lua</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This is the lua load path.  See the lua manual for more details on meaning and syntax.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800600208"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800599472"><div class="example-title">Example 6.10. Loading the lua loader.</div><div class="example-contents">
      
      <p>This example loads the lua VM and registers it as a module loader.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="lua" name="lua"&gt;
            &lt;config&gt;
              &lt;directory&gt;/some/other/path/?.lua&lt;/directory&gt;
            &lt;/config&gt;
          &lt;/module&gt;
        &lt;/modules&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800597504"><div class="titlepage"><div><div><h2 class="title" style="clear: both">mysql</h2></div></div></div>
  
  <p>The mysql module allows queries to be performaed against targets as checks.  The results of the query are used as metrics.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>mysql.so</p>
      </dd></dl></div>
  <section class="section" id="idm62800592256"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">dsn</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The connect string for MySQL.  The syntax of this string is explained in the PostgreSQL documentation. See Database Connection Control Functions. The MySQL-specific behavior is explained in the mysql_real_connect documentation.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">sql</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The query that will be executed.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800579104"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800578464"><div class="example-title">Example 6.11. Tracking MySQL database sizes.</div><div class="example-contents">
      
      <p>This will track the sizes of all databases on 10.225.209.35 and 10.225.209.56. We will connect to the mysql database as the user "noit" with password "noit." We only run this check every 5 minutes.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="mysql" name="mysql"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;databases&gt;
            &lt;mysql module="mysql" period="300000"&gt;
              &lt;config&gt;
                &lt;dsn&gt;host=%[target] dbname=%[name] user=noit password=noit&lt;/dsn&gt;
                &lt;sql&gt;select table_schema "dbname", sum( data_length + index_length ) "size" from information_schema.tables group by table_schema&lt;/sql&gt;
              &lt;/config&gt;
              &lt;check uuid="8c5ca46c-77d7-11dd-ab5b-53bc639517d6" target="10.225.209.35"/&gt;
              &lt;check uuid="90b8aea2-77d7-11dd-8447-0f281e6a48eb" target="10.225.209.56"/&gt;
            &lt;/mysql&gt;
          &lt;/databases&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800575824"><div class="titlepage"><div><div><h2 class="title" style="clear: both">cloudwatch</h2></div></div></div>
  
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.cloudwatch</p>
      </dd></dl></div>
  <section class="section" id="idm62800571120"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>https://monitoring.amazonaws.com</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname for the Cloudwatch monitoring server.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">api_key</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The AWS API Key</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">api_secret</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The AWS API Secret</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">namespace</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The namespace to pull parameters from</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">cloudwatch_metrics</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A comma-delimited list of metrics to pull data for</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">granularity</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>5</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>1|5</p>
              </dd></dl></div>
          <p>The granularity of cloudwatch data to pull - one or five minutes</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">statistics</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>Average</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A comma-delimited list of statistics to pull per metric (Choices are: Average, Sum, SampleCount, Maximum, Minimum - "Default" may also be specified to pull recommended values)</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">version</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>2010-08-01</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The version of the Cloudwatch API to use.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">dim_.+</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The dimensions to query for each metric. dim_foo will set a metric with dimension "foo".</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800570864"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800509456"><div class="example-title">Example 6.12. Checking Cloudwatch data</div><div class="example-contents">
      
      <p>This example checks some Cloudwatch data</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="cloudwatch" object="noit.module.cloudwatch"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="2d42adbc-7c7a-11dd-a48f-4f59e0b654d3" module="cloudwatch" period="300000" target="176.32.99.241"&gt;
            &lt;api_key&gt;this_is_a_dummy_key&lt;/api_key&gt;
            &lt;api_secret&gt;this_is_a_dummy_secret&lt;/api_secret&gt;
            &lt;namespace&gt;AWS/EC2&lt;/namespace&gt;
            &lt;cloudwatch_metrics&gt;CPUUtilization&lt;/cloudwatch_metrics&gt;
            &lt;statistics&gt;Average,Sum&lt;/statistics&gt;
            &lt;dim_InstanceId&gt;dummyInstance&lt;/dim_InstanceId&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800506752"><div class="titlepage"><div><div><h2 class="title" style="clear: both">dhcp</h2></div></div></div>
  
  <p>DHCP metrics check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.dhcp</p>
      </dd></dl></div>
  <section class="section" id="idm62800501696"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">send_port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>67</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port to send DHCP request packets to</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">hardware_addr</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>00:00:00:00:00:00</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The hardware address of the host computer</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">host_ip</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>0.0.0.0</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The IP address of the host computer</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">request_type</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>1</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:1|8)</p>
              </dd></dl></div>
          <p>The type of DHCP request message to send</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800470320"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800469680"><div class="example-title">Example 6.13. Checking DHCP connection.</div><div class="example-contents">
      
      <p>This example checks DHCP connection</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="dhcp" object="noit.module.dhcp" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
            &lt;check uuid="79ba881e-ad2e-11de-9fb0-a322e3288ca7" name="dhcp"&gt;
              &lt;config&gt;
                &lt;hardware_addr&gt;00:00:00:00:00:00&lt;/hardware_addr&gt;
                &lt;host_ip&gt;10.80.1.2&lt;/host_ip&gt;
              &lt;/config&gt;
            &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800467392"><div class="titlepage"><div><div><h2 class="title" style="clear: both">haproxy</h2></div></div></div>
  
  <p>Monitor management metrics of a haproxy instance.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.haproxy</p>
      </dd></dl></div>
  <section class="section" id="idm62800462016"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">uri</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>/admin?stats;csv</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^/.+</p>
              </dd></dl></div>
          <p>
      The URL excluding schema and hostname for the haproxy stats CSV export.
      eg /admin?stats;csv
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">host</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>
      Host name to include in HTTP request, defaults to target IP
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>80</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^[0-9]+$</p>
              </dd></dl></div>
          <p>
      Port to connect to
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">select</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>.*</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>
      Specifies a regular expression to pick which metrics to report. Will be matched
      against the pxname and svname columns concatenated by a ","
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>[^:]*</p>
              </dd></dl></div>
          <p>
      The user to authenticate as.
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.*</p>
              </dd></dl></div>
          <p>
      The password to use during authentication.
    </p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800420416"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800419776"><div class="example-title">Example 6.14. Monitor two haproxy instances</div><div class="example-contents">
      
      <p>The following example pulls all metrics available from haproxy running on 10.1.2.3 and 10.1.2.4</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="haproxy" object="noit.module.haproxy"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="2d42adbc-7c7a-11dd-a48f-4f59e0b654d3" module="haproxy" target="10.1.2.3" /&gt;
          &lt;check uuid="324c2234-7c7a-11dd-8585-cbb783f8267f" module="haproxy" target="10.1.2.4" /&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800417392"><div class="titlepage"><div><div><h2 class="title" style="clear: both">http</h2></div></div></div>
  
  <p>The http module performs GET requests over either HTTP or HTTPS and checks the return code and optionally the body.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.http</p>
      </dd></dl></div>
  <section class="section" id="idm62800412176"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname (as you would type into a browser's location bar).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">header_(\S+)</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Allows the setting of arbitrary HTTP headers in the request.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>GET</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\S+</p>
              </dd></dl></div>
          <p>The HTTP method to use.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">payload</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.*</p>
              </dd></dl></div>
          <p>The information transferred as the payload of an HTTP request.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_method</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:Basic|Digest|Auto)$</p>
              </dd></dl></div>
          <p>HTTP Authentication method to use.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>[^:]*</p>
              </dd></dl></div>
          <p>The user to authenticate as.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.*</p>
              </dd></dl></div>
          <p>The password to use during authentication.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validate the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote server (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">code</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>^200$</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The HTTP code that is expected.  If the code received does not match this regular expression, the check is marked as "bad."</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">redirects</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>0</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The maximum number of Location header redirects to follow.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">body</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This regular expression is matched against the body of the response. If a match is not found, the check will be marked as "bad."</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">body_match_*</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This regular expression is matched against the body of the response. If a match is found it is captured and added as a metric. For example, if setting is named 'body_match_foo_bar' and a match is found new metric called 'foo_bar' will be added.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">extract</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This regular expression is matched against the body of the response globally.  The first capturing match is the key and the second capturing match is the value.  Each key/value extracted is registered as a metric for the check.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">pcre_match_limit</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>10000</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>This sets the PCRE internal match limit (see pcreapi documentation).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">include_body</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|false|on|off)$</p>
              </dd></dl></div>
          <p>Include whole response body as a metric with the key 'body'.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">read_limit</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>0</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Sets an approximate limit on the data read (0 means no limit).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">http_version</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>1.1</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(\d+\.\d+)?$</p>
              </dd></dl></div>
          <p>Sets the HTTP version for the check to use.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800411376"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800279888"><div class="example-title">Example 6.15. Checking an HTTP and HTTPS URL.</div><div class="example-contents">
      
      <p>This example checks the OmniTI Labs website over both HTTP and HTTPS.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="http" object="noit.module.http" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;labs target="8.8.38.5" module="http"&gt;
            &lt;check uuid="fe3e984c-7895-11dd-90c1-c74c31b431f0" name="http"&gt;
              &lt;config&gt;&lt;url&gt;http://labs.omniti.com/&lt;/url&gt;&lt;/config&gt;
            &lt;/check&gt;
            &lt;check uuid="1ecd887a-7896-11dd-b28d-0b4216877f83" name="https"&gt;
              &lt;config&gt;&lt;url&gt;https://labs.omniti.com/&lt;/url&gt;&lt;/config&gt;
            &lt;/check&gt;
          &lt;/labs&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800277392"><div class="titlepage"><div><div><h2 class="title" style="clear: both">imap</h2></div></div></div>
  
  <p>IMAP metrics check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.imap</p>
      </dd></dl></div>
  <section class="section" id="idm62800272192"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the management interface can be reached.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The IMAP user.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The IMAP password.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">folder</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>INBOX</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The folder that should be examined.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">search</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Specify an optional IMAP SEARCH operation to execute after EXAMINE</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">fetch</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:true|false|on|off)</p>
              </dd></dl></div>
          <p>Fetch either that highest UID or last SEARCH result.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">use_ssl</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|false|on|off)$</p>
              </dd></dl></div>
          <p>Upgrade TCP connection to use SSL.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validat
e the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote serv
er (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for S
SL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">header_Host</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The host header to validate against the SSL certificate (for SSL checks).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800271936"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800194352"><div class="example-title">Example 6.16. Checking IMAP connection.</div><div class="example-contents">
      
      <p>This example checks IMAP connection with and without SSL.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="imap" object="noit.module.imap" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;imaps target="10.0.7.2" module="imap" period="10000" timeout="5000"&gt;
            &lt;check uuid="79ba881e-ad2e-11de-9fb0-a322e3288ca7" name="imap"&gt;
              &lt;config&gt;
                &lt;port&gt;143&lt;/port&gt;
                &lt;auth_user&gt;bob&lt;/auth_user&gt;
                &lt;auth_password&gt;bob&lt;/auth_password&gt;
              &lt;/config&gt;
            &lt;/check&gt;
            &lt;check uuid="a18659c2-add8-11de-bd01-7ff0e1a67246" name="imaps"&gt;
              &lt;config&gt;
                &lt;port&gt;993&lt;/port&gt;
                &lt;auth_user&gt;bob&lt;/auth_user&gt;
                &lt;auth_password&gt;bob&lt;/auth_password&gt;
                &lt;use_ssl&gt;true&lt;/use_ssl&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/imaps&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800192688"><div class="titlepage"><div><div><h2 class="title" style="clear: both">jezebel</h2></div></div></div>
  
  <p>The jezebel module performs services checks against jezebel and simplifies its special-case Resmon output.</p>
  <p><a class="ulink" href="https://labs.omniti.com/trac/resmon" target="_top"><em class="citetitle">Resmon</em></a> is a light-weight resource monitor that exposes health of services over HTTP in XML.</p>
  <p>This module rides on the http module and provides a secondary phase of XML parsing on the contents that extracts Resmon status messages into metrics that can be trended.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.jezebel</p>
      </dd></dl></div>
  <section class="section" id="idm62800185504"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A comma-separated list of URLs including schema, hostname, and port (as you would type into a browser's location bar).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800178416"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">.+</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.*</p>
              </dd></dl></div>
          <p>All check config values are passed through to jezebel for execution.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800171664"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800171024"><div class="example-title">Example 6.17. Checking resmon services on OmniTI Labs.</div><div class="example-contents">
      
      <p>This example checks the Resmon service on OmniTI Labs.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;jezebel&gt;
            &lt;config&gt;
              &lt;url&gt;http://127.0.0.1:8083/dispatch&lt;/url&gt;
            &lt;/config&gt;
            &lt;module loader="lua" name="com.omniti.jezebel.SampleCheck"
                    object="noit.module.jezebel"/&gt;
          &lt;/jezebel&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;labs target="8.8.38.5" module="com.omniti.jezebel.SampleCheck"&gt;
            &lt;check uuid="36b8ba72-7968-11dd-a67f-d39a2cc3f9de"/&gt;
          &lt;/labs&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800168608"><div class="titlepage"><div><div><h2 class="title" style="clear: both">keynote</h2></div></div></div>
  
  <p>The keynote module fetches telemetry from Keynote(TM) API calls.</p>
  <p>This module rides on the http module and provides a secondary phase of JSON parsing transformation that turns the Keynote data into something useful.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.keynote</p>
      </dd></dl></div>
  <section class="section" id="idm62800162784"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">base_url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>https://api.keynote.com/keynote/api/</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname (as you would type into a browser's location bar).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">api_key</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The Keynote-issued API access key.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">transpagelist</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+(?:,\d+)*</p>
              </dd></dl></div>
          <p>A list of pages.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">pagecomponent</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.</p>
              </dd></dl></div>
          <p>Page component ID.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">slotid_list</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+(?:,\d+)*</p>
              </dd></dl></div>
          <p>A list of Keynote slot ids.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">slot_alias_(\d+)</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A human readable alias for a given slot id.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800124704"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800124064"><div class="example-title">Example 6.18. Checking Keynote services.</div><div class="example-contents">
      
      <p>This example checks two slots: 10 and 11.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="keynote" object="noit.module.keynote"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;keynote target="api.keynote.com" module="keynote"&gt;
            &lt;config&gt;
              &lt;api_key&gt;917c1660-5136-11e3-afd7-7cd1c3dcddf7&lt;/api_key&gt;
            &lt;/config&gt;
            &lt;check uuid="36b8ba72-7968-11dd-a67f-d39a2cc3f9de" period="300000"&gt;
              &lt;config&gt;
                &lt;slotid_list&gt;10,11&lt;/slotid_list&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/keynote&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800121648"><div class="titlepage"><div><div><h2 class="title" style="clear: both">keynote_pulse</h2></div></div></div>
  
  <p>The keynote module fetches telemetry from Keynote(TM) Pulse API.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.keynote_pulse</p>
      </dd></dl></div>
  <section class="section" id="idm62800116384"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">base_url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>https://datapulse.keynote.com/</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname (as you would type into a browser's location bar).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The Keynote-issued Pulse API username.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The Keynote-issued Pulse API password.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">agreement_id</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The Keynote-issued agreement_id for the service.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800090016"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800089376"><div class="example-title">Example 6.19. Checking Keynote services.</div><div class="example-contents">
      
      <p>This example checks agreement_id: 1.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="keynote_pulse" object="noit.module.keynote_pulse"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;keynote target="datapulse.keynote.com" module="keynote_pulse"&gt;
            &lt;config&gt;
              &lt;user&gt;bob&lt;/user&gt;
              &lt;password&gt;bobspassword&lt;/password&gt;
            &lt;/config&gt;
            &lt;check uuid="36b8ba72-7968-11dd-a67f-d39a2cc3f9de" period="300000"&gt;
              &lt;config&gt;
                &lt;agreement_id&gt;1&lt;/agreement_id&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/keynote&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800086896"><div class="titlepage"><div><div><h2 class="title" style="clear: both">memcached</h2></div></div></div>
  
  <p>Monitor memcache usage metrics.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.memcached</p>
      </dd></dl></div>
  <section class="section" id="idm62800081632"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>11211</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the memcache interface can be reached.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800072864"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800072224"><div class="example-title">Example 6.20. Monitor two memcache instances with management on port 11211</div><div class="example-contents">
      
      <p>The following example pulls all metrics available from memcached running on 10.1.2.3 and 10.1.2.4 using standard port</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="memcached" object="noit.module.memcached"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="2d42adbc-7c7a-11dd-a48f-4f59e0b654d3" module="memcached" target="10.1.2.3" /&gt;
          &lt;check uuid="324c2234-7c7a-11dd-8585-cbb783f8267f" module="memcached" target="10.1.2.4" /&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800086512"><div class="titlepage"><div><div><h2 class="title" style="clear: both">monit</h2></div></div></div>
  
  <p>The Monit module parses XML data from the Monit service and returns the values as metrics.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.monit</p>
      </dd></dl></div>
  <section class="section" id="idm62800064544"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname (as you would type into a browser's location bar).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port on which the Monit server is running.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">read_limit</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>0</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Sets an approximate limit on the data read (0 means no limit).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">header_(\S+)</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Allows the setting of arbitrary HTTP headers in the request.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The Monit user</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The Monit password</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validate the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote server (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866846944"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866846176"><div class="example-title">Example 6.21. Checking Monit services on localhost</div><div class="example-contents">
      
      <p>This example checks the Monit service on localhost.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="monit" object="noit.module.monit"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check target="127.0.0.1" module="monit" name="monit" uuid="a524f3fb-f60c-434f-98a4-060ab42e1b7d" period="10000" timeout="5000"&gt;
            &lt;config&gt;
              &lt;url&gt;http://127.0.0.1:2812/_status?format=xml&lt;/url&gt;
              &lt;port&gt;2812&lt;/port&gt;
              &lt;auth_user&gt;admin&lt;/auth_user&gt;
              &lt;auth_password&gt;monit&lt;/auth_password&gt;
            &lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866843376"><div class="titlepage"><div><div><h2 class="title" style="clear: both">munin</h2></div></div></div>
  
  <p>Monitor metrics exposed by a munin-node instance.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.munin</p>
      </dd></dl></div>
  <section class="section" id="idm62866837920"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>4949</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the management interface can be reached.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">plugins</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of space separated plugins from which to fetch metrics. If not specified, a list will be retrieved from the munin node.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866823184"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866822544"><div class="example-title">Example 6.22. Monitor a node running munun-node</div><div class="example-contents">
      
      <p>The following example pulls all munin metrics from 10.1.2.3 and just "processes" metrics from 10.1.2.4</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="munin" object="noit.module.munin"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="535cc224-9f66-11df-b198-8b094b17808a" module="munin" target="10.1.2.3" /&gt;
          &lt;check uuid="5acce980-9f66-11df-8027-ebfe9d8b53e1" module="munin" target="10.1.2.4"&gt;
            &lt;config&gt;&lt;plugins&gt;processes&lt;/plugins&gt;&lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866820160"><div class="titlepage"><div><div><h2 class="title" style="clear: both">nginx</h2></div></div></div>
  
  <p>The nginx module gathers information from the nginx stub_status module</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.nginx</p>
      </dd></dl></div>
  <section class="section" id="idm62866814960"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname for the status output from nginx.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validate the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote server (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866784112"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866783472"><div class="example-title">Example 6.23. Monitor an nginx server with a status page available at http://10.1.2.3/nginx_status</div><div class="example-contents">
      
      <p>The following example pulls metrics from Nginx's status module (http://wiki.nginx.org/HttpStubStatusModule) from http://10.1.2.3/nginx_status</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="nginx" object="noit.module.nginx"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
         &lt;check uuid="CAC1A58F-1670-4F71-8D15-21461D3F6624" name="nginx_10123" module="nginx" target="10.1.2.3"&gt;
           &lt;config&gt;
             &lt;url&gt;http://10.1.2.3/nginx_status&lt;/url&gt;
           &lt;/config&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866780960"><div class="titlepage"><div><div><h2 class="title" style="clear: both">nrpe</h2></div></div></div>
  
  <p>Nagios NRPE (v2) check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.nrpe</p>
      </dd></dl></div>
  <section class="section" id="idm62866775840"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the management interface can be reached.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">use_ssl</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>true</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|false|on|off)$</p>
              </dd></dl></div>
          <p>Upgrade TCP connection to use SSL.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">command</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Command to run on the remote node.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">append_uom</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:true|false|on|off)</p>
              </dd></dl></div>
          <p>If the value comes back with a unit of measure, append it to the metric name.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866749424"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866748784"><div class="example-title">Example 6.24. Checking load via NRPE.</div><div class="example-contents">
      
      <p>This check runs check_load on the remote host.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="nrpe" object="noit.module.nrpe" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="79ba881e-ad2e-11de-9fb0-a322e3288ca7" name="load"
                 target="10.0.7.2" module="nrpe" period="10000" timeout="5000"&gt;
            &lt;config&gt;&lt;comand&gt;check_load&lt;/command&gt;&lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866746512"><div class="titlepage"><div><div><h2 class="title" style="clear: both">ntp</h2></div></div></div>
  
  <p>Determine clock skew from an NTP source.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.ntp</p>
      </dd></dl></div>
  <section class="section" id="idm62866741296"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>123</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port to which we will attempt to speak NTP.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">control</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>^false$</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|on|false|off)$</p>
              </dd></dl></div>
          <p>Use the NTP control protocol to learn about the other end.  If thise ois not true/on, then this check will determine the NTP telemetry of the target relative to the agent's local time.  If it is true/on, then the agent will request the NTP telemetry of the target regarding it's preferred peer.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866724608"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866723968"><div class="example-title">Example 6.25. Monitor an NTP service</div><div class="example-contents">
      
      <p>The following example monitors an NTP services on 10.1.2.3.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="ntp" object="noit.module.ntp"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="4ee1a1e2-1e60-11df-8e99-bf796ca462ef" module="ntp" target="10.1.2.3" period="60000" timeout="5000"/&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866746128"><div class="titlepage"><div><div><h2 class="title" style="clear: both">pop3</h2></div></div></div>
  
  <p>POP3 metrics check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.pop3</p>
      </dd></dl></div>
  <section class="section" id="idm62866716736"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the management interface can be reached.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The POP3 user.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">auth_password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The POP3 password.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">use_ssl</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|false|on|off)$</p>
              </dd></dl></div>
          <p>Upgrade TCP connection to use SSL.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validat
e the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote serv
er (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for S
SL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">expected_certificate_name</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The expected certificate name to validate against the SSL certificate (for SSL checks).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866716480"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866659872"><div class="example-title">Example 6.26. Checking POP3 connection.</div><div class="example-contents">
      
      <p>This example checks the POP connection.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="imap" object="noit.module.pop3" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check target="10.0.7.2" module="pop3" name="pop3" uuid="79ba881e-ad2e-11de-9fb0-a322e3288ca7" period="10000" timeout="5000"&gt;
            &lt;config&gt;
              &lt;port&gt;110&lt;/port&gt;
              &lt;auth_user&gt;bob&lt;/auth_user&gt;
              &lt;auth_password&gt;bob&lt;/auth_password&gt;
              &lt;use_ssl&gt;false&lt;/use_ssl&gt;
            &lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866657424"><div class="titlepage"><div><div><h2 class="title" style="clear: both">redis</h2></div></div></div>
  
  <p>Redis check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.redis</p>
      </dd></dl></div>
  <section class="section" id="idm62866652368"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>6379</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>
        Specifies the port on which redis is running.
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">command</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>INFO</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>
        Command to send to redis server.
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">dbindex</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>0</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>
        Index of the database the command will run against
    </p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>
        Auth password for redis
    </p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866621152"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866620512"><div class="example-title">Example 6.27. Checking Redis</div><div class="example-contents">
      
      <p>This example checks Redis by issuing the INFO command</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="redis" object="noit.module.redis" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="052852f2-fd09-4751-8889-a313a70c3c9c" module="redis" target="127.0.0.1" /&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866618352"><div class="titlepage"><div><div><h2 class="title" style="clear: both">elasticsearch</h2></div></div></div>
  
  <p>The elasticsearch module pulls JSON stats from Elasticsearch</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.resmon</p>
      </dd></dl></div>
  <section class="section" id="idm62866613040"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>http:///_nodes/_local/stats?os=true&amp;process=true&amp;fs=true</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname (as you would type into a browser's location bar).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>9200</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The TCP port can be specified to overide the default of 9200.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866596608"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866595968"><div class="example-title">Example 6.28. Checking elasticsearch services on a node es1.int.foo_</div><div class="example-contents">
      
      <p>This example checks the Elasticsearch service on the es1.int.foo_ node.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="elasticsearch" object="noit.module.resmon"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;es target="es1.int.foo_" module="elasticsearch"&gt;
            &lt;check uuid="2503f08c-7a0f-11e3-9ba0-7cd1c3dcddf7"/&gt;
          &lt;/es&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866593792"><div class="titlepage"><div><div><h2 class="title" style="clear: both">resmon</h2></div></div></div>
  
  <p>The resmon module performs services checks against an HTTP server serving with Resmon XML or JSON.</p>
  <p><a class="ulink" href="https://labs.omniti.com/trac/resmon" target="_top"><em class="citetitle">Resmon</em></a> is a light-weight resource monitor that exposes health of services over HTTP in XML.</p>
  <p>This module rides on the http module and provides a secondary phase of XML parsing on the contents that extracts Resmon status messages into metrics that can be trended.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.resmon</p>
      </dd></dl></div>
  <section class="section" id="idm62866586640"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">url</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The URL including schema and hostname (as you would type into a browser's location bar).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The TCP port can be specified to overide the default of 81.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">read_limit</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>0</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Sets an approximate limit on the data read (0 means no limit).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">header_(\S+)</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Allows the setting of arbitrary HTTP headers in the request.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62866560320"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62866559680"><div class="example-title">Example 6.29. Checking resmon services on OmniTI Labs.</div><div class="example-contents">
      
      <p>This example checks the Resmon service on OmniTI Labs.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="resmon" object="noit.module.resmon"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;labs target="8.8.38.5" module="resmon"&gt;
            &lt;check uuid="36b8ba72-7968-11dd-a67f-d39a2cc3f9de"&gt;
              &lt;config&gt;
                &lt;auth_user&gt;foo&lt;/auth_user&gt;
                &lt;auth_password&gt;bar&lt;/auth_password&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/labs&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62866557344"><div class="titlepage"><div><div><h2 class="title" style="clear: both">smtp</h2></div></div></div>
  
  <p>Send an email via an SMTP server.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.smtp</p>
      </dd></dl></div>
  <section class="section" id="idm62866551968"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>25</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the TCP port to connect to.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ehlo</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>noit.local</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Specifies the EHLO parameter.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">from</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Specifies the envelope sender.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">to</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Specifies the envelope recipient, if blank issue quit.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">payload</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>Subject: Testing</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Specifies the payload sent (on the wire). CR LF DOT CR LF is appended automatically.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">starttls</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:true|false)</p>
              </dd></dl></div>
          <p>Specified if the client should attempt a STARTTLS upgrade</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validate the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote server (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">sasl_authentication</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>off</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(?:off|login|plain)</p>
              </dd></dl></div>
          <p>Specifies the type of SASL Authentication to use</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">sasl_user</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The SASL Authentication username</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">sasl_password</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The SASL Authentication password</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">sasl_auth_id</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The SASL Authorization Identity</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62800069584"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62800006672"><div class="example-title">Example 6.30. Send an email to test SMTP service.</div><div class="example-contents">
      
      <p>The following example sends an email via 10.80.117.6 from test@omniti.com to devnull@omniti.com</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="smtp" object="noit.module.smtp"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="2d42adbc-7c7a-11dd-a48f-4f59e0b654d3" module="smtp" target="10.80.117.6"&gt;
            &lt;config&gt;
              &lt;from&gt;test@omniti.com&lt;/from&gt;
              &lt;to&gt;devnull@omniti.com&lt;/to&gt;
            &lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62800004256"><div class="titlepage"><div><div><h2 class="title" style="clear: both">tcp</h2></div></div></div>
  
  <p>TCP metrics check.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.tcp</p>
      </dd></dl></div>
  <section class="section" id="idm62799999008"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the management interface can be reached.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">banner_match</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This regular expression is matched against the response banner.  If a match is not found, the check will be marked as bad.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">send_body</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Data to send on the socket once connected and optionally SSL is negotiated, but before the body match is tested.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">body_match</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>This regular expression is matched against the body (the leftover data up to 1024 bytes) after the banner.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">use_ssl</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|false|on|off)$</p>
              </dd></dl></div>
          <p>Upgrade TCP connection to use SSL.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ca_chain</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing all the certificate authorities that should be loaded to validat
e the remote certificate (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">certificate_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing the client certificate that will be presented to the remote serv
er (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">key_file</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A path to a file containing key to be used in conjunction with the cilent certificate (for S
SL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">ciphers</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>A list of ciphers to be used in the SSL protocol (for SSL checks).</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">header_Host</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The host header to validate against the SSL certificate (for SSL checks).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799998752"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799936112"><div class="example-title">Example 6.31. Checking TCP connection.</div><div class="example-contents">
      
      <p>This example checks IMAP connection with and without SSL.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="tcp" object="noit.module.tcp" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;imaps target="10.0.7.2" module="tcp" period="10000" timeout="5000"&gt;
            &lt;check uuid="79ba881e-ad2e-11de-9fb0-a322e3288ca7" name="imap"&gt;
              &lt;config&gt;
                &lt;port&gt;143&lt;/port&gt;
                &lt;banner_match&gt;^\* OK&lt;/banner_match&gt;
              &lt;/config&gt;
            &lt;/check&gt;
            &lt;check uuid="a18659c2-add8-11de-bd01-7ff0e1a67246" name="imaps"&gt;
              &lt;config&gt;
                &lt;port&gt;993&lt;/port&gt;
                &lt;banner_match&gt;^\* OK&lt;/banner_match&gt;
                &lt;use_ssl&gt;true&lt;/use_ssl&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/imaps&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799933440"><div class="titlepage"><div><div><h2 class="title" style="clear: both">varnish</h2></div></div></div>
  
  <p>Monitor maagement metrics of a Varnish instance.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>lua</p>
      </dd><dt><span class="term">object</span></dt><dd>
        <p>noit.module.varnish</p>
      </dd></dl></div>
  <section class="section" id="idm62799928224"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>8081</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>Specifies the port on which the management interface can be reached.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799919456"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799918816"><div class="example-title">Example 6.32. Monitor two varnish instances with management on port 8081</div><div class="example-contents">
      
      <p>The following example pulls are metrics available from Varnish running on 10.1.2.3 and 10.1.2.4</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="varnish" object="noit.module.varnish"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="2d42adbc-7c7a-11dd-a48f-4f59e0b654d3" module="varnish" target="10.1.2.3" /&gt;
          &lt;check uuid="324c2234-7c7a-11dd-8585-cbb783f8267f" module="varnish" target="10.1.2.4" /&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799916528"><div class="titlepage"><div><div><h2 class="title" style="clear: both">ping_icmp</h2></div></div></div>
  
  <p>The ping_icmp module provide ICMP checks against targets.  It sends a series of ICMP requests and waits for their responses tallying their turn-around time.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>ping_icmp.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799911216"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">interval</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>2000</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The number of milliseconds between ICMP requests.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">count</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>5</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The number of ICMP requests to send during a single check.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">avail_needed</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>100</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The percentage of ICMP available required for the check to be considered "good."  By default, 100% of the ICMP requests must have responses for a good state.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799887248"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799886608"><div class="example-title">Example 6.33. Ping checks against a host</div><div class="example-contents">
      
      <p>Ping 4.2.2.1 once a second for ten seconds recurring every 60 seconds.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="ping_icmp" name="ping_icmp"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;ping module="ping_icmp" period="60000"&gt;
            &lt;config&gt;
              &lt;count&gt;10&lt;/count&gt;
              &lt;interval&gt;1000&lt;/interval&gt;
            &lt;/config&gt;
            &lt;check uuid="5b9fab60-77d4-11dd-99a4-97df794be4c8" target="4.2.2.1"/&gt;
          &lt;/ping&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799884480"><div class="titlepage"><div><div><h2 class="title" style="clear: both">postgres</h2></div></div></div>
  
  <p>The postgres module allows queries to be performaed against targets as checks.  The results of the query are used as metrics.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>postgres.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799879168"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">dsn</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The connect string for PostgreSQL.  The syntax of this string is documented in your PostgreSQL documentation. See Database Connection Control Functions.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">sql</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The query that will be executed.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799866208"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799865568"><div class="example-title">Example 6.34. Tracking PostgreSQL database sizes.</div><div class="example-contents">
      
      <p>This will track the sizes of all databases on 10.225.209.35 and 10.225.209.56. We will connect to the postgres database as the user "noit" with password "noit." We only run this check every 5 minutes.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="postgres" name="postgres"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;databases&gt;
            &lt;postgres  module="postgres" period="300000"&gt;
              &lt;config&gt;
                &lt;dsn&gt;host=%[target] dbname=%[name] user=noit password=noit&lt;/dsn&gt;
                &lt;sql&gt;select datname, pg_database_size(datname) as size, xact_commit, xact_rollback from pg_stat_database&lt;/sql&gt;
              &lt;/config&gt;
              &lt;check uuid="8c5ca46c-77d7-11dd-ab5b-53bc659517d6" target="10.225.209.35"/&gt;
              &lt;check uuid="90b8aea2-77d7-11dd-8447-0f381e6a48eb" target="10.225.209.56"/&gt;
            &lt;/postgres&gt;
          &lt;/databases&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799862928"><div class="titlepage"><div><div><h2 class="title" style="clear: both">selfcheck</h2></div></div></div>
  
  <p>The selfcheck module performs a self assessment on the host noitd instance.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>selfcheck.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799857696"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">feedname</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>feed</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The name of the feed that will be sized.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799848960"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799848320"><div class="example-title">Example 6.35. Testing the local noitd instance.</div><div class="example-contents">
      
      <p>We self check the noitd instance every 5 seconds.  Here, the target doesn't mean anything in particular as the check is entirely internal.  The target should match the local noitd's IP address from the perspective of stratcond.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="selfcheck" name="selfcheck"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="6e65ffdc-f174-11dd-86fe-b7da9645ce7c" target="10.225.209.90" period="5000" timeout="4000"/&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799862544"><div class="titlepage"><div><div><h2 class="title" style="clear: both">snmp</h2></div></div></div>
  
  <p>The snmp module provides SNMP polling support for reconnoiter.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>snmp.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799840992"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">community</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>public</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The SNMP community string providing read access.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>161</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The UDP port to which SNMP queries will be sent.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">version</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>2c</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>(1|2c|3)</p>
              </dd></dl></div>
          <p>The SNMP version used for queries.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">oid_.+</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Defines a metric to query.  Key oid_foo will establish a metric called foo.  The value of the parameter should be an OID either in decimal notation or MIB name.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">type_.+</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>Defines a coercion for a metric type.  The name of the metric must identically match one of the oid_(.+) patterns. The value can be either one of the single letter codes in the metric_type_t enum or the following string variants: guess, int32, uint32, int64, uint64, double, string.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">separate_queries</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>false</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:true|false|on|off)$</p>
              </dd></dl></div>
          <p>Whether or not to query each OID separately.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799797344"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799796704"><div class="example-title">Example 6.36. Simple snmp polling of two switchports</div><div class="example-contents">
      
      <p>The following example configures SNMP checks against switchport 1 and 2
      on the switch with the IP address 10.80.116.3.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="snmp" name="snmp"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;switch target="10.80.116.3" module="snmp"&gt;
            &lt;config&gt;
              &lt;community&gt;SeKr3t&lt;/community&gt;
              &lt;oid_description&gt;IF-MIB::ifName.%[name]&lt;/oid_description&gt;
              &lt;oid_alias&gt;IF-MIB::ifAlias.%[name]&lt;/oid_alias&gt;
              &lt;oid_speed&gt;IF-MIB::ifSpeed.%[name]&lt;/oid_speed&gt;
              &lt;oid_adminstatus&gt;IF-MIB::ifAdminStatus.%[name]&lt;/oid_adminstatus&gt;
              &lt;oid_operstatus&gt;IF-MIB::ifOperStatus.%[name]&lt;/oid_operstatus&gt;
              &lt;oid_inoctets&gt;IF-MIB::ifHCInOctets.%[name]&lt;/oid_inoctets&gt;
              &lt;oid_outoctets&gt;IF-MIB::ifHCOutOctets.%[name]&lt;/oid_outoctets&gt;
              &lt;oid_inerrors&gt;IF-MIB::ifInErrors.%[name]&lt;/oid_inerrors&gt;
              &lt;oid_outerrors&gt;IF-MIB::ifOutErrors.%[name]&lt;/oid_outerrors&gt;
              &lt;oid_indiscards&gt;IF-MIB::ifInDiscards.%[name]&lt;/oid_indiscards&gt;
              &lt;oid_outdiscards&gt;IF-MIB::ifOutDiscards.%[name]&lt;/oid_outdiscards&gt;
              &lt;oid_inucastpkts&gt;IF-MIB::ifHCInUcastPkts.%[name]&lt;/oid_inucastpkts&gt;
              &lt;oid_outucastpkts&gt;IF-MIB::ifHCOutUcastPkts.%[name]&lt;/oid_outucastpkts&gt;
              &lt;oid_inbcastpkts&gt;IF-MIB::ifHCInBroadcastPkts.%[name]&lt;/oid_inbcastpkts&gt;
              &lt;oid_outbcastpkts&gt;IF-MIB::ifHCOutBroadcastPkts.%[name]&lt;/oid_outbcastpkts&gt;
            &lt;/config&gt;
            &lt;check uuid="1b4e28ba-2fa1-11d2-883f-e9b761bde3fb" name="1"/&gt;
            &lt;check uuid="4deb0724-ccee-4360-83bc-255e7b9d989d" name="2"/&gt;
          &lt;/switch&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
    <div class="example" id="idm62799795040"><div class="example-title">Example 6.37. Example using config inheritance to show reuse</div><div class="example-contents">
      
      <p>Accomplising the same goal, but by using reuse:</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="snmp" name="snmp"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;switch target="10.80.116.3" module="snmp"&gt;
            &lt;config inherit="SwitchPortX"/&gt;
              &lt;community&gt;SeKr3t&lt;/community&gt;
            &lt;/config&gt;
            &lt;check uuid="1b4e28ba-2fa1-11d2-883f-e9b761bde3fb" name="1"/&gt;
            &lt;check uuid="4deb0724-ccee-4360-83bc-255e7b9d989d" name="2"/&gt;
          &lt;/switch&gt;
        &lt;/checks&gt;
        &lt;config_templates&gt;
          &lt;config id="SwitchPortX"&gt;
            &lt;oid_description&gt;IF-MIB::ifName.%[name]&lt;/oid_description&gt;
            &lt;oid_alias&gt;IF-MIB::ifAlias.%[name]&lt;/oid_alias&gt;
            &lt;oid_speed&gt;IF-MIB::ifSpeed.%[name]&lt;/oid_speed&gt;
            &lt;oid_adminstatus&gt;IF-MIB::ifAdminStatus.%[name]&lt;/oid_adminstatus&gt;
            &lt;oid_operstatus&gt;IF-MIB::ifOperStatus.%[name]&lt;/oid_operstatus&gt;
            &lt;oid_inoctets&gt;IF-MIB::ifHCInOctets.%[name]&lt;/oid_inoctets&gt;
            &lt;oid_outoctets&gt;IF-MIB::ifHCOutOctets.%[name]&lt;/oid_outoctets&gt;
            &lt;oid_inerrors&gt;IF-MIB::ifInErrors.%[name]&lt;/oid_inerrors&gt;
            &lt;oid_outerrors&gt;IF-MIB::ifOutErrors.%[name]&lt;/oid_outerrors&gt;
            &lt;oid_indiscards&gt;IF-MIB::ifInDiscards.%[name]&lt;/oid_indiscards&gt;
            &lt;oid_outdiscards&gt;IF-MIB::ifOutDiscards.%[name]&lt;/oid_outdiscards&gt;
            &lt;oid_inucastpkts&gt;IF-MIB::ifHCInUcastPkts.%[name]&lt;/oid_inucastpkts&gt;
            &lt;oid_outucastpkts&gt;IF-MIB::ifHCOutUcastPkts.%[name]&lt;/oid_outucastpkts&gt;
            &lt;oid_inbcastpkts&gt;IF-MIB::ifHCInBroadcastPkts.%[name]&lt;/oid_inbcastpkts&gt;
            &lt;oid_outbcastpkts&gt;IF-MIB::ifHCOutBroadcastPkts.%[name]&lt;/oid_outbcastpkts&gt;
          &lt;/config&gt;
        &lt;/config_templates&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799793376"><div class="titlepage"><div><div><h2 class="title" style="clear: both">snmptrap</h2></div></div></div>
  
  <p>The snmptrap module provides SNMP trap daemon support for reconnoiter.  Reconnoiter comes with a <span class="command"><strong>snmptrap</strong></span>-based helper utility called <span class="command"><strong>noittrap</strong></span> aimed to assist with the complexities of forming valid SNMP traps to this module.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>snmp.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799787056"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">community</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>required</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The SNMP community string providing trap access.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">snmptrapd_port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The port on which traps are accepted.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799757888"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">community</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>.+</p>
              </dd></dl></div>
          <p>The SNMP community string providing trap access (overrides modules config).</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799751120"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799750480"><div class="example-title">Example 6.38. Simple passive checking.</div><div class="example-contents">
      
      <p>The following example configures a check prepared to accept traps from
      host 10.1.1.1.  Traps must be performed with the community name 's3cr3t'. Note that
      because this check is passive, the timeout and period mean nothing to reconnoiter.
      Though these values may be used by an upstream provider for fault detection.</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="snmp" name="snmptrap"&gt;
            &lt;config&gt;
              &lt;community&gt;s3cr3t&lt;/community&gt;
            &lt;/config&gt;
          &lt;/module&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="1b4e28ba-2fa1-11d2-883f-e9b761bde3fb" module="snmptrap" name="magic"
                 period="60000" timeout="30000"/&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799747968"><div class="titlepage"><div><div><h2 class="title" style="clear: both">ssh2</h2></div></div></div>
  
  <p>The ssh2 module allows reconnoiter to connect to servers over ssh protocol 2 and test the fingerprint.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>ssh2.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799742816"><div class="titlepage"><div><div><h3 class="title">Check Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>22</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>\d+</p>
              </dd></dl></div>
          <p>The TCP port on which the remote server's ssh service is running.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_kex</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^diffie-hellman-(?:group1-sha1|group14-sha1|group-exchange-sha1)$</p>
              </dd></dl></div>
          <p>The key exchange method to use.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_hostkey</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:ssh-dss|ssh-rsa)$</p>
              </dd></dl></div>
          <p>The host key algorithm supported.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_crypt_cs</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:aes256-ctr|aes192-ctr|aes128-ctr|aes256-cbc|aes192-cbc|aes128-cbc|blowfish-cbc|arcfour128|arcfour|cast128-cbc|3des-cbc|none)$</p>
              </dd></dl></div>
          <p>The encryption algorithm used from client to server.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_crypt_sc</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:aes256-ctr|aes192-ctr|aes128-ctr|aes256-cbc|aes192-cbc|aes128-cbc|blowfish-cbc|arcfour128|arcfour|cast128-cbc|3des-cbc|none)$</p>
              </dd></dl></div>
          <p>The encryption algorithm used from server to client.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_mac_cs</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:hmac-sha1|hmac-sha1-96|hmac-md5|hmac-md5-96|hmac-ripemd160|none)$</p>
              </dd></dl></div>
          <p>The message authentication code algorithm used from client to server.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_mac_sc</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p/>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:hmac-sha1|hmac-sha1-96|hmac-md5|hmac-md5-96|hmac-ripemd160|none)$</p>
              </dd></dl></div>
          <p>The message authentication code algorithm used from server to client.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_comp_cs</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>none</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:zlib|none)$</p>
              </dd></dl></div>
          <p>The compress algorithm used from client to server.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">method_comp_sc</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>none</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^(?:zlib|none)$</p>
              </dd></dl></div>
          <p>The compress algorithm used from server to client.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799742560"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799673168"><div class="example-title">Example 6.39. Simple ssh polling of 4 machines</div><div class="example-contents">
      
      <p>The following checks ssh on 10.1.2.{3,4,5,6}</p>
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="ssh2" name="ssh2"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;ssh module="ssh2"&gt;
            &lt;check uuid="1cddb2a8-76ff-11dd-83c8-f75cb8b93bd9" target="10.1.2.3"/&gt;
            &lt;check uuid="1dd79110-76ff-11dd-9b54-739adc274a93" target="10.1.2.4"/&gt;
            &lt;check uuid="4627560a-76ff-11dd-941f-4b75679cb908" target="10.1.2.5"/&gt;
            &lt;check uuid="4fdcb8de-76ff-11dd-ae16-2740afc178ae" target="10.1.2.6"/&gt;
          &lt;/ssh&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
<section class="section" id="idm62799670896"><div class="titlepage"><div><div><h2 class="title" style="clear: both">statsd</h2></div></div></div>
  
  <p>The statsd module provides a simple way to push data into reconnoiter from other applications.  See https://github.com/etsy/statsd for more details.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>statsd.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799665600"><div class="titlepage"><div><div><h3 class="title">Module Configuration</h3></div></div></div>
    
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">port</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>8125</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^\d+$</p>
              </dd></dl></div>
          <p>The port on which to listen for statsd packets.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">packets_per_cycle</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">default</span></dt><dd>
                <p>100</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^\d+$</p>
              </dd></dl></div>
          <p>The number of packets to recv() during each eventer cycle.</p>
        </dd></dl></div>
    <div class="variablelist"><dl class="variablelist"><dt><span class="term">check</span></dt><dd>
          <div class="variablelist"><dl class="variablelist"><dt><span class="term">required</span></dt><dd>
                <p>optional</p>
              </dd><dt><span class="term">allowed</span></dt><dd>
                <p>^[0-9a-fA-F]{4}(?:[0-9a-fA-F]{4}-){4}[0-9a-fA-F]{12}$</p>
              </dd></dl></div>
          <p>A specific check to which all statsd data will be delegated.</p>
        </dd></dl></div>
  </section>
  <section class="section" id="idm62799643392"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799642752"><div class="example-title">Example 6.40. A sample statsd configuration.</div><div class="example-contents">
      
      <pre class="programlisting">
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="statsd" name="statsd"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="1b4e28ba-2fa1-11d2-893f-e9b761bde3fb" module="statsd"
            target="127.0.0.1" period="60000" timeout="30000"&gt;
            &lt;config&gt;&lt;port&gt;8125&lt;/port&gt;&lt;/config&gt;
          &lt;/check&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </pre>
    </div></div><br class="example-break"/>
  </section>
</section>

</section>
    <section class="chapter" id="config.stratcond"><div class="titlepage"><div><div><h2 class="title">Chapter 7. stratcond</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#config.stratcond.implicitinheritance">Implicit Inheritance</a></span></li><li><span class="section"><a href="#config.stratcond.explicitinheritance">Explicit Inheritance</a></span></li><li><span class="section"><a href="#config.stracond.section.eventer">The &lt;eventer&gt; section</a></span></li><li><span class="section"><a href="#config.stratcond.section.logs">The &lt;logs&gt; section</a></span><ul><li><span class="section"><a href="#config.stratcond.section.logs.special">Special log names</a></span></li></ul></li></ul></div>
  
  <div class="example" id="idm62799640112"><div class="example-title">Example 7.1. Basic noitd configuration struture</div><div class="example-contents">
  
  <pre class="programlisting">
  &lt;noit&gt;
    &lt;eventer/&gt;
    &lt;modules&gt;
      &lt;...&gt;
        &lt;module /&gt;
      &lt;/...&gt;
    &lt;/modules&gt;
    &lt;logs&gt;
      &lt;...&gt;
        &lt;log&gt;
          &lt;outlet /&gt;
          &lt;outlet /&gt;
        &lt;/log&gt;
      &lt;/...&gt;
    &lt;/logs&gt;
    &lt;listeners&gt;
      &lt;...&gt;
        &lt;listener/&gt;
        &lt;listener&gt;
          &lt;config /&gt;
          &lt;sslconfig /&gt;
        &lt;listener&gt;
      &lt;/...&gt;
    &lt;/listeners&gt;
    &lt;checks&gt;
      &lt;...&gt;
        &lt;check uuid="xxx" /&gt;
      &lt;/...&gt;
    &lt;/checks&gt;
  &lt;/noit&gt;
</pre>
</div></div><br class="example-break"/>

<section class="section" id="config.stratcond.implicitinheritance"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Implicit Inheritance</h2></div></div></div>

<p>
Unless otherwise specified, elements and attributes are inherited from
all ancestors.  As is typical with inheritance, the youngest/deepest
value overrides values of ancestors.  If the value requested is a set
of key/value pairs, the top-most ancestor is queried, then its
child is queried, merging values, replacing conflicts and so on until
the youngest/deepest node is reached.
</p>

<div class="example" id="idm62799636432"><div class="example-title">Example 7.2. Simple implicit inheritance configuration example</div><div class="example-contents">

<pre class="programlisting">
      &lt;a foo="bar"&gt;
        &lt;config&gt;
          &lt;key1&gt;val a 1&lt;/key1&gt;
          &lt;key2&gt;val a 2&lt;/key2&gt;
        &lt;/config&gt;
        &lt;b quux="baz"&gt;
          &lt;config&gt;
            &lt;key1&gt;val b 1&lt;/key1&gt;
            &lt;key3&gt;val b 3&lt;/key3&gt;
          &lt;/config&gt;
          &lt;c foo="meme" /&gt;
        &lt;/b&gt;
      &lt;/a&gt;
</pre>
</div></div><br class="example-break"/>

<p>
When looking at the "foo" attribute we see the following values at nodes:
</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">a</span></dt><dd><p>bar</p></dd><dt><span class="term">b</span></dt><dd><p>bar</p></dd><dt><span class="term">c</span></dt><dd><p>meme</p></dd></dl></div>

<p>
When looking at the "quux" attribute we see the following values at nodes:
</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">a</span></dt><dd><p>(none)</p></dd><dt><span class="term">b</span></dt><dd><p>baz</p></dd><dt><span class="term">c</span></dt><dd><p>baz</p></dd></dl></div>

<p>
When looking at the key/value set "config" we see the following values at nodes:
</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">a</span></dt><dd><p>{ key1: "val a 1", key2: "val a 2" }</p></dd><dt><span class="term">b</span></dt><dd><p>{ key1: "val b 1", key2: "val a 2", key3: "val b 3" }</p></dd><dt><span class="term">c</span></dt><dd><p>{ key1: "val b 1", key2: "val a 2", key3: "val b 3" } (same as b)</p></dd></dl></div>

<p>
This inheritance model allows for "non-repetitive" configuration
approaches: "express yourself once and reuse."
</p>
</section>

<section class="section" id="config.stratcond.explicitinheritance"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Explicit Inheritance</h2></div></div></div>


<p>
Sometimes it is useful to define a configuration key/value set
for reuse, but the strict parent-child inheritance model is awkward.
Under these circumstances, the explicit inheritance often solves the
issue at hand.  With explicit inheritance, a configuration can inherit
from another named node elsewhere in the configuration.
</p>
<p>
The &lt;config /&gt; stanzas can be identified, as is typical in XML, with
the "id" attribute: &lt;config id="sample" /&gt;.  Additionally, any config
may explicitly specify that it inherits from a named config by
specifying the "inherit" attribute.
</p>
<p>
Any &lt;config /&gt;, A, which has the "inherit" attribute will first
inherit from its most direct parent, then supplement/replace those
key/values with the configuration whose "id" attribute matches the
"inherit" attribute of A, and finally supplement/replace those
key/values with key/values directly beneath A.  The entire tree is
searched for a node whose "id" matches A's "inherit" attribute.
</p>

<div class="example" id="idm62799619504"><div class="example-title">Example 7.3. Simple explicity inheritance configuration example</div><div class="example-contents">

<pre class="programlisting">
  &lt;config name="A"&gt;
    &lt;key1&gt;a&lt;/key1&gt;
    &lt;key2&gt;b&lt;/key2&gt;
    &lt;key3&gt;c&lt;/key3&gt;
    &lt;config name="C" inherit="bob"&gt;
      &lt;key1&gt;AAA&lt;/key1&gt;
      &lt;key4&gt;DDD&lt;/key4&gt;
    &lt;/config&gt;
  &lt;/config&gt;
  &lt;x&gt;
    &lt;y&gt;
      &lt;z&gt;
        &lt;config name="B" id="bob"&gt;
          &lt;key2&gt;bobB&lt;/key2&gt;
          &lt;key5&gt;bobE&lt;/key5&gt;
        &lt;/config&gt;
      &lt;/z&gt;
    &lt;/y&gt;
  &lt;/x&gt;
</pre>
</div></div><br class="example-break"/>

<p>The config named "A" contains:</p>
<div class="variablelist"><dl class="variablelist compact"><dt><span class="term">key1</span></dt><dd><p>a</p></dd><dt><span class="term">key2</span></dt><dd><p>b</p></dd><dt><span class="term">key3</span></dt><dd><p>c</p></dd></dl></div>

<p>The config named "C" contains:</p>
<div class="variablelist"><dl class="variablelist"><dt><span class="term">key1</span></dt><dd><p>AAA</p></dd><dt><span class="term">key2</span></dt><dd><p>bobB</p></dd><dt><span class="term">key3</span></dt><dd><p>c</p></dd><dt><span class="term">key4</span></dt><dd><p>DDD</p></dd><dt><span class="term">key5</span></dt><dd><p>bobE</p></dd></dl></div>

<p>
It should be noted hat all config's include the one named "B" above
follows this same inheritance model.
</p>
</section>

<section class="section" id="config.stracond.section.eventer"><div class="titlepage"><div><div><h2 class="title" style="clear: both">The &lt;eventer&gt; section</h2></div></div></div>
  

<p>
This section provides configuration directives to the eventing
subsystem.  Think of the eventer as the engine that drives all I/O,
jobs, and timed events.  To choose the eventer, the "implementation"
attribute is used in the eventer node.  For example, to select the
kqueue eventer (for Mac OS X or modern BSDs):
</p>

<pre class="programlisting">
  &lt;eventer implementation="kqueue" /&gt;
</pre>

<p>
The following eventer implementations exist: kqueue (Mac/BSD), epoll (Linux), ports (Solaris 10+).
</p>
</section>

<section class="section" id="config.stratcond.section.logs"><div class="titlepage"><div><div><h2 class="title" style="clear: both">The &lt;logs&gt; section</h2></div></div></div>
  

<p>
The logs section contains &lt;log&gt; elements at arbitrary depths.  A log
requires several attributes to be useful:
</p>

<div class="variablelist"><dl class="variablelist"><dt><span class="term">name</span></dt><dd><p>
   "name" this must me unique.  Several names have meaning within the
   product.  If you match that name, you control how that information
   is logged.
  </p></dd><dt><span class="term">type</span></dt><dd><p>
   "type" this specified ths underlying log writing implementation.
   Valid options are "file" (the default if unspecified), "jlog" which
   is the a binary 'auto-rotating', consumable, multi-subscriber log
   format.
  </p></dd><dt><span class="term">path</span></dt><dd><p>
   "path" the path to the log (interpreted by the "type"
   implementation).
  </p></dd><dt><span class="term">debug</span></dt><dd><p>
   "debug" (boolean: &lt;true|false&gt;, default false) that dictates
   whether or not the file:line number of the callee will be included
   in the log output.  This only applies loggers that have write
   operations (like files and jlogs).
  </p></dd><dt><span class="term">disabled</span></dt><dd><p>
   "disabled" (boolean: &lt;true|false&gt;, default false) that dictates
   whether the log implmenation will actually write anything.  If set
   to true, the log will be silences and will not propagate input to
   any attached outlets.
  </p></dd><dt><span class="term">timestamps</span></dt><dd><p>
   "debug" (boolean: &lt;true|false&gt;, default false) that dictates
   whether or not a microsecond granular time will be included
   in the log output.  This only applies loggers that have write
   operations (like files and jlogs).
  </p></dd><dt><span class="term">rotate_seconds</span></dt><dd><p>
   "rotate_seconds" (integer: default unset, minimum 600) that specifies
   how many seconds of data the given log file should contain.  Every
   "rotate_seconds" seconds (aligned with UNIX epoch), the log will be
   rotated to a file of the same name with the current UNIX timestamp
   dot-appended.  This can be used in combination with "rotate_bytes"
   for rather interesting results.
  </p></dd><dt><span class="term">rotate_bytes</span></dt><dd><p>
   "rotate_bytes" (integer: default unset, minimum 102400) that specifies
   the maximum number of bytes the file may contain before rotation is
   applied.  This is not enforced after each write, but instead
   the file size is monitored "frequently" and rotation applied.  This
   can mean that the file can grow slightly larger than the specified
   amount.  This can be used in combination with "rotate_seconds" for
   rather interesting results.
  </p></dd></dl></div>
<p>
Within a &lt;log&gt; element, zero, one or many &lt;outlet&gt; elements may be
present.  The outlet element must contain a "name" attribute (this
attribute is not inherited) that matches a *previously* declared &lt;log&gt;
by its "name" attribute.  Foreach &lt;outlet&gt; tag, a sink is created so
that any input sent to the containing &lt;log&gt; will additionally be
propagated to the &lt;outlet&gt;.
</p>
<p>
There is an implicit log named "stderr" that is attached to file
descriptor 2 that has timestamps enabled.
</p>

<section class="section" id="config.stratcond.section.logs.special"><div class="titlepage"><div><div><h3 class="title">Special log names</h3></div></div></div>
  

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">stderr</span></dt><dd><p>
   opened to file descriptor two during log initialization.
  </p></dd><dt><span class="term">error</span></dt><dd><p>
   destination for error messages.
  </p></dd><dt><span class="term">debug</span></dt><dd><p>
    destination for debugging output.
  </p></dd><dt><span class="term">check</span></dt><dd><p>
   When a check is altered in any way (including creation),
   the identifying attributes, including the uuid, are logged to this
   facility.

   </p><pre class="programlisting">
   'C' TIMESTAMP UUID TARGET MODULE NAME
   </pre><p>
  </p></dd><dt><span class="term">status</span></dt><dd><p>
   When a check status changes (either availability or
   state) and neither the new state nor the old state are "unknown", it
   is considered a state change for the check.  The new availability
   and new state are logged to this facility.

   </p><pre class="programlisting">
   'S' TIMESTAMP UUID STATE AVAILABILITY DURATION STATUS_MESSAGE
   </pre><p>
  </p></dd><dt><span class="term">metrics</span></dt><dd><p>
   Each time a check is completed, the various metrics
   that were observed by the check are logged to this facility.  The
   VALUE is always a string or [[null]] (never binary encoded/packed).
   The TYPE indicates the datatype the check intended when it was
   observed.

   </p><pre class="programlisting">
   'M' TIMESTAMP UUID NAME TYPE VALUE
   </pre><p>

   </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">NAME</span></dt><dd><p>is the name of the metric
      and the encouraged format for this is "name`subname`subsubname`etc"</p></dd><dt><span class="term">TYPE</span></dt><dd>
       <div class="variablelist"><dl class="variablelist"><dt><span class="term">i</span></dt><dd><p>INT32</p></dd><dt><span class="term">I</span></dt><dd><p>UINT32</p></dd><dt><span class="term">l</span></dt><dd><p>INT64</p></dd><dt><span class="term">L</span></dt><dd><p>UINT64</p></dd><dt><span class="term">n</span></dt><dd><p>DOUBLE</p></dd><dt><span class="term">s</span></dt><dd><p>STRING</p></dd></dl></div>
       </dd></dl></div><p>
  </p>
  </dd></dl></div>

<div class="example" id="idm62799573536"><div class="example-title">Example 7.4. Sample configuration for the log section</div><div class="example-contents">

<pre class="programlisting">
  &lt;logs&gt;
    &lt;console&gt;
      &lt;outlet name="stderr" /&gt;
      &lt;log name="error" /&gt;
      &lt;log name="debug" disabled="true" /&gt;
    &lt;/console&gt;
    &lt;log name="feed" type="jlog" path="/var/log/noitd.feed" /&gt;
    &lt;feeds&gt;
      &lt;outlet name="feed" /&gt;
      &lt;log name="check" /&gt;
      &lt;log name="metrics" /&gt;
      &lt;log name="status"&gt;
        &lt;outlet name="error" /&gt;
      &lt;/log&gt;
    &lt;/feeds&gt;
  &lt;/logs&gt;
</pre>
</div></div><br class="example-break"/>

 <p>In the above example:</p>
 <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
   a &lt;console&gt; metagroup is created for the purpose of inheriting the
   "stderr" outlet.  The logs named "error" and "debug" are
   instantiated and inherit the "stderr" outlet.  However, "debug" is
   disabled, so no input to the "debug" log will be written anywhere.
   </p></li><li class="listitem"><p>
   a log named "feed" is created of type "jlog" writing to the
   "/var/log/noitd.feed" directory (jlogs paths are directories, whereas 
   "file" paths are filenames).
   </p></li><li class="listitem"><p>
   a &lt;feeds&gt; metagroup is created for the purpose of inheriting the
   "feed" outlet.  The logs "check," "metrics," and "status" are
   instantiated and will log via the "feed" outlet (all writing to the
   same jlog).  Additionally, the "status" feed is given an additional
   outlet named "error" so we will see inputs to status in both the
   "feed" jlog and on the console ("stderr").
   </p></li></ul></div>
</section>
</section>
</section>
    <section class="chapter" id="config.stratcond.modules"><div class="titlepage"><div><div><h2 class="title">Chapter 8. stratcond modules</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#idm62801196784">fq_driver</a></span><ul><li><span class="section"><a href="#idm62799563504">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799560448">rabbitmq_driver</a></span><ul><li><span class="section"><a href="#idm62799555024">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799551968">stomp_driver</a></span><ul><li><span class="section"><a href="#idm62799546688">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799543392">postgres_ingestor</a></span><ul><li><span class="section"><a href="#idm62799538128">Examples</a></span></li></ul></li><li><span class="section"><a href="#idm62799535632">handoff_ingestor</a></span><ul><li><span class="section"><a href="#idm62799529392">Examples</a></span></li></ul></li></ul></div>
  
  <section class="section" id="idm62801196784"><div class="titlepage"><div><div><h2 class="title" style="clear: both">fq_driver</h2></div></div></div>
  
  <p>The fq_driver module allows publishing of metrics and status messages over the FQ protocol for use powering the IEP system.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>fq_driver.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799563504"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799562864"><div class="example-title">Example 8.1. Loading the fq_driver.</div><div class="example-contents">
      
      <p>This example loads the fq_driver and configures it.</p>
      <pre class="programlisting">
      &lt;stratcon&gt;
        &lt;modules&gt;
          &lt;module image="fq_driver" name="fq_driver" /&gt;
        &lt;/modules&gt;
        &lt;iep&gt;
          &lt;mq type="fq"&gt;
            &lt;port&gt;8765&lt;/port&gt;
            &lt;hostname&gt;mq1,mq2:9999&lt;/hostname&gt;
            &lt;exchange&gt;noit.firehose&lt;/exchange&gt;
            &lt;routingkey&gt;check&lt;/routingkey&gt;
            &lt;username&gt;stratcon&lt;/username&gt;
            &lt;password&gt;youllneverguess&lt;/password&gt;
            &lt;backlog&gt;10000&lt;/backlog&gt;
            &lt;heartbeat&gt;1000&lt;/hearbeat&gt;
          &lt;/mq&gt;
        &lt;/iep&gt;
      &lt;/stratcon&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
  <section class="section" id="idm62799560448"><div class="titlepage"><div><div><h2 class="title" style="clear: both">rabbitmq_driver</h2></div></div></div>
  
  <p>The rabbitmq_driver module allows publishing of metrics and status messages over the AMQP protocol for use powering the IEP system.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>rabbitmq_driver.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799555024"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799554384"><div class="example-title">Example 8.2. Loading the rabbitmq_driver.</div><div class="example-contents">
      
      <p>This example loads the rabbitmq_driver and configures it.</p>
      <pre class="programlisting">
      &lt;stratcon&gt;
        &lt;modules&gt;
          &lt;module image="rabbitmq_driver" name="rabbitmq_driver" /&gt;
        &lt;/modules&gt;
        &lt;iep&gt;
          &lt;mq type="rabbitmq"&gt;
            &lt;hostname&gt;mq1,mq2&lt;/hostname&gt;
            &lt;exchange&gt;noit.firehose&lt;/exchange&gt;
            &lt;exchangetype&gt;topic&lt;/exchangetype&gt;
            &lt;routingkey&gt;check&lt;/routingkey&gt;
            &lt;username&gt;stratcon&lt;/username&gt;
            &lt;password&gt;youllneverguess&lt;/password&gt;
          &lt;/mq&gt;
        &lt;/iep&gt;
      &lt;/stratcon&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
  <section class="section" id="idm62799551968"><div class="titlepage"><div><div><h2 class="title" style="clear: both">stomp_driver</h2></div></div></div>
  
  <p>The stomp_driver module allows publishing of metrics and status messages over the STOMP protocol for use powering the IEP system.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>stomp_driver.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799546688"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799546048"><div class="example-title">Example 8.3. Loading the stomp_driver.</div><div class="example-contents">
      
      <p>This example loads the stomp_driver and configures it.</p>
      <pre class="programlisting">
      &lt;stratcon&gt;
        &lt;modules&gt;
          &lt;module image="stomp_driver" name="stomp_driver" /&gt;
        &lt;/modules&gt;
        &lt;iep&gt;
          &lt;mq type="stomp"&gt;
            &lt;!--  exchange, username and password are all optional
            &lt;exchange&gt;&lt;/exchange&gt;
            &lt;username&gt;&lt;/username&gt;
            &lt;password&gt;&lt;/password&gt;
            --&gt;
            &lt;!-- the following will default to the values shown --&gt;
            &lt;destination&gt;/queue/noit.firehose&lt;/destination&gt;
            &lt;hostname&gt;127.0.0.1&lt;/hostname&gt;
            &lt;port&gt;61613&lt;/port&gt;
          &lt;/mq&gt;
        &lt;/iep&gt;
      &lt;/stratcon&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
  <section class="section" id="idm62799543392"><div class="titlepage"><div><div><h2 class="title" style="clear: both">postgres_ingestor</h2></div></div></div>
  
  <p>This module imports noitd data into postgres.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>postgres_ingestor.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799538128"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799537488"><div class="example-title">Example 8.4. Using the postgres_ingestor.</div><div class="example-contents">
      
      <p>This example loads the postgres_ingestor and configures it.</p>
      <pre class="programlisting">
      &lt;stratcon&gt;
        &lt;modules&gt;
          &lt;module image="postgres_ingestor" name="postgres_ingestor" /&gt;
        &lt;/modules&gt;
        &lt;database&gt;
          &lt;journal&gt;
            &lt;path&gt;/var/log/stratcon.persist&lt;/path&gt;
          &lt;/journal&gt;
          &lt;dbconfig&gt;
            &lt;host&gt;db1&lt;/host&gt;
            &lt;dbname&gt;reconnoiter&lt;/dbname&gt;
            &lt;user&gt;stratcon&lt;/user&gt;
            &lt;password&gt;unguessable&lt;/password&gt;
          &lt;/dbconfig&gt;
          &lt;statements&gt;
            &lt;!-- These are optional and used for stuff like setting search paths --&gt;
            &lt;!--
            &lt;metanodepostconnect&gt;
              SELECT do_some_magic();
            &lt;/metanodepostconnect&gt;
            &lt;storagepostconnect&gt;
              SELECT do_some_magic($1,$2);
            &lt;/storagepostconnect&gt;
            --&gt;
            &lt;allchecks&gt;
              SELECT remote_address, id, target, module, name
                FROM check_currently
            &lt;/allchecks&gt;
            &lt;findcheck&gt;
              SELECT remote_address, id, target, module, name
                FROM check_currently
               WHERE sid = $1
            &lt;/findcheck&gt;
            &lt;allstoragenodes&gt;
              SELECT storage_node_id, fqdn, dsn
                FROM stratcon.storage_node
            &lt;/allstoragenodes&gt;
            &lt;findstoragenode&gt;
              SELECT fqdn, dsn
                FROM stratcon.storage_node
               WHERE storage_node_id = $1
            &lt;/findstoragenode&gt;
            &lt;mapallchecks&gt;
              SELECT id, sid, noit as remote_cn, storage_node_id, fqdn, dsn
                FROM stratcon.map_uuid_to_sid LEFT JOIN stratcon.storage_node USING (storage_node_id)
            &lt;/mapallchecks&gt;
            &lt;mapchecktostoragenode&gt;
              SELECT o_storage_node_id as storage_node_id, o_sid as sid,
                     o_fqdn as fqdn, o_dsn as dsn, o_noit as remote_cn
                FROM stratcon.map_uuid_to_sid($1,$2)
            &lt;/mapchecktostoragenode&gt;
            &lt;check&gt;
              INSERT INTO check_archive_%Y%m%d
                          (remote_address, whence, sid, id, target, module, name)
                   VALUES ($1, 'epoch'::timestamptz + ($2 || ' seconds')::interval,
                           $3, $4, $5, $6, $7)
            &lt;/check&gt;
            &lt;status&gt;
              INSERT INTO check_status_archive_%Y%m%d
                          (whence, sid, state, availability, duration, status)
                   VALUES ('epoch'::timestamptz + ($1 || ' seconds')::interval,
                           $2, $3, $4, $5, $6)
            &lt;/status&gt;
            &lt;metric_numeric&gt;
              INSERT INTO metric_numeric_archive_%Y%m%d
                          (whence, sid, name, value)
                   VALUES ('epoch'::timestamptz + ($1 || ' seconds')::interval,
                           $2, $3, $4)
            &lt;/metric_numeric&gt;
            &lt;metric_text&gt;
              INSERT INTO metric_text_archive_%Y%m%d
                          ( whence, sid, name,value)
                   VALUES ('epoch'::timestamptz + ($1 || ' seconds')::interval,
                           $2, $3, $4)
            &lt;/metric_text&gt;
            &lt;config&gt;
              SELECT stratcon.update_config
                     ($1, $2, $3,
                      'epoch'::timestamptz + ($4 || ' seconds')::interval,
                      $5)
            &lt;/config&gt;
            &lt;findconfig&gt;
              SELECT config FROM stratcon.current_node_config WHERE remote_cn = $1
            &lt;/findconfig&gt;
          &lt;/statements&gt;
        &lt;/database&gt;
      &lt;/stratcon&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
  <section class="section" id="idm62799535632"><div class="titlepage"><div><div><h2 class="title" style="clear: both">handoff_ingestor</h2></div></div></div>
  
  <p>This module exposes the consolidated noitd journal files from stratcon to an external process. There is no configuration and one must write an external journal ingestor to have this module be of any use.</p>
  <p>The files stored in the database journal path are not deleted by stratcond and as they are added, their names are streamed using chunked HTTP to the external program currently requesting /handoff/jounrals from the wire protocol API via HTTP GET.  It is the external program's responsibility to delete the files once it has consumed them.</p>
  <div class="variablelist"><dl class="variablelist"><dt><span class="term">loader</span></dt><dd>
        <p>C</p>
      </dd><dt><span class="term">image</span></dt><dd>
        <p>handoff_ingestor.so</p>
      </dd></dl></div>
  <section class="section" id="idm62799529392"><div class="titlepage"><div><div><h3 class="title">Examples</h3></div></div></div>
    
    <div class="example" id="idm62799528752"><div class="example-title">Example 8.5. Loading the handoff_ingestor.</div><div class="example-contents">
      
      <p>This example loads the handoff_ingestor.</p>
      <pre class="programlisting">
      &lt;stratcon&gt;
        &lt;modules&gt;
          &lt;module image="handoff_ingestor" name="handoff_ingestor" /&gt;
        &lt;/modules&gt;
        &lt;database&gt;
          &lt;journal&gt;
            &lt;path&gt;/var/log/stratcon.persist&lt;/path&gt;
          &lt;/journal&gt;
        &lt;/database&gt;
      &lt;/stratcon&gt;
    </pre>
    </div></div><br class="example-break"/>
  </section>
</section>
</section>
</div>
  <div class="part" id="operation"><div class="titlepage"><div><div><h1 class="title">Part III. Operation</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="chapter"><a href="#operation.noitd">9. Operating the noitd daemon</a></span><ul><li><span class="section"><a href="#noitd.interactive.console">Interactive Console Command Line Operation</a></span><ul><li><span class="section"><a href="#idm62799519328">General Operational Principles</a></span></li><li><span class="section"><a href="#idm62799517024">Accessing the Interactive Console</a></span></li><li><span class="section"><a href="#idm62799514256">Basic Command List</a></span></li><li><span class="section"><a href="#idm62799481408">Showing System Information</a></span></li><li><span class="section"><a href="#idm62799461920">Configuring the System</a></span></li></ul></li><li><span class="section"><a href="#noitd.wire.protocol"><span class="command"><strong>noitd/stratcond</strong></span> Wire Protocol</a></span><ul><li><span class="section"><a href="#operation.wire.rest">REST operation over HTTP</a></span></li></ul></li></ul></li></ul></div>
    
    <section class="chapter" id="operation.noitd"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Operating the noitd daemon</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#noitd.interactive.console">Interactive Console Command Line Operation</a></span><ul><li><span class="section"><a href="#idm62799519328">General Operational Principles</a></span></li><li><span class="section"><a href="#idm62799517024">Accessing the Interactive Console</a></span></li><li><span class="section"><a href="#idm62799514256">Basic Command List</a></span></li><li><span class="section"><a href="#idm62799481408">Showing System Information</a></span></li><li><span class="section"><a href="#idm62799461920">Configuring the System</a></span></li></ul></li><li><span class="section"><a href="#noitd.wire.protocol"><span class="command"><strong>noitd/stratcond</strong></span> Wire Protocol</a></span><ul><li><span class="section"><a href="#operation.wire.rest">REST operation over HTTP</a></span></li></ul></li></ul></div>
  

<p>
Once <span class="command"><strong>noitd</strong></span> is configured and running, there
are several methods of interacting with the service.  The operator
can interactively manage the instance via the integrated command line
console (accessible via telnet on the port of your choice, as configured
in noitd.conf via listener elements; by default port 32322) and
programmatic access is available over the <span class="command"><strong>noitd</strong></span>
wire protocol on port 43191.
</p>

<p>
The wire protocol is a binary protocol that is leverage for
inter-system communication.  While not entirely compliant with
the HTTP specification, the protocol will give well formed HTTP
responses to sessions that commence with the terms: "DELETE"
"GET " "HEAD" "POST" "PUT ".
</p>

<section class="section" id="noitd.interactive.console"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Interactive Console Command Line Operation</h2></div></div></div>
  
  <p>
      This section serves to document the basic methods of operation
      available through the interactive console's command line interface.  
      It is currently in rough draft status.
  </p>

  <section class="section" id="idm62799519328"><div class="titlepage"><div><div><h3 class="title">General Operational Principles</h3></div></div></div>
    
    <p>
      The command line interface to the system available through the 
      interactive console operates in a fashion similar to Cisco's <span class="trademark">IOS</span>™, 
      in that there are various "levels" or "sets"/"sub-sets" of commands 
      within the interface.  Operations and operands may be tab-completed 
      or abbreviated to their un-ambiguous form as needed or desired 
      (analogous to "configure terminal" becoming "conf t" in common IOS 
      usage).  Command history and editing is available.
    </p>
  </section>

  <section class="section" id="idm62799517024"><div class="titlepage"><div><div><h3 class="title">Accessing the Interactive Console</h3></div></div></div>
    
    <p>
      The interactive console is accessed by telneting to the configured
      access port on the host running <span class="command"><strong>noitd</strong></span>.  By default this is
      port 32322.  The applicable configuration parameter in the <code class="filename">noitd.conf</code>
      XML file is the port attribute of the "listener" element, e.g.:
      </p><pre class="programlisting">
      &lt;listener address="*" port="32322"&gt;
        </pre><p> Please see the configuration section of
      the manual for more information.
    </p>
  </section>

  <section class="section" id="idm62799514256"><div class="titlepage"><div><div><h3 class="title">Basic Command List</h3></div></div></div>
    
    <p>An example session of interaction showing the use of help and a few 
      operating modes is illustrative:
      </p><pre class="screen">
      noit# help
      = Topics =
      ==&gt; 'module'

      = Commands =
      ==&gt; 'apply'
      ==&gt; 'configure'
      ==&gt; 'exit'
      ==&gt; 'no'
      ==&gt; 'reload'
      ==&gt; 'restart'
      ==&gt; 'show'
      ==&gt; 'shutdown'
      ==&gt; 'watch'
      ==&gt; 'write'
      noit# help module
      Help for 'module':
      = Loaders and Modules =
      lua
      ping_icmp
      smtp
      ssh2
      varnish
      selfcheck
      resmon
      http
      snmp
      noit# configure {tab pressed twice}
      apply     help      terminal
      noit# conf t
      noit(conf:/)# ls
      == Section Settings ==
      @lockfile: /var/run/noitd.lock
      == Subsections ==
      eventer
      logs
      modules
      listeners
      rest
      checks
      filtersets
      config_templates
      noit(conf:/)# help
      -&gt; 'terminal'
      = Topics =
      ==&gt; 'module'

      = Commands =
      ==&gt; 'apply'
      ==&gt; 'attribute'
      ==&gt; 'cd'
      ==&gt; 'check'
      ==&gt; 'config'
      ==&gt; 'exit'
      ==&gt; 'filterset'
      ==&gt; 'ls'
      ==&gt; 'no'
      ==&gt; 'section'
      ==&gt; 'write'
      noit(conf:/)# exit
      noit# show
      ==&gt; 'apply'
      ==&gt; 'check'
      ==&gt; 'checks'
      ==&gt; 'eventer'
      ==&gt; 'watches'
      incomplete command.

      </pre><p>

      </p><div class="variablelist"><div class="variablelist-title">Command Descriptions</div><dl class="variablelist"><dt><span class="term">help</span></dt><dd>
            <p><span class="command"><strong>help</strong></span> provides brief help information appropriate to a given context.</p>
          </dd><dt><span class="term">show</span></dt><dd>
            <p><span class="command"><strong>show</strong></span> shows various aspects of the system.  See the "Showing System Information" section below for further detail.</p>
          </dd><dt><span class="term">watch</span></dt><dd>
            <p><span class="command"><strong>watch</strong></span> is much like show except it re-displays the given information periodically.  See the "Showing System Information" section below for further detail.</p>
          </dd><dt><span class="term">exit</span></dt><dd>
            <p><span class="command"><strong>exit</strong></span> leaves the current "level" of session (e.g. returns to regular interactive session if used within a configuration sub-"level" or exits the current interactive session entirely and closes the connection if used within the regular interaction "level").</p>
          </dd><dt><span class="term">configure</span></dt><dd>
            <p><span class="command"><strong>configure</strong></span> causes the session to enter configuration mode if used with the <span class="command"><strong>terminal</strong></span> argument or with the <span class="command"><strong>apply</strong></span> argument allows for multiple configurations to be specified at once in an automated fashion (see below for coverage of <span class="command"><strong>apply</strong></span> and the "Configuring the System" section for more information about run-time configuration in general).</p>
          </dd><dt><span class="term">write</span></dt><dd>
            <p><span class="command"><strong>write</strong></span> writes the current operating configuration to: the permanent configuration store (<code class="filename">noitd.conf</code> by default, in the location specified either at startup with -c or in the default compile-time system directory) with <span class="command"><strong>file</strong></span> argument (<span class="command"><strong>memory</strong></span> is an alias), or to the current interactive display with the <span class="command"><strong>terminal</strong></span> argument.</p>
          </dd><dt><span class="term">reload</span></dt><dd>
            <p><span class="command"><strong>reload</strong></span> causes <span class="command"><strong>noitd</strong></span> to reload configuration information from the permanent configuration store (<code class="filename">noitd.conf</code> by default, in the location specified either at startup with -c or in the default compile-time system directory).</p>
          </dd><dt><span class="term">restart</span></dt><dd>
              <p><span class="command"><strong>restart</strong></span> causes <span class="command"><strong>noitd</strong></span> to restart, re-reading all configuration from the permanent configuration store in the process. As part of restarting, the current interactive session is terminated.</p>
            </dd><dt><span class="term">shutdown</span></dt><dd>
              <p><span class="command"><strong>shutdown</strong></span> causes <span class="command"><strong>noitd</strong></span> to shut down entirely.</p>
            </dd><dt><span class="term">apply</span></dt><dd>
              <p><span class="command"><strong>apply {variable name} {range specifier} {command}</strong></span> works much like a <span class="command"><strong>for {name} in {list}; do {command, optionally using $name}; done</strong></span> loop in the <span class="command"><strong>bash</strong></span> shell, in that it iterates over the given range, setting the variable name to each value in turn and executing the given command with $variablename set and available at each execution. A simple example is given below of executing an ssh2 check three times using apply:</p>
              <pre class="screen">
                noit# apply i 1..3 show check 002d58ff-20ff-4db0-9420-782fc1748dc4
                ==== 002d58ff-20ff-4db0-9420-782fc1748dc4 ====
                name: ssh2 [from module]
                module: ssh2
                target: 127.0.0.1
                period: 60000
                timeout: 4000
                oncheck: [undef]
                filterset: default [inherited from @filterset]
                disable: [undef]
                currently: idle
                last run: 31.104 seconds ago
                availability/state: available/good
                status: 59698f91c167393deb952564fe316dca
                metrics:
                duration[I] = 192
                fingerprint[s] = 59698f91c167393deb952564fe316dca
                ==== 002d58ff-20ff-4db0-9420-782fc1748dc4 ====
                name: ssh2 [from module]
                module: ssh2
                target: 127.0.0.1
                period: 60000
                timeout: 4000
                oncheck: [undef]
                filterset: default [inherited from @filterset]
                disable: [undef]
                currently: idle
                last run: 31.104 seconds ago
                availability/state: available/good
                status: 59698f91c167393deb952564fe316dca
                metrics:
                duration[I] = 192
                fingerprint[s] = 59698f91c167393deb952564fe316dca
                ==== 002d58ff-20ff-4db0-9420-782fc1748dc4 ====
                name: ssh2 [from module]
                module: ssh2
                target: 127.0.0.1
                period: 60000
                timeout: 4000
                oncheck: [undef]
                filterset: default [inherited from @filterset]
                disable: [undef]
                currently: idle
                last run: 31.104 seconds ago
                availability/state: available/good
                status: 59698f91c167393deb952564fe316dca
                metrics:
                duration[I] = 192
                fingerprint[s] = 59698f91c167393deb952564fe316dca
              </pre>
            </dd><dt><span class="term">no</span></dt><dd>
            <p><span class="command"><strong>no</strong></span> works much like "no" in <span class="trademark">IOS</span>™, negating or nullifying another command.  e.g. <span class="command"><strong>no watch {check id} {interval}</strong></span> to disable a given watch (see below for further details).</p>
          </dd></dl></div><p>
    </p>
  </section>

  <section class="section" id="idm62799481408"><div class="titlepage"><div><div><h3 class="title">Showing System Information</h3></div></div></div>
    
    <p>The two main commands for showing system information are <span class="command"><strong>show</strong></span> and <span class="command"><strong>watch</strong></span>.  <span class="command"><strong>show</strong></span> is useful for one-off queries of information, and <span class="command"><strong>watch</strong></span> is useful for periodically redisplaying the same information (e.g. to see snapshots of activity while some other process is affecting the monitored system/information).</p>
    <section class="section" id="idm62799478592"><div class="titlepage"><div><div><h4 class="title">show</h4></div></div></div>
      
      <p><span class="command"><strong>show</strong></span> show accepts a number of arguments:</p>
      <div class="variablelist"><dl class="variablelist"><dt><span class="term">watches</span></dt><dd>
            <p><span class="command"><strong>show watches</strong></span> displays a list of all active watches currently being serviced by <span class="command"><strong>noitd</strong></span>.</p>
          </dd><dt><span class="term">checks</span></dt><dd>
            <p><span class="command"><strong>show checks</strong></span> displays a list of checks that <span class="command"><strong>noitd</strong></span> is currently servicing.  Example output is illuminative:</p>
              <pre class="screen">
                noit# show checks
                1b4e28ba-2fa1-11d2-883f-b9b761bde3fb 127.0.0.1`ping_icmp
                cnt=5,avail=100,min=0.0000,max=0.0000,avg=0.0000
                f7cea020-f19d-11dd-85a6-cb6d3a2207dc 127.0.0.1`selfcheck
                ok
                002d58ff-20ff-4db0-9420-782fc1748dc4 127.0.0.1`ssh2
                59698f91c167393deb952564fe316dca
              </pre>
              <p>Each check's primary identifier is a hexadecimal GUID.  This may be tab-completed in common use from the longest unique string, much like commands. In the example above, for instance, "002" would be sufficient to tab complete a reference to the check 002d58ff-20ff-4db0-9420-782fc1748dc4. Each check is further identified as accessing a given IP/host and contains some description of what the check is doing as configured when the check was configured (see the "Configuring the System" section below, and/or <code class="filename">noitd.conf</code>). The second line for each check provides check-specific further information or status.</p>
          </dd><dt><span class="term">check</span></dt><dd>
            <p><span class="command"><strong>show check {check id}</strong></span>. See discussion above for referencing a particular check by id.  This provides more in-depth information about a specific check.  For example, using the check list mentioned above:</p>
              <pre class="screen">
                noit# show check 1b4e28ba-2fa1-11d2-883f-b9b761bde3fb
                ==== 1b4e28ba-2fa1-11d2-883f-b9b761bde3fb ====
                name: ping_icmp [from module]
                module: ping_icmp
                target: 127.0.0.1
                period: 15000
                timeout: 14000
                oncheck: [undef]
                filterset: default [inherited from @filterset]
                disable: [undef]
                currently: running
                last run: 9.377 seconds ago
                availability/state: available/good
                status: cnt=5,avail=100,min=0.0000,max=0.0001,avg=0.0000
                metrics:
                available[n] = 1.000000000000e+02
                *count[i] = 5
                average[n] = 4.359999984445e-05
                *maximum[n] = 5.400000009104e-05
                *minimum[n] = 2.800000038405e-05
              </pre>
          </dd></dl></div>
    </section>

    <section class="section" id="idm62799465792"><div class="titlepage"><div><div><h4 class="title">watch</h4></div></div></div>
      
      <p><span class="command"><strong>watch {check id} {interval}</strong></span> redisplays information for a given check at a configurable interval. Interval is given in units of milliseconds.  If interval is omitted, presently, there is a bug where the check begins to output at its configured interval directly to the cli, but does not appear as a watch in <span class="command"><strong>show watches</strong></span> and <span class="command"><strong>no watch {id}</strong></span> has no effect.</p>
      <p>The currently active watches may be listed with <span class="command"><strong>show watches</strong></span>, and an active watch may be terminated with by issuing the command <span class="command"><strong>no watch {check id} {interval}</strong></span> where check id and interval are the ones used for the initial creation of the watch.</p>
    </section>
  </section>

  <section class="section" id="idm62799461920"><div class="titlepage"><div><div><h3 class="title">Configuring the System</h3></div></div></div>
    
    <p>The focus of this section is configuring <span class="command"><strong>noitd</strong></span>'s behavior at run-time via the interactive console.  For documentation of <code class="filename">noitd.conf</code> itself, see <a class="link" href="#configuration" title="Part II. Configuration">the main chapter on system configuration</a>.  As a general note, to store run-time configuration to the permanent configuration store, see the <span class="command"><strong>write file</strong></span> command above.</p>
    <section class="section" id="idm62799459712"><div class="titlepage"><div><div><h4 class="title">Configure Terminal ("conf t") Mode</h4></div></div></div>
      
      <p>To enter the interactive configuration mode, first telnet to <span class="command"><strong>noitd</strong></span>'s telnet port and issue the "configure terminal" command, which may be abbreviated as "conf t" if desired. (Please see above information about default port, port configuration location, etc.)</p>
      <p>Configure terminal mode presents a different array of options than regular mode, which are summarized below.  (Some common commands have been ommitted as their function is identical within conf-t mode as within normal interactive mode, e.g. <span class="command"><strong>exit</strong></span>.)</p>
      <div class="variablelist"><dl class="variablelist"><dt><span class="term">cd</span></dt><dd>
              <p><span class="command"><strong>cd {location, e.g. ".." or "checks"}</strong></span> changes the point where the interactive configuration session is within the tree-like organizational structure of the configuration space in a fashion similar to <span class="command"><strong>cd</strong></span> within a filesystem directory tree.  (See note below.)</p>
            </dd><dt><span class="term">section</span></dt><dd>
                <p><span class="command"><strong>section {location}</strong></span> operates similarly to <span class="command"><strong>cd</strong></span>, except that it will create the new location if it does not exist.</p>
            </dd><dt><span class="term">ls</span></dt><dd>
              <p><span class="command"><strong>ls</strong></span> lists the configured entities at a given point within the tree-like organizational structure of the configuration space in a fashion similar to <span class="command"><strong>ls</strong></span> within a filesystem directory tree.  (See note below.) </p>
            </dd><dt><span class="term">status</span></dt><dd>
              <p><span class="command"><strong>status</strong></span> displays the fine-grained details about a particular leaf-node/entity within the configuration space.</p>
            </dd><dt><span class="term">check</span></dt><dd>
            <p><span class="command"><strong>check {check id}</strong></span> enters the configuration space for a particular leaf-node of the general configuration tree, i.e. the exact configuration for a particular check within the system. <span class="command"><strong>check new {params}</strong></span> may be used to set up a new check within the system, where params are dependent on what is required for a check using whichever module.  For example, <span class="command"><strong>check new target 127.0.0.1 module http period 60000 timeout 10000</strong></span> sets up a new http check on localhost running every minute and timing out after ten seconds.  By default the new check will be named "target`module", and after entry of the above command you will be placed into the configuration space for the new check as though you had run <span class="command"><strong>check {the new id}</strong></span> upon it.  Of note is that the new check is disabled by default (see <span class="command"><strong>status</strong></span> output), you must run <span class="command"><strong>no attribute disable</strong></span> to enable it.</p>
          </dd><dt><span class="term">attribute</span></dt><dd>
              <p><span class="command"><strong>attribute</strong></span> enables you to alter the fine-grained details about a particular leaf-node/entity within the configuration space; e.g. "no attr disable" to enable a check, or "attr port 2222" on an ssh2 check to have it check port 2222 instead of the default 22.</p>
            </dd><dt><span class="term">filterset</span></dt><dd>
              <p><span class="command"><strong>filterset</strong></span> is applicable only in the /filterset "directory" and has to do with the maintenance of filters, which are (briefly) exclusion patterns that filter out collected metrics from being reported upstream to <span class="command"><strong>stratcon</strong></span> (the noit daemon will still collect all of the data, but only the un-filtered metrics will propagate).</p>
            </dd></dl></div>
      <p>Configure terminal mode has a general tree-like organizational structure mimicing the xml in <code class="filename">noitd.conf</code>, hence commands like <span class="command"><strong>cd</strong></span> and <span class="command"><strong>ls</strong></span>. Within some leaf nodes of the tree (for instance, check entities' representations) <span class="command"><strong>status</strong></span> should be substituted for <span class="command"><strong>ls</strong></span> as the latter operates on entities rather than attributes of entities (which would be displayed by <span class="command"><strong>status</strong></span>).</p>
      <p>An example configuration session is shown below to illustrate some of the above:</p>
      <pre class="screen">
        noit# conf t
        noit(conf:/)# cd checks
        noit(conf:/checks)# ls
        == Section Settings ==
        @filterset: default
        @transient_min_period: 1000
        @transient_period_granularity: 500
        == Subsections ==
        foo
        == Checks ==
        check[@uuid="f7cea020-f19d-11dd-85a6-cb6d3a2207dc"] 127.0.0.1`selfcheck`selfcheck
        check[@uuid="1b4e28ba-2fa1-11d2-883f-b9b761bde3fb"] 127.0.0.1`ping_icmp`ping_icmp
        check[@uuid="002d58ff-20ff-4db0-9420-782fc1748dc4"] 127.0.0.1`ssh2`ssh2
        check[@uuid="70a3633f-1629-4417-a7db-d48b9558c48e"] 127.0.0.1`http`http
        noit(conf:/checks)# check 70a3633f-1629-4417-a7db-d48b9558c48e 
        noit(conf:127.0.0.1`http)# status
        ==== 70a3633f-1629-4417-a7db-d48b9558c48e ====
        name: http [from module]
        module: http
        target: 127.0.0.1
        period: 60000
        timeout: 10000
        oncheck: [undef]
        filterset: default [inherited from @filterset]
        disable: [undef]
        currently: idle
        last run: 46.432 seconds ago
        availability/state: available/good
        status: code=200,rt=0.001s,bytes=39
        metrics:
        tt_connect[I] = 0
        bytes[i] = 39
        code[s] = 200
        tt_firstbyte[I] = 1
        duration[I] = 1
        noit(conf:127.0.0.1`http)# exit
        noit(conf:/checks)# exit
        noit# 
      </pre>
    </section>
  </section>
</section>

<section class="section" id="noitd.wire.protocol"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><span class="command"><strong>noitd/stratcond</strong></span> Wire Protocol</h2></div></div></div>
  
  <section class="section" id="operation.wire.rest"><div class="titlepage"><div><div><h3 class="title">REST operation over HTTP</h3></div></div></div>


<p>
A variety of operational read and write operations are available over
HTTP.  The HTTP layer is only available over SSL (HTTPS), operates on
the IANA assigned port number 43191.  The SSL implementation of the
wire protocol requires client certificates, so this REST mechansim is
only available to HTTP clients that support both SSL and user-supplied
client certificates.  The client certificates must be signed by a
certificate authority recognized by the <span class="command"><strong>noitd</strong></span>
instance.
</p>

<section class="section" id="idm62799427584"><div class="titlepage"><div><div><h4 class="title">Manipulating Checks</h4></div></div></div>

<section class="section" id="idm62799427040"><div class="titlepage"><div><div><h5 class="title">/checks/delete/</h5></div></div></div>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd><p><code class="code">DELETE</code></p></dd><dt><span class="term">uri</span></dt><dd><p><code class="code">/checks/delete/&lt;path/&gt;&lt;checkid&gt;</code></p></dd></dl></div>
  <p>
  This call returns deletes the specified check.  If the check does not
  exist, then a HTTP 404 code is returned.  If the check exists, but is
  outside of the optional <code class="code">path</code>, then a HTTP 403 code is
  returned.  Otherwise, the specified check is removed from the system
  and a HTTP 200 is returned.  Any response payload returned should be
  ignored by the client.
  </p>
</section>
<section class="section" id="idm62799420480"><div class="titlepage"><div><div><h5 class="title">/checks/set/</h5></div></div></div>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd><p><code class="code">PUT</code></p></dd><dt><span class="term">uri</span></dt><dd><p><code class="code">/checks/set/&lt;path/&gt;&lt;checkid&gt;</code></p></dd></dl></div>
  <p>
  This call accepts a document describing a check.  That check is
  instantiated with the <code class="code">checkid</code> specified in the URL.  If the
  check exists, but is not under the provided optional <code class="code">path</code> a
  HTTP 403 code is returned.  If the check already exists under the specified
  <code class="code">path</code>, the check is updated to reflect the new configuration.
  The <code class="code">module</code> cannot be changed for existing checks.  All other
  fields can be changed.  All fields are required except the
  <code class="code">disable</code> field; if disable is omitted, it will inherit the
  disable attribute from parents in the tree (use the default setting).
  On success, a HTTP 200 is returned and an XML documented that matches the
  format of the <code class="code">/check/show</code> REST command.
  The input is as follows:
  </p>

  <div class="example" id="idm62799412672"><div class="example-title">Example 9.1. REST /checks/set XML input.</div><div class="example-contents">
    
    <pre class="programlisting">
&lt;?xml version="1.0" encoding="utf8"?&gt;
&lt;check&gt;
  &lt;attributes&gt;
    &lt;name&gt;http&lt;/name&gt;
    &lt;module&gt;http&lt;/module&gt;
    &lt;target&gt;8.8.38.5&lt;/target&gt;
    &lt;period&gt;60000&lt;/period&gt;
    &lt;timeout&gt;5000&lt;/timeout&gt;
    &lt;filterset&gt;default&lt;/filterset&gt;
  &lt;/attributes&gt;
  &lt;config&gt;
    &lt;code&gt;200&lt;/code&gt;
    &lt;url&gt;https://labs.omniti.com/&lt;/url&gt;
  &lt;/config&gt;
&lt;/check&gt;
    </pre>
  </div></div><br class="example-break"/>
</section>
<section class="section" id="idm62799410512"><div class="titlepage"><div><div><h5 class="title">/checks/show/</h5></div></div></div>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd><p><code class="code">GET</code></p></dd><dt><span class="term">uri</span></dt><dd><p><code class="code">/checks/show/&lt;path/&gt;&lt;checkid&gt;</code></p></dd></dl></div>
  <p>
  This call returns an XML document describing the current configuration and
  state of the specific check.  The <code class="code">checkid</code> specified is located
  under the optional <code class="code">path</code>.  If the check exists, but it under
  another path, a HTTP 403 code is returned.  If the check does not exist,
  a HTTP 404 code is returned.
  </p>

  <div class="example" id="idm62799404368"><div class="example-title">Example 9.2. REST /checks/show XML output.</div><div class="example-contents">
    
    <p>Output from an HTTP GET of <code class="code">/checks/show/1b4e28ba-2fa1-11d2-883f-b9a761bde3aa</code></p>
    <pre class="programlisting">
&lt;?xml version="1.0" encoding="utf8"?&gt;
&lt;check&gt;
  &lt;attributes&gt;
    &lt;uuid&gt;1b4e28ba-2fa1-11d2-883f-b9a761bde3aa&lt;/uuid&gt;
    &lt;name&gt;http&lt;/name&gt;
    &lt;module inherited="/dc1/web/@module"&gt;http&lt;/module&gt;
    &lt;target&gt;8.8.38.5&lt;/target&gt;
    &lt;period inherited="/dc1/@period"&gt;60000&lt;/period&gt;
    &lt;timeout inherited="/dc1/@timeout"&gt;5000&lt;/timeout&gt;
    &lt;filterset inherited="/@filterset"&gt;default&lt;/filterset&gt;
  &lt;/attributes&gt;
  &lt;config&gt;
    &lt;code&gt;200&lt;/code&gt;
    &lt;url&gt;https://labs.omniti.com/&lt;/url&gt;
  &lt;/config&gt;
  &lt;state&gt;
    &lt;running&gt;false&lt;/running&gt;
    &lt;killed&gt;false&lt;/killed&gt;
    &lt;configured&gt;true&lt;/configured&gt;
    &lt;disabled&gt;false&lt;/disabled&gt;
    &lt;last_run now="1253124365.131"&gt;1253124339.270&lt;/last_run&gt;
    &lt;runtime&gt;4.408&lt;/runtime&gt;
    &lt;availability&gt;available&lt;/availability&gt;
    &lt;state&gt;good&lt;/state&gt;
    &lt;status&gt;code=200,rt=4.409s,bytes=8958&lt;/status&gt;
    &lt;metrics&gt;
      &lt;duration type="I"&gt;4408&lt;/duration&gt;
      &lt;code type="s"&gt;200&lt;/code&gt;
      &lt;bytes type="i"&gt;8958&lt;/bytes&gt;
    &lt;/metrics&gt;
  &lt;/state&gt;
&lt;/check&gt;
    </pre>
  </div></div><br class="example-break"/>
</section>
</section>

<section class="section" id="idm62799402384"><div class="titlepage"><div><div><h4 class="title">Manipulating Filters</h4></div></div></div>

<section class="section" id="idm62799400848"><div class="titlepage"><div><div><h5 class="title">/filters/delete/</h5></div></div></div>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd><p><code class="code">DELETE</code></p></dd><dt><span class="term">uri</span></dt><dd><p><code class="code">/filters/delete/&lt;path/&gt;&lt;filterset&gt;</code></p></dd></dl></div>
  <p>
  This call returns deletes the specified filterset.  If the filterset does
  not exist, then a HTTP 404 code is returned.  If the filterset exists, but
  is outside of the optional <code class="code">path</code>, then a HTTP 403 code is
  returned.  Otherwise, the specified filterset is removed from the system
  and a HTTP 200 is returned.  Any response payload returned should be
  ignored by the client.
  </p>
</section>
<section class="section" id="idm62799394352"><div class="titlepage"><div><div><h5 class="title">/filters/set/</h5></div></div></div>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd><p><code class="code">PUT</code></p></dd><dt><span class="term">uri</span></dt><dd><p><code class="code">/filters/set/&lt;path/&gt;&lt;filterset&gt;</code></p></dd></dl></div>
  <p>
  This call accepts a document describing a filterset.  That filterset is
  instantiated with the name <code class="code">filterset</code> specified in the URL.
  If the filterset exists, but is not under the provided optional
  <code class="code">path</code> a HTTP 403 code is returned.  If the filterset already
  exists under the specified <code class="code">path</code>, the filterset is replaced
  with the configuration submitted.
  On success, a HTTP 200 is returned and an XML documented that matches the
  format of the <code class="code">/check/show</code> REST command.
  The input is as follows:
  </p>

  <div class="example" id="idm62799387616"><div class="example-title">Example 9.3. REST /filtert/set XML input.</div><div class="example-contents">
    
    <pre class="programlisting">
&lt;?xml version="1.0" encoding="utf8"?&gt;
&lt;filterset&gt;
  &lt;rule type="deny" module="^ping_icmp$" metric="^(?:minimum|maximum|count)$"/&gt;
&lt;/filterset&gt;
    </pre>
  </div></div><br class="example-break"/>
</section>
<section class="section" id="idm62799385648"><div class="titlepage"><div><div><h5 class="title">/filters/show/</h5></div></div></div>

  <div class="variablelist"><dl class="variablelist"><dt><span class="term">method</span></dt><dd><p><code class="code">GET</code></p></dd><dt><span class="term">uri</span></dt><dd><p><code class="code">/filters/show/&lt;path/&gt;&lt;filterset&gt;</code></p></dd></dl></div>
  <p>
  This call returns an XML document describing the current configuration 
  of the specified filterset.  The <code class="code">filterset</code> specified is located
  under the optional <code class="code">path</code>.  If the check exists, but it under
  another path, a HTTP 403 code is returned.  If the check does not exist,
  a HTTP 404 code is returned.
  </p>

  <div class="example" id="idm62799379616"><div class="example-title">Example 9.4. REST /filters/show XML output.</div><div class="example-contents">
    
    <p>Output from an HTTP GET of <code class="code">/filters/show/default</code></p>
    <pre class="programlisting">
&lt;?xml version="1.0" encoding="utf8"?&gt;
&lt;filterset&gt;
  &lt;rule type="deny" module="^ping_icmp$" metric="^(?:minimum|maximum|count)$"/&gt;
&lt;/filterset&gt;
    </pre>
  </div></div><br class="example-break"/>
</section>
</section>
</section>
</section>

</section>
</div>
  <div class="part" id="idm62799376480"><div class="titlepage"><div><div><h1 class="title">Part IV. Development</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="chapter"><a href="#dev.reconnoiter">10. Developer's Guide</a></span><ul><li><span class="section"><a href="#dev.reconnoiter.internal">Internal APIs</a></span></li><li><span class="section"><a href="#idm62799374016">Hooks</a></span><ul><li><span class="section"><a href="#idm62799373232">Abitrary Hooks</a></span></li><li><span class="section"><a href="#idm62799356816">Check Hooks</a></span></li></ul></li><li><span class="section"><a href="#idm62799349648">Developing modules in C</a></span><ul><li><span class="section"><a href="#idm62799344864">Starting your project</a></span></li></ul></li><li><span class="section"><a href="#idm62799336928">Developing modules in lua</a></span><ul><li><span class="section"><a href="#idm62799266672">Installing lua modules</a></span></li><li><span class="section"><a href="#idm62799258656">Basic lua checks</a></span></li><li><span class="section"><a href="#idm62799251680">Reconnoiter-specific lua</a></span></li></ul></li><li><span class="section"><a href="#idm62799148368">Developing modules in Java</a></span></li></ul></li></ul></div>

<section class="chapter" id="dev.reconnoiter"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Developer's Guide</h2></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="#dev.reconnoiter.internal">Internal APIs</a></span></li><li><span class="section"><a href="#idm62799374016">Hooks</a></span><ul><li><span class="section"><a href="#idm62799373232">Abitrary Hooks</a></span></li><li><span class="section"><a href="#idm62799356816">Check Hooks</a></span></li></ul></li><li><span class="section"><a href="#idm62799349648">Developing modules in C</a></span><ul><li><span class="section"><a href="#idm62799344864">Starting your project</a></span></li></ul></li><li><span class="section"><a href="#idm62799336928">Developing modules in lua</a></span><ul><li><span class="section"><a href="#idm62799266672">Installing lua modules</a></span></li><li><span class="section"><a href="#idm62799258656">Basic lua checks</a></span></li><li><span class="section"><a href="#idm62799251680">Reconnoiter-specific lua</a></span></li></ul></li><li><span class="section"><a href="#idm62799148368">Developing modules in Java</a></span></li></ul></div>
  
  <section class="section" id="dev.reconnoiter.internal"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Internal APIs</h2></div></div></div>
      
</section>
  <section class="section" id="idm62799374016"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Hooks</h2></div></div></div>
    
    <section class="section" id="idm62799373232"><div class="titlepage"><div><div><h3 class="title">Abitrary Hooks</h3></div></div></div>
 
 <p>Building a callout API makes sense for common, structured
 features in software, but occassionlly there is a need to provide
 somewhat arbitrary hook points after the software is designed
 and the noit_hooks system is what satisfies this need.</p>
 <p>The design goals here are somewhat specific in that we
 would like to allow for a large number of hook points at low cost
 when not instrumented.  As such, a hash lookup of registered hooks
 would be considered to expensive.  Additionally, we want to provide
 strong, compile-time type safety as it can be all to easy to hook
 something with a function with a slightly incorrect protoype that
 could result in disasterous corruption or crashes (or perhaps worse
 daftly subtle bugs that are punishing to troubleshoot).</p>
 <p>The hooks system is simple a set of two macros; one allowing
 for the declaration of function prototypes for registering and invoking
 a specific programmer-specifiec instrumentation point and the other
 providing an implementation of the registration and invocation
 routines.  Due to the nature of C, the macro calling conventions are
 less than elegant, but ultimately require no complicated implementation
 by the programmer.</p>
   <section class="section" id="idm62799370128"><div class="titlepage"><div><div><h4 class="title">Hook Declaration</h4></div></div></div>
   <p>
   Declaring hooks is done by calling the NOIT_HOOK_PROTO macro with
   the name of the hook (a term that composes a valid C function name),
   the arguments it expects, the type of closure (usually a void *),
   and some variations on those themes that provide CPP enough info
   to construct an implementation with no programmer "programming."
   </p>
   <p>The declaration of a hook "foo" will yield in two functions:
   foo_hook_invoke and foo_hook_register.</p>
   <div class="example" id="idm62799367952"><div class="example-title">Example 10.1. Declaring a foobarquux hook in a header.</div><div class="example-contents">
   
   <p>A foobarquux hook prototype that takes a struct timeval * argument.</p>
   <pre class="programlisting">
     NOIT_HOOK_PROTO(foobarquux, (struct timeval *now),
                     void *, closure, (void *closure, struct timeval *now));
   </pre>
   </div></div><br class="example-break"/>
   <div class="example" id="idm62799365984"><div class="example-title">Example 10.2. Implementing a foobarquux hook in source.</div><div class="example-contents">
   
   <p>A foobarquux hok implementation that takes a struct timeval * argument.</p>
   <pre class="programlisting">
     NOIT_HOOK_IMPL(foobarquux, (struct timeval *now),
                    void *, closure, (void *closure, struct timeval *now),
                    (closure,now));
   </pre>
   </div></div><br class="example-break"/>
   </section>
   <section class="section" id="idm62799363936"><div class="titlepage"><div><div><h4 class="title">Hook Usage</h4></div></div></div>
   <p>Once the hook is implemented, it can be used by the application
   and instrumented by code at runtime. In the below example, we'll
   invoke the foobarquux instrumentation and assuming no issues arise,
   we'll invoke the original foobarquux_work() function.</p>
   <div class="example" id="idm62799362608"><div class="example-title">Example 10.3. Instrumenting a function conditionally.</div><div class="example-contents">
   
   <p>Before we instrument, suppose we have:</p>
   <pre class="programlisting">
     foobarquux_work();
   </pre>
   <p>Now we wish to allow programmers to add instrumentation
   immediately before this code that can conditionally prevent its
   executation:</p>
   <pre class="programlisting">
     struct timeval now;
     gettimeofday(&amp;now, NULL);
     if(NOIT_HOOK_CONTINUE ==
        foobarquux_hook_invoke(&amp;now))
       foobarquux_work();
   </pre>
   </div></div><br class="example-break"/>
   <p>If the hook should not conditionally cause or prevent code
   to run, the invoke function's return value can be ignored.</p>
   <p>In order to register a function that allows the above execution
   on every other subsequent execution one would provide the following:
   </p>
   <div class="example" id="idm62799358736"><div class="example-title">Example 10.4. A sample instrumentation of foobarquux</div><div class="example-contents">
   
   <pre class="programlisting">
     static my_sample_hook(void *closure, struct timeval *now) {
       static int alt = 0;
       return (alt++ % 2) ? NOIT_HOOK_CONTINUE : NOIT_HOOK_DONE;
     }

     ...
       foobarquux_hook_register("sample", my_sample_hook, NULL);
     ...
   </pre>
   </div></div><br class="example-break"/>
   </section>
 </section>
    <section class="section" id="idm62799356816"><div class="titlepage"><div><div><h3 class="title">Check Hooks</h3></div></div></div>
 
   <section class="section" id="idm62799355696"><div class="titlepage"><div><div><h4 class="title">check_preflight</h4></div></div></div>
   <pre class="programlisting">
     noit_hook_return_t (*f)(void *closure, noit_module_t *self,
                             noit_check_t *check, noit_check_t *cause);
   </pre>
   <p>the check_preflight hook is invoked immediately prior to every
   check being performed.  The actual invocation of the check can be
   avoided by returning NOIT_HOOK_DONE instead of NOIT_HOOK_CONTINUE.
   </p>
   <p>The arguments to this function are the module of the check
   the check itself and the causal check (NULL if this check was not
   induced by the completion of another check), respectively.</p>
   <p>This instrumentation point can be used to audit intended check
   activity or prevent a check from running (such as an ACL).</p>
   </section>
   <section class="section" id="idm62799352688"><div class="titlepage"><div><div><h4 class="title">check_postflight</h4></div></div></div>
   <p>The check_postflight hook is invoked immediately subsequent to
   a check being commenced.  Note that due to the asynchronous nature
   of Reconnoiter, it is highly unlikely that the check will have 
   completed by this time.</p>
   <p>The arguments to this function are the module of the check,
   the check itself and the causal check (NULL if this check was not
   induced by the completion of another check), respectively.</p>
   <p>Returning NOIT_HOOK_CONTINUE and NOIT_HOOK_DONE have the same
   effect for this instrumentation point.</p>
   </section>
 </section>
  </section>
  <section class="section" id="idm62799349648"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Developing modules in C</h2></div></div></div>
      
      <p>As Reconnoiter is written in the C programming language, the native plugin development
            is done in C.  If C is not your preferred language, please see the sections regarding
            programming plugins in lua, Java and via external programs via the external module.</p>
      <p>In this section we will walk through a complete (yet simple) check module that reports a random number as a metric.</p>
      <p>Generally, a real check module would be much more complex requiring extensive use of other Reconnoiter APIs.</p>
      <div class="caution"><h3 class="title">You must not block in module code</h3>
      <p>Reconnoiter uses an evented system that relies on normal code to act in a non-blocking fashion.  Performing network operations, filesystem access or invoking third-party library calls can block the Reconnoier event loop and cause the system to malfunction.  Reconnoiter provides a robust suite of APIs and services to manage non-blocking IO and run blocking operations in asynchronous thread pools.  These APIs are discussed in <a class="xref" href="#dev.reconnoiter.internal" title="Internal APIs">the section called “Internal APIs”</a>.</p>
      </div>
      <section class="section" id="idm62799344864"><div class="titlepage"><div><div><h3 class="title">Starting your project</h3></div></div></div>
        
				<p>It is highly recommended that you start a new module based on the
example module available at <a class="ulink" href="https://github.com/circonus-labs/reconnoiter/tree/master/src/modules/example" target="_top"><em class="citetitle">src/modules/example</em></a>.</p>
        <p>Reconnoiter ships a confguration helper called <span class="command"><strong>noit-config</strong></span>.  This tool can help you determine how to build and install plugin modules.</p>
        <p>There are three basic components of a C module: a Makefile, a source file and a documentation file. There can be multiple source iles for more complicated project, but herein we will assume a single source file for a module.</p>
        <section class="section" id="idm62799341376"><div class="titlepage"><div><div><h4 class="title">Module documentation</h4></div></div></div>
          
          <p>Reconnoiter module documentation is written in xml using a non-strict subset of docbook.  It describe the module, it's type, how it is loaded, the various confiruation parameters (including allowable values and default), and finally optional examples of the module in action.</p>
          <p>As all documentation is accessible in the <a class="ulink" href="https://github.com/circonus-labs/reconnoiter/tree/master/src/modules/" target="_top"><em class="citetitle">src/modules</em></a> directory in the reconnoiter repository, it is recommended that you reference that (and docbook documentation) for examples.</p>
          <p>While it is not recommended, producing an empty xml file as your module documentation is permitted, but may limit certain functionality.</p>
        </section>
        <section class="section" id="idm62799337824"><div class="titlepage"><div><div><h4 class="title">Writing code</h4></div></div></div>
          
					<p>Reconnoiter check modules have a few basic parts including code
                that executes as the module is loaded, for module-level configuration,
                initialization and to initiate a check.  We will take a guided tour through the
                example module to better undestand these parts and how they work.</p>

<pre class="programlisting">
/* Your copyright and license data here */

#include "noit_defines.h"
#include "noit_module.h"
#include "noit_check.h"
#include "noit_check_tools.h"
</pre>

<p>These are the minimal includes required to author a check module.</p>

<pre class="programlisting">
static noit_log_stream_t nlerr = NULL;
static noit_log_stream_t nldeb = NULL;

static int example_onload(noit_image_t *self) {
  if(NULL == (nlerr=noit_log_stream_find("error/example"))) nlerr = noit_error;
  if(NULL == (nldeb=noit_log_stream_find("debug/example"))) nldeb = noit_debug;
  return 0;
}
</pre>

<p>We'd like to be able to use Reconnoiter's logging infrastructure to note errors and debugging information that can be granularly controlled.  We declare them statically within our module and initialize them in our onload function (the first thing that runs).  Here we look for a configured log destination at "error/example" to assign our to our log stream <code class="code">nlerr</code>, but if one is not found, we'll fall back to the globally defined <code class="code">noit_error</code> log stream.</p>

<p>It is important to note that the <code class="code">onload</code> function is called in the parent (monitor) <span class="command"><strong>noitd</strong></span> before privileges are dropped.  If a module requires opening a device, priviledged socket or other task requiring escalate privileges it must be performed here.  All other module callbacks happen in the main process subsquent to dropping privileges.</p>

<p>This function must return 0 on success.  If a non-zero return value is provided, the module will not load.</p>

<pre class="programlisting">
static int example_config(noit_module_t *self, noit_hash_table *options) {
  return 0;
}
</pre>

<p>The <code class="code">noit.conf</code> file allows a configuration to be passed to a module as it is loaded.  This configuration is converted into a dictionary (represented as a <code class="code">noit_hash_table *</code>) with keys and values as C strings.  This dictionary is passed to the module instance by calling our <code class="code">example_config</code> function.</p>

<p>This function must return 0, a non-zero return value will cause the module to be unavailable.</p>

<pre class="programlisting">
static int example_init(noit_module_t *self) {
  return 0;
}
</pre>

<p>The initialization function is called after configuration.  This is the opportunity to perform boot-time configuration.</p>

<p>This function must return 0, a non-zero return value will cause the module to be unavailable.</p>

<pre class="programlisting">
struct example_check_info {
  noit_check_t *check;
  noit_module_t *self;
  int limit;
};

static int example_initiate(noit_module_t *self, noit_check_t *check,
                            noit_check_t *cause) {
  /* run on each check invocation */
  ...
  /* discussed in detail later */
}

static int example_initiate_check(noit_module_t *self, noit_check_t *check,
                                  int once, noit_check_t *cause) {
  struct example_check_info *ci;
  if(!check-&gt;closure)
    check-&gt;closure = calloc(1, sizeof(struct example_check_info));
  ci = check-&gt;closure;
  ci-&gt;check = check;
  ci-&gt;self = self;
  INITIATE_CHECK(example_initiate, self, check, cause);
  return 0;
}
</pre>

<p>When a check is first successfully configured and enabled in Reconnoiter, the module associated with that check is invoked once.  This can be confusing to users that would think the application would invoke the check according to the check's configured period.  In fact, it is the checks responsibility to run itself.  This might sound intimidating, but there are convenience functions and the separation provides some capabilities that more advanced modules leverage.</p>

<p>Given that your module is special, it is likely that you will need to store information along the instance of the check you are enabling.  Each <code class="code">noit_check_t</code> has a <code class="code">closure</code> that is provided for you to use as your context.  In this example, we declare a structure that is useful to our example module.  The <code class="code">int limit</code> is useful to the features and function of our module.  The two other structure elements are included out of best practice.  As module executiong becomes more complicated, you will find yourself with only your user context and finding the check and module will be necessary.</p>

<p>In this example, <code class="code">example_initiate_check</code> will be called when a check is first installed (not every <code class="code">period</code> milliseconds).  In this function, we setup our user context in <code class="code">check-&gt;closure</code>, set our other context elements and call a convenience macro called <code class="code">INITIATE_CHECK</code>.  The <code class="code">INITIATE_CHECK</code> macro will setup a recurrent job that will run <code class="code">example_initiate</code> at the frequency at which the check is configured. This two-phase initiation is considered best practice.</p>

<pre class="programlisting">
static int example_initiate(noit_module_t *self, noit_check_t *check,
                            noit_check_t *cause) {
  struct example_check_info *ci = check-&gt;closure;
  const char *limit = "0";
  struct timeval diff;

  BAIL_ON_RUNNING_CHECK(check);
  check-&gt;flags |= NP_RUNNING;
</pre>

<p>Exploring our <code class="code">example_initiate</code> more deeply, we collect our user context from <code class="code">check-&gt;closure</code> and setup some local variable in our C stack we'll need later.</p>

<p>The first critial step is refuse to run if the check is already running and then mark this check as running before proceeding.  The <code class="code">BAIL_ON_RUNNING_CHECK</code> does the former, and next we set the <code class="code">NP_RUNNING</code> bit in our check's flags.</p>

<pre class="programlisting">
  noit_hash_retrieve(check-&gt;config, "limit", strlen("limit"), (void **)&amp;limit);
  ci-&gt;limit = atoi(limit);
</pre>

<p>Our check's configuration (like out module's configuration) is a dictionary in a <code class="code">noit_hash_table</code> where keys and values are C strings.  In this example, we look for a config setting "limit" and convert that into a number and store it in our context.</p>

<p>You should evaluate the config each time your check runs as the configuration may have been changed at run-time by an operator since the last invocation.</p>

<pre class="programlisting">
  if(check-&gt;stats.inprogress.status) free(check-&gt;stats.inprogress.status);
  noit_check_stats_clear(check, &amp;check-&gt;stats.inprogress);
  gettimeofday(&amp;check-&gt;stats.inprogress.whence, NULL);
  sub_timeval(check-&gt;stats.inprogress.whence, check-&gt;last_fire_time, &amp;diff);
  check-&gt;stats.inprogress.duration = diff.tv_sec * 1000 + diff.tv_usec / 1000;
  check-&gt;stats.inprogress.available = NP_AVAILABLE;
  check-&gt;stats.inprogress.status = strdup("hello world");
</pre>

<p>Each check has a set of three <code class="code">stats_t</code> (a structure holding metadata about the execution of a check) structures: <code class="code">previous</code>, <code class="code">current</code> and <code class="code">inprogress</code>.  As a module author, you should never touch the previous or current <code class="code">stats_t</code> structures; operate only on the <code class="code">check-&gt;stats.inprogress</code>.</p>

<p>Walking through this example, we first clear our inprogress stats.  The reason we must explicitly free the status is because the last time we were invoked we allocated (via strdup) the status that's there; we own it, we allocated it, we free it.  We then calculate how long this check took to run (which should be pretty darn fast as we didn't do anything).  We proceed to set various key attributes in the inprogress structure: <code class="code">duration</code>, <code class="code">available</code>, and <code class="code">status</code>.  We then set our status (allocating via strdup). This completes the metadata of the check and we proceed on setting our metric(s).</p>

<pre class="programlisting">
  if(ci-&gt;limit) {
    int value = (int)(lrand48() % ci-&gt;limit);
    noit_stats_set_metric(check, &amp;check-&gt;stats.inprogress,
                          "random", METRIC_INT32, &amp;value);
    check-&gt;stats.inprogress.state = NP_GOOD;
  }
  else {
    noit_stats_set_metric(check, &amp;check-&gt;stats.inprogress,
                          "random", METRIC_INT32, NULL);
    check-&gt;stats.inprogress.state = NP_BAD;
  }
</pre>

<p>If the limit has been set (to something other than zero), we calculate a random integer and limit it to the requested range.  We take that and set a metric called "random" in our <code class="code">inprogress</code> <code class="code">stats_t</code> structure.  Notice we pass the addres of our integer and not the value.  This worked out well for us, so we set our state to "good."</p>

<p>If the limit was zero, we still want to pass the metric back, but we'd like to note that we couldn't not calculated it (you can't modulo by zero).  In this case we set the metric just as before, but pass <code class="code">NULL</code> in as the value.  We consider this an unsuccessful performance, so we set the state to "bad."</p>

<pre class="programlisting">
  noit_check_set_stats(check, &amp;check-&gt;stats.inprogress);
  check-&gt;flags &amp;= ~NP_RUNNING;

  return 0;
}
</pre>

<p>We set the stats on the check via the call to <code class="code">noit_check_set_stats</code>.  This step actually causes reconnoiter to log the data which is sent upstream.  You can think of this a "committing" the data.  Finally, we mark our check as no longer running.</p>

<pre class="programlisting">
static void example_cleanup(noit_module_t *self, noit_check_t *check) {
  struct example_check_info *ci = check-&gt;closure;
  if(ci) {
    free(ci);
  }
}
</pre>

<p>You may optionally provide a function to free the context for the check in the case when a check is disabled or deleted administratively during runtime. If you allocate a context, you should most likely implement this or you will risk leaking memory.</p>

<pre class="programlisting">
#include "example.xmlh"
noit_module_t example = {
  {
    .magic = NOIT_MODULE_MAGIC,
    .version = NOIT_MODULE_ABI_VERSION,
    .name = "example",
    .description = "a module to demonstrat module development",
    .xml_description = example_xml_description,
    .onload = example_onload
  },
  example_config,
  example_init,
  example_initiate_check,
  example_cleanup
};
</pre>

<p>This last declaration ties everything together.  This is the actual declaration of your module.  The name of the <code class="code">noit_module_t</code> variable must match the <code class="code">name</code> field.  The <code class="code">magic</code> and <code class="code">version</code> ensure that this module can only be loaded into a compatible <span class="command"><strong>noitd</strong></span>.</p>

<p>The <code class="code">#include</code> of the <code class="code">.xmlh</code> file might look odd, but we'll get to how that is auto-generated from your XML documetation when we discuss writing our Makefile.  This specific include file provide a define for the the XML documentation as a C string; in this example it is named <code class="code">example_xml_description</code>.  The rest of the structure assignements connect the functions we've already written into the module definition so that <code class="code">noitd</code> knows which functions to run.</p>
        </section>
        <section class="section" id="idm62799291456"><div class="titlepage"><div><div><h4 class="title">Writing a Makefile</h4></div></div></div>
          
          <p>Building an C app that is more than a toy requires a build environment.  While it is possible to set up projects in an IDE, we will tour through a minimal build system using <span class="command"><strong>make</strong></span>.</p>
          <p>Our makefile has 4 goals:</p>
          <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Convert our documentation so that it can be included in our code.</p></li><li class="listitem"><p>Compile our code to objects.</p></li><li class="listitem"><p>Link our objects together into a loadable module.</p></li><li class="listitem"><p>Install the results.</p></li></ul></div>
          <p>The Makefile must start with some non-standard suffixes so that we can make general rules around building our parts.</p>
<pre class="programlisting">
.SUFFIXES: .lo .bundle .xml .xmlh .so
</pre>
          <p><code class="code">.lo</code> is used, by convention, to mean object code that has been compiled in an pointer-invariant manner (e.g. using the <code class="code">-fPIC</code> compiler option).  <code class="code">.bundle</code> and <code class="code">.so</code> are the expected file extensions of loadable modules on Mac OS X and all other UNIX and UNIX-like platforms, respectively.  Finally, to convert from our XML documentation to our customer XML header files, we teach <code class="code">make</code> about the <code class="code">.xml</code> and <code class="code">.xmlh</code> extensions.</p>

<pre class="programlisting">
CC=$(shell noit-config --cc)
CPPFLAGS=$(shell noit-config --cppflags)
SHCFLAGS=$(shell noit-config --shcflags)
MODULELD=$(shell noit-config --moduleld)
SHLDFLAGS=$(shell noit-config --shldflags)
MODULEEXT=$(shell noit-config --moduleext)
MODULESDIR=$(shell noit-config --modules-dir)
XML2H=$(shell noit-config --xml2h)
</pre>
          <p>Compiling, linking and processing XML are all quite dependent on your environment.  When the Reconnoiter product configureson your platform, it produces a helper application called <span class="command"><strong>noit-config</strong></span> that can regurgitate the originally determined options.  Here we save relevant commands and options into variables to use in our Makefile.</p>

<pre class="programlisting">
MODULES=example.$(MODULEEXT)

all:  $(MODULES)

</pre>
          <p>Next we make a list of the modules we wish to build and set the first (and default) target <code class="code">all</code> to depend on that list.  Now when you run <span class="command"><strong>make</strong></span> it will attempt to build the module.</p>

<pre class="programlisting">
.xml.xmlh:
  @$(XML2H) `echo $&lt; | sed -e 's/\.xml$$//;'`_xml_description &lt; $&lt; &gt; $@
</pre>

          <p>We define a rule to convert from our XML documentation to our custom <code class="code">.xmlh</code> inline include.  The resulting file is included in our module's source code.</p>

<pre class="programlisting">
example.lo: example.c example.xmlh
  $(CC) $(CPPFLAGS) $(SHCFLAGS) -o $@ -c $&lt;
</pre>

          <p>Next we define a rule to build an object from our source code.</p>

<pre class="programlisting">
example.$(MODULEEXT): example.lo
  $(MODULELD) $(SHLDFLAGS) -o $@ example.lo
</pre>

          <p>We then define a rule to build our module by linking the object(s) together.  This is the place where we would add additional library dependencies if our module leveraged 3rd-party libraried.</p>

          <p>At this point, we can run make an product a module that can be loaded into our <span class="command"><strong>noitd</strong></span>.</p>

<pre class="programlisting">
install:  $(MODULES)
  for i in $(MODULES); do \
    cp $$i $(DESTDIR)$(MODULESDIR)/$$i; \
    chmod 755 $(DESTDIR)$(MODULESDIR)/$$i; \
  done
</pre>

          <p>For sake of completeness, we can proide and <code class="code">install</code> target that installs the built module to the directory in which <span class="command"><strong>noitd</strong></span> was originally configured to delivery it's included modules.</p>

        </section>
      </section>
</section>
  <section class="section" id="idm62799336928"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Developing modules in lua</h2></div></div></div>
      
      <p>Reconnoiter modules can be written in <a class="ulink" href="http://www.lua.org/" target="_top"><em class="citetitle">Lua</em></a>.  Modules implementing check types as well as more generic non-check related modules can be authored in lua.</p>
      <p>Due to Reconnoiter's event handling system, one must be careful when taking blocking actions in their lua modules as doing so can cause general malfunctions including watchdog timeouts where the process will be terminated and restarted.</p>
      <p>Several lua bindings are available under the <code class="code">noit</code> namespace are available to assist in leveraging the event system and supprting libraries.</p>
      <section class="section" id="idm62799266672"><div class="titlepage"><div><div><h3 class="title">Installing lua modules</h3></div></div></div>
        
        <p>Site to site locations may vary, but the search path for lua is specific in the <code class="code">noit.conf</code> file where the lua loader is loaded.  Lua files should be installed relative to this path where modules namespaces are in their own directory heirarchy.  For example, <code class="code">noit.module.example</code> should be in a file <code class="code">noit/module/example.lua</code> relative to the search path.  In a typical Reconnoiter install, if the install prefix is <code class="code">/opt/noit/prod</code>, then this file would be <code class="code">/opt/noit/prod/libexec/noit/noit/module/example.lua</code>.</p>
        <p>Lua files are simply copied to this location and are available to be included via the noit configuration system.</p>
        <p>The lua loader itself should be loaded exactly once within the <code class="code">modules</code> section of the configuration:</p>
        <pre class="programlisting">
    &lt;loader image="lua" name="lua"&gt;
      &lt;config&gt;
        &lt;directory&gt;/opt/noit/prod/libexec/noit/?.lua&lt;/directory&gt;
      &lt;/config&gt;
    &lt;/loader&gt;
</pre>
        <p>Loading a lua module using that loader is also in the <code class="code">modules</code> section:</p>
        <pre class="programlisting">
    &lt;module loader="lua" name="example" object="noit.module.example"&gt;
      &lt;config&gt;&lt;/config&gt;
    &lt;/module&gt;
</pre>
      </section>
      <section class="section" id="idm62799258656"><div class="titlepage"><div><div><h3 class="title">Basic lua checks</h3></div></div></div>
        
        <p>As with any check module in Reconnoiter, there are four basic elements: documentation, initialization, configuration and performing a check.  In lua modules, the documentation is actually coded and injected during the loading of the module.</p>
        <p>Every module should start with a <code class="code">module</code> declaration and documentation chunk wrapped in the <code class="code">onload</code> function.</p>
        <pre class="programlisting">
/* Your copyright and license data here */

module(..., package.seeall)

function onload(image)
  image.xml_description([=[
&lt;module&gt;
  &lt;name&gt;munin&lt;/name&gt;
  &lt;description&gt;&lt;para&gt;Report the seconds since epoch and a random number.&lt;/para&gt;&lt;/description&gt;
  &lt;loader&gt;lua&lt;/loader&gt;
  &lt;object&gt;noit.module.example&lt;/object&gt;
  &lt;moduleconfig /&gt;
  &lt;checkconfig /&gt;
&lt;/module&gt;
]=]);
  return 0
end
</pre>
        <p>The module should then specify an initialization command and a configuration command. The options passed to the configuration function are the config parameters specified relative to the module in the configuration file, not a specific check's configuration.</p>
        <pre class="programlisting">
function init(module)
  return 0
end

function config(module, options)
  return 0
end
</pre>

        <p>Lastly, the module should provide an <code class="code">initiate</code> functino that performs the check.</p>
        <pre class="programlisting">
function initiate(module, check)
  local now_seconds = noit.gettimeofday()
  check.metric_int32("seconds_since_epoch", now_seconds)
  check.metric_double("random", math.random())
  check.available()
  check.good()
  check.status("had a good day")
end
</pre>
    </section>
    <section class="section" id="idm62799251680"><div class="titlepage"><div><div><h3 class="title">Reconnoiter-specific lua</h3></div></div></div>
      
      <section class="section" id="idm62799251168"><div class="titlepage"><div><div><h4 class="title">Module images and checks</h4></div></div></div>
        
        <p>Taking the <code class="code">initiation</code> function as an example, the first argument <code class="code">module</code> is of type <code class="code">noit_module_t</code> and the second argument <code class="code">check</code> is of type <code class="code">noit_check_t</code>.  Each of these types has several functions and attributes.</p>
        <section class="section" id="idm62799247200"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_module_t.description([description])</code></h5></div></div></div>
                 <p>If an argument is provided, the description is updated to <code class="code">description</code>. The description is returned.</p></section>
        <section class="section" id="idm62799245456"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_module_t.name([name])</code></h5></div></div></div>
                 <p>If an argument is provided, the name is updated to <code class="code">name</code>. The name is returned.</p></section>
        <section class="section" id="idm62799243824"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_module_t.xml_description([xml])</code></h5></div></div></div>
                 <p>If an argument is provided, the XML description (documentation) is updated to <code class="code">xml</code>.  The XML description is returned.</p></section>

        <section class="section" id="idm62799242176"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.available()</code></h5></div></div></div>
                 <p>Sets the check's <code class="code">available</code> field to <code class="code">NP_AVAILABLE</code>.</p></section>
        <section class="section" id="idm62799240224"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.availability()</code></h5></div></div></div>
                 <p>Returns the check's current <code class="code">available</code> field.</p></section>
        <section class="section" id="idm62799238656"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.bad()</code></h5></div></div></div>
                 <p>Sets the check's <code class="code">state</code> field to <code class="code">NP_BAD</code>.</p></section>
        <section class="section" id="idm62799236704"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.config</code></h5></div></div></div>
                 <p>A lua table representing the check's config dictionary.</p></section>
        <section class="section" id="idm62799235536"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.flags(...)</code></h5></div></div></div>
                 <p>This function takes a list of string flags and bitwise ORs them together to create a mask.  This function returns the check's current flags bitwise ANDed with the mask.</p>
                 <p>Possible string flags: <code class="code">NP_RUNNING</code>, <code class="code">NP_KILLED</code>, <code class="code">NP_DISABLED</code>, <code class="code">NP_UNCONFIG</code>, <code class="code">NP_TRANSIENT</code>, <code class="code">NP_RESOLVE</code>, <code class="code">NP_RESOLVED</code>, <code class="code">NP_SUPPRESS_STATUS</code>, <code class="code">NP_PREFER_IPV6</code>, <code class="code">NP_SINGLE_RESOLVE</code>, and <code class="code">NP_PASSIVE_COLLECTION</code>.</p></section>
        <section class="section" id="idm62799234000"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.good()</code></h5></div></div></div>
                 <p>Sets the check's <code class="code">state</code> field to <code class="code">NP_GOOD</code>.</p></section>
        <section class="section" id="idm62799227216"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.interpolate([in])</code></h5></div></div></div>
                 <p>This function accepts a string or a table whose values are strings.  It applies check interpolation using the checks attributes and config and returns a new interpolated string or a copy of the table whose values are interpolated, respectively.</p></section>
        <section class="section" id="idm62799225856"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.module</code></h5></div></div></div>
                 <p>A string representing the name of the module.</p></section>
        <section class="section" id="idm62799224752"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> guessing at its type.</p></section>
        <section class="section" id="idm62799222720"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_double(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> forcing (if possible) the type to a 64-bit double.</p></section>
        <section class="section" id="idm62799220720"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_int32(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> forcing (if possible) the type to a signed 32-bit integer.</p></section>
        <section class="section" id="idm62799218688"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_int64(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> forcing (if possible) the type to a signed 64-bit integer.</p></section>
        <section class="section" id="idm62799216656"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_string(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> forcing the type to a string.</p></section>
        <section class="section" id="idm62799214624"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_uint32(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> forcing (if possible) the type to an unsigned 32-bit integer.</p></section>
        <section class="section" id="idm62799212624"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_uint64(name, value)</code></h5></div></div></div>
                 <p>Set a metric named <code class="code">name</code> to the value <code class="code">value</code> forcing (if possible) the type to a unsigned 64-bit integer.</p></section>
        <section class="section" id="idm62799210592"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.metric_json(json)</code></h5></div></div></div>
                 <p>Take a fully-formed JSON document and set metrics from them as is done by the resmon module.</p></section>
        <section class="section" id="idm62799209440"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.name</code></h5></div></div></div>
                 <p>A string representing the name of the check.</p></section>
        <section class="section" id="idm62799208224"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.period</code></h5></div></div></div>
                 <p>An integer representing the period of the check in milliseconds.</p></section>
        <section class="section" id="idm62799207008"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.state()</code></h5></div></div></div>
                 <p>This function returns the state of the check.</p></section>
        <section class="section" id="idm62799205904"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.status(msg)</code></h5></div></div></div>
                 <p>This function sets the status of the check to <code class="code">msg</code>.</p></section>
        <section class="section" id="idm62799204288"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.target</code></h5></div></div></div>
                 <p>A string representing the target of the check.</p></section>
        <section class="section" id="idm62799203184"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.target_ip</code></h5></div></div></div>
                 <p>A string representing the resolved target IP address of the check.</p></section>
        <section class="section" id="idm62799201952"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.timeout</code></h5></div></div></div>
                 <p>An integer representing the timeout of the check in milliseconds.</p></section>
        <section class="section" id="idm62799200768"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit_check_t.unavailable()</code></h5></div></div></div>
                 <p>Sets the check's <code class="code">unavailable</code> field to <code class="code">NP_UNAVAILABLE</code>.</p></section>
      </section>
      <section class="section" id="idm62799251040"><div class="titlepage"><div><div><h4 class="title">Non-blocking network functions</h4></div></div></div>
        
        <p>All networking functions in lua modules should use the <code class="code">noit.socket</code> function to retrieve a socket with non-blocking methods attached.  These sockets support both UDP and TCP as well as SSL over TCP.</p>
        <section class="section" id="idm62799197008"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.socket(ipaddress[, protocol])</code></h5></div></div></div>
                 <p>Creates and returns a socket for the Internet family (IPv4 or IPv6) to which the <code class="code">ipaddress</code> belongs. The <code class="code">protocol</code> argument can be "udp" or "tcp," defaulting to "tcp" is omitted. Returns an object of type <code class="code">noit.eventer</code>.</p></section>
        <section class="section" id="idm62799194432"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.socket(family[, protocol])</code></h5></div></div></div>
                 <p>Creates and returns a socket of type <code class="code">family</code> (either "inet" or "inet6"). The <code class="code">protocol</code> argument can be "udp" or "tcp," defaulting to "tcp" is omitted. Returns an object of type <code class="code">noit.eventer</code>.</p></section>
        <section class="section" id="idm62799191856"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:accept()</code></h5></div></div></div>
                 <p>Accept a new socket from an existing listening socket. Returns a new non-blocking socket of type <code class="code">noit.eventer</code></p></section>
        <section class="section" id="idm62799190352"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:bind(address, port)</code></h5></div></div></div>
                 <p>Bind the current socket to the specified <code class="code">address</code> and <code class="code">port</code>. Returns two values, a return code (0 on success) and a possible error message.</p></section>
        <section class="section" id="idm62799188352"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:close()</code></h5></div></div></div>
                 <p>Closes the socket.</p></section>
        <section class="section" id="idm62799187232"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:connect(ipaddress, port)</code></h5></div></div></div>
                 <p>Establish a connection to the specified <code class="code">ipaddress</code> and <code class="code">port</code>. Returns two values, a return code (0 on success) and a possible error message.</p></section>
        <section class="section" id="idm62799185136"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:listen(backlog)</code></h5></div></div></div>
                 <p>Use listen(2) to place the current socket in listening mode (ready to accept connections).  The <code class="code">backlog</code> argument is passed to the listen system call.  Returns three arguments: a return code (0 on success), and possibly the <code class="code">errno</code> and error message in the event of a failure condition.</p></section>
        <section class="section" id="idm62799182928"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:own()</code></h5></div></div></div>
                 <p>Each <code class="code">noit.eventer</code> object to a lua coroutine.  If you pass an object to another coroutine to use, that coroutine should claim ownership of the object by invoking this function.</p></section>
        <section class="section" id="idm62799181168"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:read(length)</code></h5></div></div></div>
                 <p>Read <code class="code">length</code> bytes from the socket and return them as a string.</p></section>
        <section class="section" id="idm62799179648"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:read(delimiter)</code></h5></div></div></div>
                 <p>Read bytes up to and including the string specified by <code class="code">delimiter</code> return them as a string.</p></section>
        <section class="section" id="idm62799178016"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:recv(length)</code></h5></div></div></div>
                 <p>Read a packet of up to <code class="code">length</code> bytes.  Returns two values: the length of the packet read and the contents of the packet.</p></section>
        <section class="section" id="idm62799176448"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:send(pkt)</code></h5></div></div></div>
                 <p>Send te string <code class="code">pkt</code> over the socket.</p></section>
        <section class="section" id="idm62799174832"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:sendto(pkt, address, port)</code></h5></div></div></div>
                 <p>Send te string <code class="code">pkt</code> over the socket to the specified <code class="code">address</code> and <code class="code">port</code>.</p></section>
        <section class="section" id="idm62799172416"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:setsockopt(type, value)</code></h5></div></div></div>
                 <p>Call the system setsockopt(2) function with the specified <code class="code">value</code>.  Supported values for <code class="code">type</code> are <code class="code">"SO_BROADCAST"</code>, <code class="code">"SO_REUSEADDR"</code>, <code class="code">"SO_KEEPALIVE"</code>, <code class="code">"SO_LINGER"</code>, <code class="code">"SO_OOBINLINE"</code>, <code class="code">"SO_SNDBUF"</code>, <code class="code">"SO_RCVBUF"</code>, <code class="code">"SO_DONTROUTE"</code>, <code class="code">"SO_RCVLOWAT"</code>, <code class="code">"SO_RCVTIMEO"</code>, <code class="code">"SO_SNDLOWAT"</code>, and <code class="code">"SO_SNDTIMEO"</code>.  Returns two values: a return code (0 on success) and a possible error message.</p></section>
        <section class="section" id="idm62799171440"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:ssl_upgrade_socket(cert,key,ca,ciphers)</code></h5></div></div></div>
                 <p>Upgrade a connected socket to SSL.  The <code class="code">cert</code>, <code class="code">key</code>, and <code class="code">ca</code> arguments specify the paths to files containing the certificate, key, and CA chain, respectively.  <code class="code">ciphers</code> is a list of ciphers as understood by OpenSSL.  Returns two values, a return code (0 on success) and a possible error message.</p></section>
        <section class="section" id="idm62799162256"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:ssl_ctx()</code></h5></div></div></div>
                 <p>Return the associated SSL context (of type <code class="code">noit.eventer.ssl_ctx</code>).</p></section>
        <section class="section" id="idm62799160688"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer:write(body)</code></h5></div></div></div>
                 <p>Write the string <code class="code">body</code> over the socket.</p></section>
        <section class="section" id="idm62799159120"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:ciphers</code></h5></div></div></div>
                 <p>A lua table containing the names ciphers that have been negotiated on the context.</p></section>
        <section class="section" id="idm62799158016"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:current_cipher</code></h5></div></div></div>
                 <p>The name of the currently used cipher.</p></section>
        <section class="section" id="idm62799156800"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:error</code></h5></div></div></div>
                 <p>The error encountered when attempting to validate the peer.</p></section>
        <section class="section" id="idm62799155584"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:end_time</code></h5></div></div></div>
                 <p>The time at which the peer's certificate will no longer be valid (expire).  This time is measured in seconds since 1970.</p></section>
        <section class="section" id="idm62799154352"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:issuer</code></h5></div></div></div>
                 <p>The issuer of the peer's certificate.</p></section>
        <section class="section" id="idm62799153248"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:method</code></h5></div></div></div>
                 <p>The current SSL method being used.</p></section>
        <section class="section" id="idm62799152096"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:san_list</code></h5></div></div></div>
                 <p>The subject alternate names of the peer's certificate.</p></section>
        <section class="section" id="idm62799150880"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:subject</code></h5></div></div></div>
                 <p>The subject of the peer's certificate.</p></section>
        <section class="section" id="idm62799149776"><div class="titlepage"><div><div><h5 class="title"><code class="code">noit.eventer.ssl_ctx:start_time</code></h5></div></div></div>
                 <p>The time at which the peer's certificate begins validaity (issuance date).  This time is measured in seconds since 1970.</p></section>
      </section>
    </section>
</section>
  <section class="section" id="idm62799148368"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Developing modules in Java</h2></div></div></div>
      
</section>
</section>
</div>

  <div class="part" id="reference"><div class="titlepage"><div><div><h1 class="title">Part V. Reference</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="reference"><a href="#exe">I. Reconnoiter Command Line Reference</a></span><ul><li><span class="refentrytitle"><a href="#executable.noitd">noitd</a></span><span class="refpurpose"> — Reconnoiter scout daemon</span></li><li><span class="refentrytitle"><a href="#executable.stratcond">stratcond</a></span><span class="refpurpose"> — Reconnoiter data collector/aggregator.</span></li></ul></li></ul></div>
    
    <div class="reference" id="exe"><div class="titlepage"><div><div><h1 class="title">Reconnoiter Command Line Reference</h1></div></div><hr/></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="refentrytitle"><a href="#executable.noitd">noitd</a></span><span class="refpurpose"> — Reconnoiter scout daemon</span></li><li><span class="refentrytitle"><a href="#executable.stratcond">stratcond</a></span><span class="refpurpose"> — Reconnoiter data collector/aggregator.</span></li></ul></div>
      
      <div class="refentry" id="executable.noitd"><div class="titlepage"/>
  

  <div class="refnamediv"><h2>Name</h2><p>
    noitd
     — Reconnoiter scout daemon
  </p></div>

  <div class="refsynopsisdiv"><h2>Synopsis</h2>
    <div class="cmdsynopsis"><p id="idm62799142608">
      <code class="command">noitd</code> 
       [-c]
       [-u <em class="replaceable"><code>user</code></em>]
       [-g <em class="replaceable"><code>group</code></em>]
       [-t <em class="replaceable"><code>path</code></em>]
       [-n <em class="replaceable"><code>address:port</code></em>]
       [-d]
       [-D]
       [-l <em class="replaceable"><code>logstream</code></em>]
       [-L <em class="replaceable"><code>logstream</code></em>]
       [-M]
       [-h]
    </p></div>
  </div>

  <div class="refsect1" id="idm62799132464"><h2>Description</h2>
    
<p>
  <span class="command"><strong>noitd</strong></span> is the daemon that performs all health and metric
  checks.  Generally, one is run in each environment (secured subnet).
</p>

<div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-u</code></span></dt><dd>
      <p>
        Optionally specifies a username or uid under which to operate.
      </p>
    </dd><dt><span class="term"><code class="option">-g</code></span></dt><dd>
      <p>
        Optionally specifies a group name or gid under which to operate.
      </p>
    </dd><dt><span class="term"><code class="option">-t</code></span></dt><dd>
      <p>
        Optionally specifies a path to chroot(2) for operation.  Measures
        must be taken to ensure that log files can be accessed in the
        chrooted environment.
      </p>
    </dd><dt><span class="term"><code class="option">-n</code></span></dt><dd>
      <p>
        Optionally specifies an address to *not* listen on. It can be
        a unix path (:port omitted), just a port (:port), or a complete
        address (IP:port).  The parameter can be specified multiple times.
        It will cause any listener configured on such an address to be
        skipped during boot.
      </p>
    </dd><dt><span class="term"><code class="option">-c</code></span></dt><dd>
      <p>
        Specifies a configuration file to read.  The initial configuration
        is read from this file and <span class="command"><strong>write config</strong></span> commands
        will write to this file.  The default location of the configuration
        file is <code class="filename">noitd.conf</code> in the sysconfdir specified
        at build time.
      </p>
    </dd><dt><span class="term"><code class="option">-l</code></span></dt><dd>
      <p>
        Marks the enabled bit for the specified log stream.  This enables
        the stream even if it is disabled in the configuration file.  It
        must exist in the configuration file.
      </p>
    </dd><dt><span class="term"><code class="option">-L</code></span></dt><dd>
      <p>
        Disables the enabled bit for the specified log stream.  This disables
        the stream even if it is enabled in the configuration file.  It
        must exist in the configuration file.
      </p>
    </dd><dt><span class="term"><code class="option">-D</code></span></dt><dd>
      <p>
        Instructs <span class="command"><strong>noitd</strong></span> to run in the foreground.
        Normally, noitd consists of a management process and a child
        process that performs all actions.  This prevents that scenario
        and runs only the child process attached to the terminal.  This
        is primarily for debugging purposes.
      </p>
      <p>
        If this flag is specified more than once, <span class="command"><strong>noitd</strong></span>
        stay in the foreground, but the foreground process will actually
        be the monitor process and the child will be forked off and
        respawned on unexpected failures.
      </p>
    </dd><dt><span class="term"><code class="option">-d</code></span></dt><dd>
      <p>
        Enables the debug output facility despite configuration to the
        contrary.
      </p>
    </dd><dt><span class="term"><code class="option">-M</code></span></dt><dd>
      <p>
        Instructs <span class="command"><strong>noitd</strong></span> to exit immediately if there
        where any problems loading specified modules.
      </p>
    </dd><dt><span class="term"><code class="option">-h</code></span></dt><dd>
      <p>
        Displays the usage information.
      </p>
    </dd></dl></div>
</div>
</div>
      <div class="refentry" id="executable.stratcond"><div class="refentry.separator"><hr/></div><div class="titlepage"/>
  

  <div class="refnamediv"><h2>Name</h2><p>
    stratcond
     — Reconnoiter data collector/aggregator.
  </p></div>

  <div class="refsynopsisdiv"><h2>Synopsis</h2>
    <div class="cmdsynopsis"><p id="idm62799103552">
      <code class="command">stratcond</code> 
       [-c]
       [-M]
       [-u <em class="replaceable"><code>user</code></em>]
       [-g <em class="replaceable"><code>group</code></em>]
       [-t <em class="replaceable"><code>path</code></em>]
       [-n <em class="replaceable"><code>address:port</code></em>]
       [-d]
       [-D]
       [-l <em class="replaceable"><code>logstream</code></em>]
       [-L <em class="replaceable"><code>logstream</code></em>]
       [-s]
       [-r]
       [-h]
    </p></div>
  </div>

  <div class="refsect1" id="idm62799092080"><h2>Description</h2>
    
<p>
  <span class="command"><strong>stratcond</strong></span> is the daemon that coordinates all
  <span class="command"><strong>noitd</strong></span> daemons, processes their data feeds
  (configuration updates, metrics, checks and statuses) and provides
  that data to the backend business logic: storage services and
  fault detection services.
</p>

<div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-u</code></span></dt><dd>
      <p>
        Optionally specifies a username or uid under which to operate.
      </p>
    </dd><dt><span class="term"><code class="option">-g</code></span></dt><dd>
      <p>
        Optionally specifies a group name or gid under which to operate.
      </p>
    </dd><dt><span class="term"><code class="option">-t</code></span></dt><dd>
      <p>
        Optionally specifies a path to chroot(2) for operation.  Measures
        must be taken to ensure that log files can be accessed in the
        chrooted environment.
      </p>
    </dd><dt><span class="term"><code class="option">-n</code></span></dt><dd>
      <p>
        Optionally specifies an address to *not* listen on. It can be
        a unix path (:port omitted), just a port (:port), or a complete
        address (IP:port).  The parameter can be specified multiple times.
        It will cause any listener configured on such an address to be
        skipped during boot.
      </p>
    </dd><dt><span class="term"><code class="option">-c</code></span></dt><dd>
      <p>
        Specifies a configuration file to read.  The default location of the
        configuration file is <code class="filename">stratcond.conf</code> in the
        sysconfdir specified at build time.
      </p>
    </dd><dt><span class="term"><code class="option">-l</code></span></dt><dd>
      <p>
        Marks the enabled bit for the specified log stream.  This enables
        the stream even if it is disabled in the configuration file.  It
        must exist in the configuration file.
      </p>
    </dd><dt><span class="term"><code class="option">-L</code></span></dt><dd>
      <p>
        Disables the enabled bit for the specified log stream.  This disables
        the stream even if it is enabled in the configuration file.  It
        must exist in the configuration file.
      </p>
    </dd><dt><span class="term"><code class="option">-D</code></span></dt><dd>
      <p>
        Instructs <span class="command"><strong>stratcond</strong></span> to run in the foreground.
        The process remains attached to the terminal.  This is primarily
        for debugging purposes.
      </p>
      <p>
        If this flag is specified more than once, <span class="command"><strong>stratcond</strong></span>
        stay in the foreground, but the foreground process will actually
        be the monitor process and the child will be forked off and
        respawned on unexpected failures.
      </p>
    </dd><dt><span class="term"><code class="option">-d</code></span></dt><dd>
      <p>
        Enables the debug output facility despite configuration to the
        contrary.
      </p>
    </dd><dt><span class="term"><code class="option">-M</code></span></dt><dd>
      <p>
        Instructs <span class="command"><strong>noitd</strong></span> to exit immediately if there
        where any problems loading specified modules.
      </p>
    </dd><dt><span class="term"><code class="option">-s</code></span></dt><dd>
      <p>
        Disables pulling for durable logs from noits and subsequent
        loading of data into the database.
      </p>
    </dd><dt><span class="term"><code class="option">-r</code></span></dt><dd>
      <p>
        Disables pulling for transient logs from noits and subsequent
        submission to the message queue.
      </p>
    </dd><dt><span class="term"><code class="option">-h</code></span></dt><dd>
      <p>
        Displays the usage information.
      </p>
    </dd></dl></div>
</div>
</div>
    </div>
    
  </div>
  
  <div class="index" id="the.index"><div class="titlepage"><div><div><h1 class="title">Index</h1></div></div></div><div class="index"/></div>
</div></body></html>