<?xml version="1.0"?>
<section>
  <title>dhcp</title>
  <para>Monitor a DHCP server</para>
  <variablelist>
    <varlistentry>
      <term>loader</term>
      <listitem>
        <para>lua</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>object</term>
      <listitem>
        <para>noit.module.dhcp</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <section>
    <title>Module Configuration</title>
    <variablelist>
      <varlistentry>
        <term>internal_port</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>55000</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>\d+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The local port that individual checks will pass DHCP configuration information to.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section>
    <title>Check Configuration</title>
    <variablelist>
      <varlistentry>
        <term>send_port</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>67</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>\d+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The port to which we will send DHCP request</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>hardware_addr</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>00:00:00:00:00:00</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The hardware address of the DHCP client</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>host_ip</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>0.0.0.0</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The IP address of the DHCP client</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>request_type</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>1</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>(?:1|8)</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The type of DHCP request message to send to the server</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <example>
    <title>Monitor a DHCP service</title>
    <para>The following example monitors a DHCP services on 10.1.2.3</para>
    <programlisting>
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;loader image="lua" name="lua"&gt;
            &lt;config&gt;&lt;directory&gt;/opt/reconnoiter/libexec/modules-lua/?.lua&lt;/directory&gt;&lt;/config&gt;
          &lt;/loader&gt;
          &lt;module loader="lua" name="dhcp" object="noit.module.dhcp"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;check uuid="4edab6d0-c14b-11e1-afa7-0800200c9a66" module="dhcp" target="10.1.2.3" period="60000" timeout="5000"/&gt;
            &lt;config&gt;
              &lt;send_port&gt;67&lt;/send_port&gt;
              &lt;hardware_addr&gt;00:00:00:00:00:00&lt;/hardware_addr&gt;
            &lt;/config&gt;
          &lt;/config&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
      </programlisting>
  </example>
</section>
