namespace circonus;

table AutoAddValue {
  type: string (id: 0);
  max: long (id: 1);
}

table FilterValue {
  type: string (id: 0);
  value: string (id: 1);
}

table AcceptValue {
  values: [FilterValue] (id: 0);
}
table AllowValue {
  values: [FilterValue] (id: 0);
}
table DenyValue {
  values: [FilterValue] (id: 0);
}
table SkiptoValue {
  values: [FilterValue] (id: 0);
}

union FiltersetRuleValueUnion {
  AcceptValue,
  AllowValue,
  DenyValue,
  SkiptoValue
}

table FiltersetRule {
  id: string (id: 0);
  filterset_flush_period: long (id: 1);
  value: FiltersetRuleValueUnion (id: 3);
  auto_add: [AutoAddValue] (id: 4);
}

root_type FiltersetRule;
file_identifier "CIMM";
